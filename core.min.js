class StringLoader{constructor(){this._strings=new Map,this._cache=new Map,this._extensionStrings=new Map,this._langList=window.GRAPHTOOL_CONFIG?.LANGUAGE?.LANGUAGE_LIST||[["en","English"],["ko","한국어"]],this._currentLang="en",this._observers=new Set,this._fallbackChain=["en"],this._boundObservers=new WeakMap,this._activeExtensionList=[],window.GRAPHTOOL_CONFIG?.LANGUAGE?.ENABLE_I18N&&window.GRAPHTOOL_CONFIG?.LANGUAGE?.ENABLE_SYSTEM_LANG_DETECTION&&(this._currentLang=this._detectLanguage()),this.loadLanguage(this._currentLang)}_detectLanguage(){const t=navigator.language.split("-")[0];return this._langList.map((([t,e])=>t)).includes(t)?t:"en"}getLanguageList(){return this._langList}async loadLanguage(t,e=!1){try{if(document.documentElement.setAttribute("data-loading",""),!e&&this._cache.has(t))return this._strings=new Map(this._cache.get(t)),this._currentLang=t,await this.loadExtensionStrings(),this._notifyObservers(),!0;const n=await fetch(import.meta.resolve(`./assets/strings/${t}.json`));if(!n.ok)throw new Error(`Language ${t} not found`);const r=await n.json();return this._strings.clear(),this._processStrings("",r),this._cache.set(t,new Map(this._strings)),this._currentLang=t,await this.loadExtensionStrings(),this._notifyObservers(),!0}catch(t){return console.error("Failed to load language:",t),!1}finally{document.documentElement.removeAttribute("data-loading")}}_processStrings(t,e){for(const[n,r]of Object.entries(e)){const e=t?`${t}.${n}`:n;"object"==typeof r&&null!==r?this._processStrings(e,r):this._strings.set(e,r)}}getString(t,e=t){let n=this._strings.get(t);if(n)return n;for(const e of this._fallbackChain)if(e!==this._currentLang&&(n=this._cache.get(e)?.get(t),n))return n;return e}getCurrentLanguage(){return this._currentLang}addObserver(t){const e=t.bind(this);this._boundObservers.set(t,e),this._observers.add(e)}removeObserver(t){const e=this._boundObservers.get(t);e&&(this._observers.delete(e),this._boundObservers.delete(t))}_notifyObservers(){for(const t of this._observers)t(this._currentLang)}async loadExtensionStrings(){this._activeExtensionList=await this.updateActiveExtensionList(),await Promise.all(this._activeExtensionList.map((async t=>{try{const e=await fetch(`./extensions/${t.NAME}/strings/${this._currentLang}.json`);if(!e.ok)throw new Error;const n=await e.json();this._extensionStrings.set(t.NAME,n),this._processStrings(`extension.${t.NAME}`,n)}catch(e){console.warn(`No strings found for extension: ${t.NAME}`)}}))),setTimeout((()=>{this._notifyObservers()}),100)}async updateActiveExtensionList(){try{const{EXTENSION_CONFIG:t}=await import(import.meta.resolve("./extensions/extensions.config.js"));return t.filter((t=>t.I18N_ENABLED))}catch(t){return console.error("modernGraphTool: Failed to load extension configuration -",t),[]}}static getInstance(){return StringLoader._instance||(StringLoader._instance=new StringLoader),StringLoader._instance}}StringLoader._instance=null;var t=StringLoader.getInstance();class ConfigGetter{constructor(){this._config=window.GRAPHTOOL_CONFIG,this._cache=new Map,t.addObserver((()=>{this._cache.clear()}))}static getInstance(){return ConfigGetter._instance||(ConfigGetter._instance=new ConfigGetter),ConfigGetter._instance}get(e){const n=`${t.getCurrentLanguage()}:${e}`;if(this._cache.has(n))return this._cache.get(n);const r=this._getValueByPath(e);if(!r)return null;const i=this._processValue(r);return this._cache.set(n,i),i}_processValue(e){if(e&&"object"==typeof e&&e.i18n){const n=t.getCurrentLanguage(),r=e.i18n.en||e.default,i=e.i18n[n];if(!i)return r;if(Array.isArray(r))return r.map(((t,e)=>{const n=i[e];return n?this._mergeWithSharedValues(t,n):t}));if("object"==typeof r)return{...r,...i};if("string"==typeof r){if("true"===r.toLowerCase())return!0;if("false"===r.toLowerCase())return!1}return i}return e}getDefault(t){const e=this._getValueByPath(t);return e?e.default||e:null}_mergeWithSharedValues(t,e){if("object"!=typeof t||"object"!=typeof e)return e||t;const n={...t};for(const[r,i]of Object.entries(e))Array.isArray(i)&&Array.isArray(t[r])?n[r]=t[r]:n[r]=i;return n}_getValueByPath(t){return t.split(".").reduce(((t,e)=>t&&"object"==typeof t?t[e]:void 0),this._config)}has(t){return void 0!==this._getValueByPath(t)}getAvailableLanguages(){const t=this.get("LANGUAGE.LANGUAGE_LIST");return Array.isArray(t)?t.map((([t])=>t)):["en"]}getTargetManifest(){const t=this.get("TARGET_MANIFEST");return t?Array.isArray(t)?t:t.default&&Array.isArray(t.default)?t.default:[]:[]}getWatermarkConfig(){const t=this.get("WATERMARK");return Array.isArray(t)?t.map((t=>{if(Array.isArray(t.CONTENT)){const e=Math.floor(Math.random()*t.CONTENT.length);return{...t,CONTENT:t.CONTENT[e]}}return t})):null}validateConfig(){const t=[],e=["INITIAL_PHONES","INITIAL_TARGETS","PATH","VISUALIZATION"];for(const n of e)this.has(n)||t.push(`Missing required configuration property: ${n}`);const n=this.get("PATH");if(n){const e=["PHONE_MEASUREMENT","TARGET_MEASUREMENT","PHONE_BOOK"];for(const r of e)n[r]||t.push(`Missing required path configuration: PATH.${r}`)}if(this.get("LANGUAGE.ENABLE_I18N")){const e=this.get("LANGUAGE.LANGUAGE_LIST");Array.isArray(e)&&0!==e.length||t.push("LANGUAGE.LANGUAGE_LIST must be a non-empty array when i18n is enabled")}const r=this.get("VISUALIZATION.DEFAULT_Y_SCALE");r&&![40,60,80,100].includes(r)&&t.push("VISUALIZATION.DEFAULT_Y_SCALE must be one of: 40, 60, 80, 100");const i=this.get("NORMALIZATION.TYPE");i&&!["Hz","Avg"].includes(i)&&t.push('NORMALIZATION.TYPE must be either "Hz" or "Avg"');const a=this.get("INTERFACE.PREFERRED_DARK_MODE_THEME");return a&&!["light","dark","system"].includes(a)&&t.push('INTERFACE.PREFERRED_DARK_MODE_THEME must be one of: "light", "dark", "system"'),{isValid:0===t.length,errors:t}}getTypeInfo(t){const e=this._getValueByPath(t);return{type:Array.isArray(e)?"array":typeof e,hasI18n:e&&"object"==typeof e&&"i18n"in e,value:this.get(t),rawValue:e}}clearCache(){this._cache.clear()}getCacheStats(){return{size:this._cache.size,keys:Array.from(this._cache.keys())}}}ConfigGetter._instance=null;var e=ConfigGetter.getInstance();const n={initEventList:{"graph-ui-ready":!1,"phone-ui-ready":!1,"target-ui-ready":!1,"url-loaded":!1},isMobile:window.innerWidth<1e3,init(t){this.coreAPI=t,this._bindCoreInit(),this._bindInterfaceInit(),window.addEventListener("resize",this._updateUI.bind(this))},dispatchInitEvent(t){this.initEventList[t]||(this.initEventList[t]=!0,Object.values(this.initEventList).every((t=>t))&&this.dispatchEvent("init-ready"))},dispatchEvent(t,e){const n=new CustomEvent(`core:${t}`,{detail:e});window.dispatchEvent(n)},_bindCoreInit(){window.addEventListener("DOMContentLoaded",(async()=>{document.documentElement.toggleAttribute("data-mobile",this.isMobile),this._updateTheme(),this.coreAPI.URLProvider.init(this),await this.coreAPI.MetadataParser.init(this),this.coreAPI.DataProvider.init(this)}))},_bindInterfaceInit(){window.addEventListener("core:init-ready",(async()=>{this.coreAPI.MenuState.init(this),this.coreAPI.RenderEngine.init(this,this.coreAPI.DataProvider),this._addInitialData(),this.coreAPI.CoreExtension.init(),this.dispatchEvent("ready")}))},_updateUI(){this.isMobile!==window.innerWidth<1e3&&(this.isMobile=!this.isMobile,document.documentElement.toggleAttribute("data-mobile",this.isMobile),this.dispatchEvent("ui-mode-change",{isMobile:this.isMobile}))},_updateTheme(){var t=e.get("INTERFACE.PREFERRED_DARK_MODE_THEME")?.toLowerCase()||"system";"system"===t&&(t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme",t)},_addInitialData(){const t=this.coreAPI.URLProvider.getPhoneDataFromURL();if(t){(e.get("INITIAL_PHONES")||[]).forEach((async t=>{const e=this.coreAPI.MetadataParser.searchFRInfoWithFullName(t);await this.coreAPI.DataProvider.addFRData("phone",e.identifier,{dispSuffix:e.dispSuffix})}));(e.get("INITIAL_TARGETS")||[]).forEach((async t=>{const e=t.includes(" Target")?t:t+" Target";this.coreAPI.MetadataParser.isTargetAvailable(e)&&await this.coreAPI.DataProvider.addFRData("target",e)}))}else Array.from(t).forEach((async t=>{try{const e=this.coreAPI.MetadataParser.searchFRInfoWithFullName(t);await this.coreAPI.DataProvider.addFRData("phone",e.identifier,{dispSuffix:e.dispSuffix})}catch(e){this.coreAPI.MetadataParser.isTargetAvailable(t)&&await this.coreAPI.DataProvider.addFRData("target",t)}}))}};class GtToast extends HTMLElement{constructor(){super(),this.toasts=new Map,this.nextId=1,this.innerHTML='\n      <div class="toast-container"></div>\n      \n      <style>\n        gt-toast {\n          position: fixed;\n          top: 1rem;\n          left: 50%;\n          transform: translateX(-50%);\n          z-index: 1000;\n          pointer-events: none;\n        }\n\n        .toast-container {\n          display: flex;\n          flex-direction: column;\n          gap: 0.5rem;\n          min-width: 480px;\n          max-width: 720px;\n        }\n\n        .toast-item {\n          display: flex;\n          align-items: center;\n          gap: 0.75rem;\n          padding: 0.875rem 1rem;\n          border-radius: 0.5rem;\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n          font-size: 0.875rem;\n          line-height: 1.25rem;\n          pointer-events: auto;\n          animation: toast-slide-in 0.3s ease-out;\n          position: relative;\n          overflow: hidden;\n        }\n\n        .toast-item.removing {\n          animation: toast-slide-out 0.3s ease-in forwards;\n        }\n\n        .toast-item.success {\n          background: var(--gt-color-success-container, #ccffcd);\n          color: var(--gt-color-on-success-container, #05310d);\n          border-left: 4px solid var(--gt-color-success, #2ea043);\n        }\n\n        .toast-item.error {\n          background: var(--gt-color-error-container, #ffebee);\n          color: var(--gt-color-on-error-container, #410002);\n          border-left: 4px solid var(--gt-color-error, #ba1a1a);\n        }\n\n        .toast-item.warning {\n          background: var(--gt-color-warning-container, #ffeccc);\n          color: var(--gt-color-on-warning-container, #663300);\n          border-left: 4px solid var(--gt-color-warning, #ff9800);\n        }\n\n        .toast-item.loading {\n          background: var(--gt-color-surface-container-high, #f5f5f5);\n          color: var(--gt-color-on-surface, #1c1b1f);\n          border-left: 4px solid var(--gt-color-primary, #6750a4);\n        }\n\n        .toast-icon {\n          flex-shrink: 0;\n          width: 1.25rem;\n          height: 1.25rem;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n\n        .toast-content {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          gap: 0.25rem;\n        }\n\n        .toast-title {\n          font-weight: 600;\n          font-size: 0.875rem;\n        }\n\n        .toast-message {\n          font-size: 0.8125rem;\n          opacity: 0.9;\n        }\n\n        .toast-close {\n          flex-shrink: 0;\n          width: 1.5rem;\n          height: 1.5rem;\n          border: none;\n          background: none;\n          cursor: pointer;\n          border-radius: 0.25rem;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          opacity: 0.7;\n          transition: opacity 0.2s ease;\n        }\n\n        .toast-close:hover {\n          opacity: 1;\n          background: rgba(0, 0, 0, 0.1);\n        }\n\n        .loading-spinner {\n          width: 1rem;\n          height: 1rem;\n          border: 2px solid transparent;\n          border-top: 2px solid currentColor;\n          border-radius: 50%;\n          animation: spin 1s linear infinite;\n        }\n\n        .toast-progress {\n          position: absolute;\n          bottom: 0;\n          left: 0;\n          height: 3px;\n          background: currentColor;\n          opacity: 0.3;\n          transition: width linear;\n        }\n\n        @keyframes toast-slide-in {\n          from {\n            transform: translateY(-100%);\n            opacity: 0;\n          }\n          to {\n            transform: translateY(0);\n            opacity: 1;\n          }\n        }\n\n        @keyframes toast-slide-out {\n          from {\n            transform: translateY(0);\n            opacity: 1;\n            max-height: 200px;\n            margin-bottom: 0.5rem;\n          }\n          to {\n            transform: translateY(-100%);\n            opacity: 0;\n            max-height: 0;\n            margin-bottom: 0;\n            padding-top: 0;\n            padding-bottom: 0;\n          }\n        }\n\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n\n        /* Mobile responsive */\n        @media (max-width: 768px) {\n          gt-toast {\n            top: 0.5rem;\n            left: 0.5rem;\n            right: 0.5rem;\n            transform: none;\n          }\n          \n          .toast-container {\n            min-width: auto;\n          }\n        }\n      </style>\n    '}connectedCallback(){document.addEventListener("gt-toast-show",this._handleToastEvent),document.addEventListener("gt-toast-update",this._handleToastUpdateEvent),document.addEventListener("gt-toast-dismiss",this._handleToastDismissEvent)}disconnectedCallback(){document.removeEventListener("gt-toast-show",this._handleToastEvent),document.removeEventListener("gt-toast-update",this._handleToastUpdateEvent),document.removeEventListener("gt-toast-dismiss",this._handleToastDismissEvent),this.toasts.forEach((t=>{t.timeoutId&&clearTimeout(t.timeoutId)})),this.toasts.clear()}_handleToastEvent=t=>{const{type:e,title:n,message:r,duration:i,persistent:a,id:s}=t.detail;this.show(e,n,r,{duration:i,persistent:a,id:s})};_handleToastUpdateEvent=t=>{const{id:e,title:n,message:r,type:i}=t.detail;this.update(e,{title:n,message:r,type:i})};_handleToastDismissEvent=t=>{const{id:e}=t.detail;this.dismiss(e)};show(t,e,n="",r={}){const{duration:i=("loading"===t?0:5e3),persistent:a="loading"===t,id:s="toast-"+this.nextId++}=r;this.toasts.has(s)&&this.dismiss(s);const o=this.querySelector(".toast-container"),l=this._createToastElement(t,e,n,s,a);o.appendChild(l);const d={id:s,element:l,type:t,title:e,message:n,timeoutId:null};return this.toasts.set(s,d),!a&&i>0&&(d.timeoutId=setTimeout((()=>{this.dismiss(s)}),i)),s}update(t,e={}){const n=this.toasts.get(t);if(!n)return!1;const{title:r,message:i,type:a,dismiss:s=!0}=e;if(void 0!==r){const t=n.element.querySelector(".toast-title");t&&(t.textContent=r),n.title=r}if(void 0!==i){const t=n.element.querySelector(".toast-message");t&&(t.textContent=i,t.style.display=i?"block":"none"),n.message=i}if(void 0!==a&&a!==n.type){n.element.className=`toast-item ${a}`;const t=n.element.querySelector(".toast-icon");t&&(t.innerHTML=this._getIcon(a)),n.type=a}return s&&setTimeout((()=>{this.dismiss(t)}),2e3),!0}dismiss(t){const e=this.toasts.get(t);return!!e&&(e.timeoutId&&clearTimeout(e.timeoutId),e.element.classList.add("removing"),setTimeout((()=>{e.element.parentNode&&e.element.parentNode.removeChild(e.element),this.toasts.delete(t)}),300),!0)}dismissAll(){this.toasts.forEach(((t,e)=>{this.dismiss(e)}))}_createToastElement(t,e,n,r,i){const a=document.createElement("div");a.className=`toast-item ${t}`,a.dataset.toastId=r;const s=this._getIcon(t),o=n&&""!==n.trim();a.innerHTML=`\n      <div class="toast-icon">${s}</div>\n      <div class="toast-content">\n        <div class="toast-title">${e}</div>\n        ${o?`<div class="toast-message">${n}</div>`:""}\n      </div>\n      ${i?"":'\n        <button class="toast-close" aria-label="Close">\n          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">\n            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>\n          </svg>\n        </button>\n      '}\n    `;const l=a.querySelector(".toast-close");return l&&l.addEventListener("click",(()=>{this.dismiss(r)})),a}_getIcon(t){const e={success:'<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M4 12C4 7.58172 7.58172 4 12 4C16.4183 4 20 7.58172 20 12C20 16.4183 16.4183 20 12 20C7.58172 20 4 16.4183 4 12ZM12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2ZM17.4571 9.45711L16.0429 8.04289L11 13.0858L8.20711 10.2929L6.79289 11.7071L11 15.9142L17.4571 9.45711Z"></path>\n      </svg>',error:'<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM11 15H13V17H11V15ZM11 7H13V13H11V7Z"></path>\n      </svg>',warning:'<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>\n      </svg>',loading:'<div class="loading-spinner"></div>'};return e[t]||e.success}static _getInstance(){return document.querySelector("gt-toast")}static show(t,e,n,r={}){const i=GtToast._getInstance();if(!i)return console.warn("GtToast: No gt-toast element found in DOM"),null;let a,s,o;return"object"==typeof e&&null!==e?(a=e.title||"",s=e.message||"",o={...r,...e}):(a=e||"",s=n||"",o=r),i.show(t,a,s,o)}static success(t,e,n={}){return GtToast.show("success",t,e,n)}static error(t,e,n={}){return GtToast.show("error",t,e,n)}static warning(t,e,n={}){return GtToast.show("warning",t,e,n)}static loading(t,e,n={}){return GtToast.show("loading",t,e,{persistent:!0,...n})}static update(t,e){const n=GtToast._getInstance();return n?n.update(t,e):(console.warn("GtToast: No gt-toast element found in DOM"),!1)}static dismiss(t){const e=GtToast._getInstance();return e?e.dismiss(t):(console.warn("GtToast: No gt-toast element found in DOM"),!1)}static dismissAll(){const t=GtToast._getInstance();return t?t.dismissAll():(console.warn("GtToast: No gt-toast element found in DOM"),!1)}}customElements.define("gt-toast",GtToast);var r=Object.freeze({__proto__:null,GtToast:GtToast});const i={activeExtensionList:[],extensionInstances:new Map,async init(){await this.loadExtensionList()},async loadExtensionList(){const t=await this.loadConfiguration();this.activeExtensionList=t.filter((t=>t.ENABLED));for(const t of this.activeExtensionList)await this.loadExtension(t)},async loadExtension(t){try{if(!this.validateExtensionConfig(t))throw new Error(`Invalid extension configuration for ${t.NAME}`);const e=await import(`./extensions/${t.NAME}/main.js`),n=e.EXTENSION_METADATA||{},r=this.checkVersionCompatibility(t.NAME,n);r.compatible||(console.warn(`modernGraphTool: Skipping extension ${t.NAME} - ${r.error}`),GtToast.warning("Incompatible Extension Warning",`Extension '${t.NAME}' is incompatible with the current core version. Loading extension anyway.`,{duration:1e4}));const i=new e.default(t.CONFIG);this.extensionInstances.set(t.NAME,{instance:i,metadata:n}),await(i.init?.());const a=n.version?` v${n.version}`:"";console.log(`modernGraphTool: extension loaded - ${t.NAME}${a}`)}catch(e){console.error(`modernGraphTool: Failed to load extension: ${t.NAME} -`,e)}},checkVersionCompatibility(t,e){if(!e.version||!e.apiLevel)return console.warn(`modernGraphTool: Extension ${t} missing version metadata`),{compatible:!0};const n=this.getCoreVersion(),r=this.getCoreApiLevel();return e.apiLevel!==r?{compatible:!1,error:`API level mismatch: Extension requires API level ${e.apiLevel}, Core provides ${r}`}:e.coreMinVersion&&!this.satisfiesMinVersion(n,e.coreMinVersion)?{compatible:!1,error:`Core version too old: Extension requires >= ${e.coreMinVersion}, found ${n}`}:e.coreMaxVersion&&!this.satisfiesMaxVersion(n,e.coreMaxVersion)?{compatible:!1,error:`Core version too new: Extension supports <= ${e.coreMaxVersion}, found ${n}`}:{compatible:!0}},getCoreVersion:()=>globalThis.CoreAPI?.VERSION||"1.0.0",getCoreApiLevel:()=>globalThis.CoreAPI?.API_LEVEL||1,satisfiesMinVersion(t,e){return this.compareVersions(t,e)>=0},satisfiesMaxVersion(t,e){if(e.includes("x")){const n=e.replace(/\.x$/,"");return t.substring(0,n.length)===n}return this.compareVersions(t,e)<=0},compareVersions(t,e){const n=t.split(".").map(Number),r=e.split(".").map(Number);for(let t=0;t<Math.max(n.length,r.length);t++){const e=n[t]||0,i=r[t]||0;if(e>i)return 1;if(e<i)return-1}return 0},validateExtensionConfig:t=>t.NAME&&"string"==typeof t.NAME,async unloadExtension(t){const e=this.extensionInstances.get(t);e&&(await(e.instance.destroy?.()),this.extensionInstances.delete(t))},getExtension(t){const e=this.extensionInstances.get(t);return e?.instance},getExtensionMetadata(t){const e=this.extensionInstances.get(t);return e?.metadata},getExtensionList(){return this.activeExtensionList},async loadConfiguration(){try{const{EXTENSION_CONFIG:t}=await import(import.meta.resolve("./extensions/extensions.config.js"));return t}catch(t){return console.error("modernGraphTool: Failed to load extension configuration -",t),[]}}},a={_standardFrequencies:function(){const t=[20],e=Math.pow(2,1/48);for(;t[t.length-1]<2e4;)t.push(t[t.length-1]*e);return t}(),async getFRDataFromFile(t,e){const n="phone"===t,r=n?["L","R"]:["AVG"],i={};if(await Promise.all(r.map((async t=>{let r;if(n){const n=e;r="L"===t?n.L:n.R}else r=e;try{const e=await this._fetchFRTextData(n?"phone":"target",r);e&&(i[t]=await this.parseFRData(e))}catch(e){console.error(`Failed to process ${r} ${t} channel:`,e)}}))),n&&i.L&&i.R){const t=i.L.data,e=i.R.data;i.AVG={data:t.map((([t,n],r)=>[t,(n+e[r][1])/2])),metadata:{...i.L.metadata}}}return i},async getFRDataFromMetadata(t,e,n=""){try{if(""===n){const n=e;return await a.getFRDataFromFile(t,n.files[0].files)}{const r=e.files.find((t=>t.suffix===n));if(!r)throw new Error(`No file found with suffix: ${n}`);return await a.getFRDataFromFile(t,r.files)}}catch(t){throw new Error(`Invalid FR file type: ${t instanceof Error?t.message:String(t)}`)}},async parseFRData(t){const e=t.split("\n").map((t=>t.trim())).filter((t=>t&&!t.startsWith("#"))).reduce(((t,e,n)=>{const r=e.split(/[\s,]+/).filter((t=>""!==t));if(r.length<2||isNaN(Number(r[0]))||isNaN(Number(r[1])))return t;const i=this._parseFrequency(r[0]),a=parseFloat(r[1]),s=r[2]?parseFloat(r[2]):null;return this._isValidDataPoint(i,a)&&(t.data.push([i,a]),null!==s&&t.metadata.weights.push(s)),t}),{data:[],metadata:{weights:[],minFreq:1/0,maxFreq:-1/0}});return 0!==e.data.length&&(e.data.sort(((t,e)=>t[0]-e[0])),e.data=this._interpolateToStandard(e.data),e.metadata.minFreq=this._standardFrequencies[0],e.metadata.maxFreq=this._standardFrequencies[this._standardFrequencies.length-1]),e},async _fetchFRTextData(t,n){const r="phone"===t?`${e.get("PATH.PHONE_MEASUREMENT")}`+(e.get("PATH.PHONE_MEASUREMENT").endsWith("/")?"":"/")+`${n}`:`${e.get("PATH.TARGET_MEASUREMENT")}`+(e.get("PATH.TARGET_MEASUREMENT").endsWith("/")?"":"/")+`${n}`;try{const t=await fetch(r);return t.ok?await t.text():null}catch(e){return console.error(`Failed to load ${t}: ${n}`,e),null}},_parseFrequency(t){const e=parseFloat(t);return t.toLowerCase().includes("k")?1e3*e:e},_interpolateToStandard(t){return this._standardFrequencies.map((e=>{const n=t.findIndex((([t])=>t>e));if(-1===n){const n=t[t.length-1];return[e,n[1]]}if(0===n){const n=t[0];return[e,n[1]]}{const[r,i]=t[n-1],[a,s]=t[n];return[e,i+(s-i)*((e-r)/(a-r))]}}))},_isValidDataPoint:(t,e)=>Number.isFinite(t)&&Number.isFinite(e)&&t>=20&&t<=2e4&&e>=-40&&e<=120};class FRNormalizer{constructor(){this.typeList=["Hz","Avg"],this.type=e.get("NORMALIZATION.TYPE")||"Hz",this.Hzvalue=e.get("NORMALIZATION.HZ_VALUE")||500}init(t){this.dataProvider=t}normalize(t){if(!t?.data?.length)throw console.error("Invalid FR data:",t),new Error("Cannot normalize - invalid data structure");const e=this._deepCopyChannelData(t);try{return"Hz"===this.type?this._normalizeByHz(e,this.Hzvalue):this._normalizeByAvg(e,0)}catch(e){return console.error("Normalization failed:",e),t}}async updateNormalization(){const t=new Map;if(!this.dataProvider||!this.dataProvider.getFRDataMap)return void console.error("DataProvider not initialized or missing getFRDataMap method");const e=this.dataProvider.getFRDataMap();(await Promise.all(Array.from(e||[]).map((async([t,e])=>{try{const n=this.normalizeChannels(e.channels);return[t,{...e,channels:"target"===e.type?{...n.AVG&&{AVG:n.AVG}}:{...n.L&&{L:n.L},...n.R&&{R:n.R},...n.AVG&&{AVG:n.AVG}},dispChannel:[...e.dispChannel]}]}catch(n){return console.error("Failed to re-normalize",t,n),[t,e]}})))).forEach((([e,n])=>t.set(e,n))),this.dataProvider.frDataMap=t,n.dispatchEvent("fr-normalized")}normalizeChannels(t){const e={};for(const n of["L","R","AVG"])t[n]&&t[n].data&&t[n].data.length&&(e[n]=this.normalize(t[n]));return e}updateNormalizationType(t){if(!this.typeList.includes(t))throw Error("Wrong Type");this.type=t}updateNormalizationValue(t,e){if(!this.typeList.includes(t))throw Error("Wrong Type");this.Hzvalue=Math.max(20,Math.min(2e4,Number(e)))}_normalizeByHz(t,e){const n=Math.max(20,Math.min(2e4,Number(e))),r=this._findNearestFrequency(t.data,n);if(!r)throw new Error(`No data near ${e}Hz`);const i=-r[1];return t.data.forEach((t=>{t[1]=this._clampDB(t[1]+i)})),t}_normalizeByAvg(t,e){const n=t.data.filter((t=>t[0]>=300&&t[0]<=3e3));if(n.length<3)throw new Error("Insufficient midrange data for normalization");const r=e-n.reduce(((t,e)=>t+e[1]),0)/n.length;return t.data.forEach((t=>{t[1]=this._clampDB(t[1]+r)})),t}_deepCopyChannelData(t){return JSON.parse(JSON.stringify(t))}_clampDB(t){return Math.max(-40,Math.min(120,Number(t.toFixed(2))))}_calculateAverageDB(t){const e=t.map((t=>t[1])).sort(((t,e)=>t-e)),n=Math.floor(.1*e.length),r=e.slice(n,-n);return r.reduce(((t,e)=>t+e),0)/r.length}_findNearestFrequency(t,e){const n=t.findIndex((t=>t[0]>=e));if(-1===n)return t[t.length-1];if(0===n)return t[0];const[r,i]=t[n-1],[a,s]=t[n],o=(Math.log(e)-Math.log(r))/(Math.log(a)-Math.log(r));return[e,i+o*(s-i)]}static getInstance(){return FRNormalizer._instance||(FRNormalizer._instance=new FRNormalizer),FRNormalizer._instance}}FRNormalizer._instance=null;var s=FRNormalizer.getInstance();const o={init(t){this.renderEngine=t,this._bindRenderEvent()},_bindRenderEvent(){window.addEventListener("core:fr-phone-added",(t=>{this.renderEngine.drawFRCurve(t.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-phone-removed",(t=>{this.renderEngine.eraseFRCurve(t.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-target-added",(t=>{this.renderEngine.drawFRCurve(t.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-target-removed",(t=>{this.renderEngine.eraseFRCurve(t.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-unknown-inserted",(t=>{this.renderEngine.drawFRCurve(t.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-unknown-removed",(t=>{this.renderEngine.eraseFRCurve(t.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-normalized",(()=>{this.renderEngine.refreshEveryFRCurves()})),window.addEventListener("core:fr-channel-updated",(t=>{this.renderEngine.channelUpdateRunner(t.detail.uuid,t.detail.type),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-color-updated",(t=>{this.renderEngine.drawFRCurve(t.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-dash-updated",(t=>{this.renderEngine.drawFRCurve(t.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-variant-updated",(t=>{this.renderEngine.drawFRCurve(t.detail.uuid),this.renderEngine.updateLabels()})),window.addEventListener("core:fr-smoothing-updated",(()=>{s.updateNormalization()})),window.addEventListener("core:fr-visibility-updated",(t=>{this.renderEngine.updateVisibility(t.detail.uuid,t.detail.visible)}))}},l={OCTAVE_BANDS:{"1/48":1/48,"1/24":1/24,"1/12":1/12,"1/6":1/6,"1/3":1/3},currentSmoothValue:"1/48",smooth(t){return this.OCTAVE_BANDS[this.currentSmoothValue]&&t?this._smoothChannel(t,this.currentSmoothValue):t},smoothChannels(t){if(!this.OCTAVE_BANDS[this.currentSmoothValue])return t;const e={};for(const n of["L","R","AVG"])e[n]={...t[n]&&{...t[n]},data:this._smoothChannel(t[n]?.data||[],this.currentSmoothValue)};return e},async updateSmoothing(t=null){null!==t&&(this.currentSmoothValue=t),n.dispatchEvent("fr-smoothing-updated")},_smoothChannel(t,e){const n=this._createOctaveBands(e);return this._binData(t,n).map((t=>[t.centerFreq,t.values.reduce(((t,e)=>t+e),0)/t.values.length]))},_createOctaveBands(t){const e=[];let n=20;const r=this.OCTAVE_BANDS[t];for(;n<2e4;){const t=n*Math.pow(2,r);e.push({lower:n,upper:t,centerFreq:Math.sqrt(n*t)}),n=t}return e},_binData:(t,e)=>e.map((e=>({...e,values:t.filter((t=>t&&t[0]>=e.lower&&t[0]<=e.upper)).map((t=>t[1]))}))).filter((t=>t.values.length>0))},d=window.d3;class GraphHandle{constructor(t,e){this.svg=t,this.renderEngine=e,this.yShift=0,this.maxShift=20,this.isMobile=document.documentElement.hasAttribute("data-mobile")||window.innerWidth<1e3,this.handleRadius=this.isMobile?20:10,this._initHandle(),this._setupDragBehavior(),this._attachEventListeners()}_initHandle(){this.handleGroup=this.svg.append("g").attr("class","y-scaler-handle").attr("transform",`translate(${this.renderEngine.graphGeometry.xEnd},0)`),this.handle=this.handleGroup.append("circle").attr("r",this.handleRadius).attr("stroke","var(--gt-color-primary)").attr("stroke-width",2).attr("fill","var(--gt-color-surface-container-highest)").attr("opacity","0.4").attr("cursor","pointer").attr("cy",(this.renderEngine.graphGeometry.yTop+this.renderEngine.graphGeometry.yBottom)/2),this.minY=this.renderEngine.graphGeometry.yTop+this.handleRadius,this.maxY=this.renderEngine.graphGeometry.yBottom-this.handleRadius,this.centerY=(this.minY+this.maxY)/2}_setupDragBehavior(){const t=d.drag().on("start",(()=>{this.handle.attr("opacity","1")})).on("drag",(t=>{const e=Math.max(this.minY,Math.min(this.maxY,t.y));this.handle.attr("cy",e);const n=(e-this.centerY)/(this.maxY-this.centerY);this.yShift=this.maxShift*n,this._updateGraphPosition()})).on("end",(()=>{this.handle.attr("opacity","0.4")}));this.handle.call(t)}_updateGraphPosition(){this.renderEngine.yScale=d.scaleLinear().domain([-this.renderEngine.yScaleValue/2+this.yShift,this.renderEngine.yScaleValue/2+this.yShift]).range([this.renderEngine.graphGeometry.yBottom,this.renderEngine.graphGeometry.yTop]),this.renderEngine.updateYAxis(null,!1),this.renderEngine.curveGroup.attr("transform",`translate(0, ${this.yShift*(this.renderEngine.graphGeometry.yBottom-this.renderEngine.graphGeometry.yTop)/this.renderEngine.yScaleValue})`)}resetHandle(){this.handle.transition().duration(0).attr("cy",this.centerY),this.yShift=0,this._updateGraphPosition()}_attachEventListeners(){this.handle.on("dblclick touchstart",(t=>{if("touchstart"===t.type){let e=this.handle.property("lastTouch")||0;const n=(new Date).getTime();n-e<=300?(t.preventDefault(),this.resetHandle(),this.handle.property("lastTouch",0)):this.handle.property("lastTouch",n)}else this.resetHandle()})),window.addEventListener("core:ui-mode-change",(t=>{this.isMobile=t.detail.isMobile,this.handleRadius=this.isMobile?20:10,this.handle.attr("r",this.handleRadius),this.minY=this.renderEngine.graphGeometry.yTop+this.handleRadius,this.maxY=this.renderEngine.graphGeometry.yBottom-this.handleRadius,this.centerY=(this.minY+this.maxY)/2,0===this.yShift&&this.handle.attr("cy",this.centerY)}))}}const c=window.d3;class GraphInspection{constructor(t){this.renderEngine=t,this.isEnabled=!1,this.verticalLine=null,this.inspectionGroup=null,this.valueDisplay=null,this.bisector=c.bisector((t=>t[0])).left,this._setupInspectionElements(),this._bindEvents()}_setupInspectionElements(){this.inspectionGroup=this.renderEngine.svg.append("g").attr("class","fr-graph-inspection").style("pointer-events","none").style("display","none"),this.verticalLine=this.inspectionGroup.append("line").attr("class","inspection-line").attr("y1",this.renderEngine.graphGeometry.yTop).attr("y2",this.renderEngine.graphGeometry.yBottom).attr("stroke","var(--gt-color-on-surface)").attr("stroke-width",1).attr("stroke-dasharray","2,2").attr("opacity",.7),this.valueDisplay=this.inspectionGroup.append("g").attr("class","inspection-values"),this.frequencyText=this.inspectionGroup.append("text").attr("class","inspection-frequency").attr("y",this.renderEngine.graphGeometry.yBottom-15).attr("text-anchor","middle").attr("font-size","16px").attr("font-weight","bold").attr("fill","var(--gt-color-on-surface)")}_bindEvents(){window.addEventListener("core:inspection-mode-change",(t=>{this.setEnabled(t.detail.enabled)}))}setEnabled(t){this.isEnabled=t,t?(this._enableMouseTracking(),this._hideLabels(),this.inspectionGroup.style("display","block")):(this._disableMouseTracking(),this._showLabels(),this.inspectionGroup.style("display","none"))}_enableMouseTracking(){this.mouseTracker=this.renderEngine.svg.append("rect").attr("class","mouse-tracker").attr("x",this.renderEngine.graphGeometry.xStart).attr("y",this.renderEngine.graphGeometry.yTop).attr("width",this.renderEngine.graphGeometry.xEnd-this.renderEngine.graphGeometry.xStart).attr("height",this.renderEngine.graphGeometry.yBottom-this.renderEngine.graphGeometry.yTop).attr("fill","none").attr("pointer-events","all").style("cursor","crosshair"),this.mouseTracker.on("mousemove",(t=>this._onMouseMove(t))).on("mouseleave",(()=>this._onMouseLeave()))}_disableMouseTracking(){this.mouseTracker&&(this.mouseTracker.remove(),this.mouseTracker=null)}_onMouseMove(t){const[e]=c.pointer(t),n=this.renderEngine.xScale.invert(e);this.verticalLine.attr("x1",e).attr("x2",e),this._updateFrequencyDisplay(n,e),this._updateValueDisplays(n,e)}_onMouseLeave(){this.inspectionGroup.style("opacity",.7)}_updateFrequencyDisplay(t,e){const n=t>=1e3?`${(t/1e3).toFixed(1)}kHz`:`${Math.round(t)}Hz`,r=10*n.length/2;let i=e,a="middle";e+r>this.renderEngine.graphGeometry.xEnd?(i=e-10,a="end"):e-r<this.renderEngine.graphGeometry.xStart&&(i=e+10,a="start"),this.frequencyText.attr("x",i).attr("text-anchor",a).text(n)}_updateValueDisplays(t,e){this.valueDisplay.selectAll("*").remove();let n=0;const r=[];let i=0;Array.from(this.renderEngine.dataProvider.frDataMap).filter((([t,e])=>!e.hidden)).sort((([,t],[,e])=>"target"===t.type?-1:1)).forEach((([e,a])=>{("target"===a.type?["AVG"]:[...a.dispChannel]).forEach((e=>{const s=a.channels[e]?.data;if(!s)return;const o=this._interpolateSPL(s,t);if(null===o)return;const l=this._applyBaselineCompensation(o,t),d=`${"target"!==a.type?`${a.identifier} (${e})`:a.identifier}: ${l.toFixed(1)}dB`,c=9*d.length+50;i=Math.max(i,c),r.push({displayText:d,textWidth:c,color:a.colors[e]||a.colors?.AVG||"#666",yOffset:n}),n+=18}))}));const a=this.renderEngine.graphGeometry.xEnd-e,s=e-this.renderEngine.graphGeometry.xStart;let o,l;a>=i+15?(o=e+15,l="start"):s>=i+15?(o=e-15,l="end"):a>s?(o=e+10,l="start"):(o=e-10,l="end"),r.forEach((t=>{const e=this.valueDisplay.append("g").attr("transform",`translate(${o}, ${this.renderEngine.graphGeometry.yTop+32+t.yOffset})`);let n,r;"start"===l?(n=-5,r=t.textWidth):(n=5-t.textWidth,r=t.textWidth),e.append("rect").attr("x",n).attr("y",-16).attr("width",r).attr("height",18).attr("fill","var(--gt-color-surface-container-lowest)").attr("rx",2).attr("opacity",.7),e.append("text").attr("x",0).attr("y",-2).attr("text-anchor",l).attr("font-size","16px").attr("font-weight","500").attr("fill",t.color).text(t.displayText)})),this.inspectionGroup.style("opacity",1)}_interpolateSPL(t,e){if(!t||0===t.length)return null;const n=this.bisector(t,e),r=t[n-1],i=t[n];if(r&&i){const t=(e-r[0])/(i[0]-r[0]);return r[1]+t*(i[1]-r[1])}return r?r[1]:i?i[1]:null}_applyBaselineCompensation(t,e){const n=this.renderEngine.getBaselineData();if(!n.channelData||0===n.channelData.length)return t;const r=this._interpolateSPL(n.channelData,e);return null===r?t:t-r}_hideLabels(){this.renderEngine.svg.selectAll(".fr-graph-label, .fr-graph-label-bg").style("display","none")}_showLabels(){this.renderEngine.svg.selectAll(".fr-graph-label, .fr-graph-label-bg").style("display","block")}onLabelsUpdated(){this.isEnabled&&this._hideLabels()}destroy(){this._disableMouseTracking(),this.inspectionGroup&&this.inspectionGroup.remove()}}const h=window.d3;class RenderEngine{constructor(){this.graphGeometry={xStart:15,xEnd:785,yTop:15,yBottom:435},this.labelPosition={BOTTOM_LEFT:{x:60,y:427,anchor:"start",growUp:!0},BOTTOM_RIGHT:{x:740,y:427,anchor:"end",growUp:!0},TOP_LEFT:{x:60,y:60,anchor:"start",growUp:!1},TOP_RIGHT:{x:740,y:60,anchor:"end",growUp:!1}},this.baselineData={uuid:null,identifier:null,channelData:null},this.transitionDuration=300}init(t,n){this.coreEvent=t,this.dataProvider=n,o.init(this),this.yScaleValue=parseInt(e.get("VISUALIZATION.DEFAULT_Y_SCALE"))||60,this.svg=h.select("#fr-graph").attr("viewBox","0 0 800 450").attr("preserveAspectRatio","xMidYMid meet"),this._setupScales(),this._drawAxis(),this._drawFadeGradient(),this._createCurveGroup(),(t=>{const n={BOTTOM_LEFT:{x:50,y:400,anchor:"start"},BOTTOM_RIGHT:{x:754,y:400,anchor:"end"},TOP_LEFT:{x:50,y:70,anchor:"start"},TOP_RIGHT:{x:754,y:70,anchor:"end"},CENTER:{x:400,y:275,anchor:"middle"}},r=e.get("VISUALIZATION.RIG_DESCRIPTION")||"Measured with IEC 60318-4 (711)";t.append("text").attr("class","rig-description").attr("x",n.TOP_RIGHT.x).attr("y",n.TOP_RIGHT.y-8).attr("font-size","15px").attr("font-weight","500").attr("text-anchor",n.TOP_RIGHT.anchor).attr("fill","#000").attr("opacity","0.3").attr("filter","var(--watermark-text-filter)").text(r);const i=e.get("WATERMARK")||[],a=t.append("g").attr("class","watermark-group").attr("transform","translate(0, 0)");i.forEach((t=>{const e={x:n[t.LOCATION||"MIDDLE"].x+(t.POSITION?t.POSITION.RIGHT-t.POSITION.LEFT:0),y:n[t.LOCATION||"MIDDLE"].y+(t.POSITION?t.POSITION.DOWN-t.POSITION.UP:0),anchor:n[t.LOCATION||"MIDDLE"].anchor};"IMAGE"===t.TYPE?a.append("image").attr("class","watermark-image").attr("x",e.x).attr("y",e.y).attr("width",t.SIZE||"100px").attr("opacity",t.OPACITY||"0.3").attr("href",Array.isArray(t.CONTENT)?t.CONTENT[Math.floor(Math.random()*t.CONTENT.length)]:t.CONTENT||""):"TEXT"===t.TYPE&&a.append("text").attr("class","watermark-text").attr("x",e.x).attr("y",e.y).attr("font-size",t.SIZE||"20px").attr("font-weight",t.FONT_WEIGHT||"500").attr("font-family",t.FONT_FAMILY||"").attr("text-anchor",e.anchor).attr("fill",t.COLOR||"#000").attr("opacity",t.OPACITY||"0.3").attr("filter","var(--watermark-text-filter)").text(Array.isArray(t.CONTENT)?t.CONTENT[Math.floor(Math.random()*t.CONTENT.length)]:t.CONTENT||"")}))})(this.svg),this.graphHandle=new GraphHandle(this.svg,this),this.graphInspection=new GraphInspection(this)}refreshEveryFRCurves(){this._updateCurveTimeout&&clearTimeout(this._updateCurveTimeout),this._updateCurveTimeout=setTimeout((()=>{this.svg.select(".fr-graph-curve-container").selectAll("*").remove(),Array.from(this.dataProvider.getFRDataMap()).forEach((([t,e])=>{this.drawFRCurve(t)})),this.orderOverlayLayers(),this._updateCurveTimeout=null}),100)}updateYScale(t){this.yScaleValue=parseInt(t),this._setupScales(),this.graphHandle.resetHandle(),this.updateYAxis(),this.curveGroup.selectAll("*").transition().duration(this.transitionDuration).attr("d",(t=>{const e=h.line().x((t=>this.xScale(t[0]))).y((t=>this.yScale(t[1]))).curve(h.curveNatural);return e(t)}))}updateLabels(){this._updateLabelTimeout&&clearTimeout(this._updateLabelTimeout),this._updateLabelTimeout=setTimeout((()=>{var t=0;const n=e.get("VISUALIZATION.LABEL.LOCATION")||"BOTTOM_LEFT",r=this.labelPosition[n].x+parseInt(e.get("VISUALIZATION.LABEL.POSITION.RIGHT")||0)-parseInt(e.get("VISUALIZATION.LABEL.POSITION.LEFT")||0),i=this.labelPosition[n].y+parseInt(e.get("VISUALIZATION.LABEL.POSITION.DOWN")||0)-parseInt(e.get("VISUALIZATION.LABEL.POSITION.UP")||0),a=parseInt(e.get("VISUALIZATION.LABEL.TEXT_SIZE")||17)+8;this.labelBgGroup&&this.labelBgGroup.remove(),this.labelBgGroup=this.svg.append("g").attr("class","fr-graph-label-bg").attr("transform",`translate(${r},${i})`),this.labelGroup&&this.labelGroup.remove(),this.labelGroup=this.svg.append("g").attr("class","fr-graph-label").attr("transform",`translate(${r},${i})`),Array.from(this.dataProvider.frDataMap).sort((([,t],[,e])=>"target"===t.type?-1:1)).forEach((([s,o])=>{if(o.hidden)return;[...o.dispChannel].forEach((r=>{const i="target"!==o.type?`${o.identifier} ${o.dispSuffix} (${r})`:`${o.identifier} ${o.dispSuffix}`;this.labelBgGroup.append("rect").attr("class","fr-graph-label-bg-rect").attr("x",-10).attr("y",""+(t-.75)*a).attr("rx",4).attr("ry",4).attr("uuid",o.uuid).attr("width",i.length*a*.35).attr("height",a).attr("fill","var(--gt-color-surface-container-lowest)").attr("opacity","0.7").attr("filter","blur(4px)"),this.labelGroup.append("text").attr("class","fr-graph-label-text").attr("y",""+t*a).attr("fill",o.colors[r]||o.colors?.AVG).attr("style",this.labelPosition[n].style).attr("text-anchor",this.labelPosition[n].anchor).attr("font-size",e.get("VISUALIZATION.LABEL.TEXT_SIZE")||"20px").attr("font-weight",e.get("VISUALIZATION.LABEL.TEXT_WEIGHT")||600).attr("uuid",o.uuid).text(i),t++})),this.labelPosition[n].growUp&&(this.labelGroup.attr("transform",`translate(${r}, ${i-t*a})`),this.labelBgGroup.attr("transform",`translate(${r}, ${i-t*a})`))})),this._updateLabelTimeout=null,this.graphInspection&&this.graphInspection.onLabelsUpdated()}),0)}updateBaselineData(t,{uuid:e=null,channelData:n=null}){if(t){if(null===e)return void console.error("Baseline UUID is not defined");const t=this.dataProvider.getFRData(e);this.baselineData={uuid:e,identifier:t.identifier,channelData:null!==n?n:"phone"===t.type?t.channels[t.dispChannel.includes("L")&&t.dispChannel.includes("R")?"AVG":t.dispChannel[0]]?.data:t.channels.AVG.data}}else this.baselineData={uuid:null,identifier:null,channelData:null};this.updateBaseline(!0),this.updateBaselineLabel()}updateBaseline(t=!1){const e=this;this.curveGroup.selectAll("path[class*='fr-graph-'][class*='-curve']").transition().duration(t?this.transitionDuration:0).attrTween("d",(function(t){const n=h.select(this).attr("d"),r=e._getCompensatedPath(t);return t=>h.interpolateString(n,r)(t)})),this.coreEvent.dispatchEvent("fr-baseline-updated",{baselineUUID:this.baselineData.uuid,baselineIdentifier:this.baselineData.identifier})}updateBaselineLabel(){const t=this.baselineData.uuid,n=this.baselineData.identifier;if(null===t)this.svg.selectAll(".fr-graph-baseline-text").remove();else if(!this.svg.selectAll(`.fr-graph-baseline-text[data-uuid='${t}']`).size()){const r=this.svg.selectAll(".fr-graph-baseline-text");r&&r.remove();const i=e.get("VISUALIZATION.BASELINE_LABEL.LOCATION")||"BOTTOM_LEFT",a=this.labelPosition[i].x+parseInt(e.get("VISUALIZATION.BASELINE_LABEL.POSITION.RIGHT")||0)-parseInt(e.get("VISUALIZATION.BASELINE_LABEL.POSITION.LEFT")||0),s=this.labelPosition[i].y+parseInt(e.get("VISUALIZATION.BASELINE_LABEL.POSITION.DOWN")||0)-parseInt(e.get("VISUALIZATION.BASELINE_LABEL.POSITION.UP")||0);this.svg.append("text").attr("class","fr-graph-baseline-text").attr("data-uuid",t).attr("x",a).attr("y",s).attr("text-anchor",this.labelPosition[i].anchor).attr("fill","#000000").attr("opacity","0.3").attr("font-size",e.get("VISUALIZATION.BASELINE_LABEL.TEXT_SIZE")||"15px").attr("font-weight",e.get("VISUALIZATION.BASELINE_LABEL.TEXT_WEIGHT")||"500").text(`${n} Compensated`)}}updateVisibility(t,e){this.svg.selectAll(`.fr-graph-curve-container *[uuid="${t}"]`).attr("visibility",e?"visible":"hidden"),this.updateLabels()}_getCompensatedPath(t){const e=h.bisector((t=>t[0])).left,n=Array.isArray(this.baselineData.channelData)&&this.baselineData.channelData.length>0;return h.line().x((t=>this.xScale(t[0]))).y((t=>{if(!n)return this.yScale(t[1]);const r=e(this.baselineData.channelData,t[0],0),i=this.baselineData.channelData[r-1],a=this.baselineData.channelData[r];let s=0;if(i&&a){const e=(t[0]-i[0])/(a[0]-i[0]);s=i[1]+e*(a[1]-i[1])}else i?s=i[1]:a&&(s=a[1]);return this.yScale(t[1]-s)})).curve(h.curveNatural)(t)}getBaselineData(){return this.baselineData}orderOverlayLayers(){this.svg.selectAll(".fr-graph-x-axis, .fr-graph-y-axis").lower(),this.svg.selectAll(".fr-graph-curve-container").raise(),this.svg.selectAll(".x-grid-text, .y-grid-text").raise(),this.svg.selectAll(".fr-graph-label, .fr-graph-label-bg").raise()}_setupScales(){this.xScale=h.scaleLog().domain([20,2e4]).range([this.graphGeometry.xStart,this.graphGeometry.xEnd]),this.yScale=h.scaleLinear().domain([-this.yScaleValue/2,this.yScaleValue/2]).range([this.graphGeometry.yBottom,this.graphGeometry.yTop])}getScales(){return{xScale:this.xScale,yScale:this.yScale}}_drawAxis(){this.svg.select(".fr-graph-x-axis").empty()&&this.svg.append("g").attr("class","fr-graph-x-axis").attr("transform","translate(0,0)"),this.svg.select(".fr-graph-y-axis").empty()&&this.svg.append("g").attr("class","fr-graph-y-axis").attr("transform","translate(0,0)"),this.updateXAxis(),this.updateYAxis()}_createCurveGroup(){this.svg.select(".fr-graph-curve-container").empty()&&(this.curveGroup=this.svg.append("g").attr("class","fr-graph-curve-container").attr("transform","translate(0,0)").attr("fill","none").attr("mask","url(#blur-fade-mask)"))}drawFRCurve(t){this.eraseFRCurve(t);const e=this.dataProvider.getFRData(t);"phone"===e.type?this._drawPhoneCurve(e):"target"===e.type?this._drawTargetCurve(e):this._drawUnknownCurve(e)}_drawPhoneCurve(t){[...t.dispChannel].forEach((n=>{this.curveGroup.append("path").datum((()=>l.smooth(t.channels[n].data))).attr("class","fr-graph-phone-curve").attr("uuid",t.uuid).attr("type",t.type).attr("channel",n).attr("identifier",t.identifier).attr("stroke",`${t.colors[n]||t.colors.AVG}`).attr("stroke-width",e.get("TRACE_STYLING.PHONE_TRACE_THICKNESS")||2).attr("stroke-dasharray",t.dash||"1 0").attr("d",(t=>this._getCompensatedPath(t)))}))}_drawTargetCurve(t){this.curveGroup.append("path").datum(t.channels.AVG.data).attr("class","fr-graph-target-curve").attr("uuid",t.uuid).attr("type",t.type).attr("identifier",t.identifier).attr("stroke",`${t.colors.AVG||"#666"}`).attr("stroke-width",e.get("TRACE_STYLING.TARGET_TRACE_THICKNESS")||1).attr("stroke-dasharray",t.dash||"4 4").attr("d",(t=>this._getCompensatedPath(t)))}_drawUnknownCurve(t){[...t.dispChannel].forEach((n=>{this.curveGroup.append("path").datum((()=>l.smooth(t.channels[n].data))).attr("class",`fr-graph-${t.type}-curve`).attr("uuid",t.uuid).attr("type",t.type).attr("channel",n).attr("identifier",t.identifier).attr("stroke",`${t.colors[n]||t.colors.AVG}`).attr("stroke-width","inserted-target"===t.type?e.get("TRACE_STYLING.TARGET_TRACE_THICKNESS")||1:e.get("TRACE_STYLING.PHONE_TRACE_THICKNESS")||2).attr("stroke-dasharray",t.dash||"1 0").attr("d",(t=>this._getCompensatedPath(t)))}))}eraseFRCurve(t){this.curveGroup.selectAll(`*[uuid="${t}"]`).remove()}updateXAxis(t=!0){const e=new Set([80,300,1e3,4e3,6e3,1e4]),n=this.svg.select(".fr-graph-x-axis").selectAll(".x-grid-group").data([20,30,40,50,60,70,80,100,200,300,400,500,600,800,1e3,2e3,3e3,4e3,5e3,6e3,8e3,1e4,15e3,2e4],(t=>t));n.exit().transition().duration(t?this.transitionDuration:0).style("opacity",0).remove();const r=n.enter().append("g").attr("class","x-grid-group").attr("transform",(t=>`translate(${this.xScale(t)},0)`)).style("opacity",0);this._createXAxisElements(r,e);r.merge(n).transition().duration(t?this.transitionDuration:0).style("opacity",1).attr("transform",(t=>`translate(${this.xScale(t)},0)`)),this.orderOverlayLayers()}_createXAxisElements(t,e){t.append("line").attr("class",(t=>e.has(t)?"x-grid-line-major":"x-grid-line")).attr("x1",0).attr("x2",0).attr("y1",this.graphGeometry.yBottom).attr("y2",this.graphGeometry.yTop).attr("stroke",(t=>20===t||2e4===t||e.has(t)?"var(--gt-graph-grid-major)":"var(--gt-graph-grid-minor)")).attr("stroke-width",(t=>20===t||2e4===t||e.has(t)?1:.5)),t.append("text").attr("class",(t=>e.has(t)?"x-grid-text-major":"x-grid-text")).attr("x",0).attr("y",this.graphGeometry.yBottom).attr("dy","11").attr("font-size","0.6rem").attr("font-weight",(t=>e.has(t)?"500":"300")).attr("text-anchor","middle").attr("fill","var(--gt-graph-grid-text)").text((t=>t>=1e3?t/1e3+"k":t))}updateYAxis(t=null,e=!0){const n=this.yScale,r=this.yScaleValue<60?n.ticks(this.yScaleValue):n.ticks(this.yScaleValue/5),i=this.svg.select(".fr-graph-y-axis"),a=i.selectAll(".y-grid-group").data(r,(t=>t));a.exit().transition().duration(e?this.transitionDuration:0).style("opacity",0).remove();const s=a.enter().append("g").attr("class","y-grid-group").attr("y",(t=>t)).style("opacity",0);this._createYAxisElements(s,t||n);const o=s.merge(a);o.transition().duration(e?this.transitionDuration:0).style("opacity",1),o.selectAll(".y-grid-line, .y-grid-line-major").transition().duration(e?this.transitionDuration:0).attr("y1",(t=>n(t))).attr("y2",(t=>n(t))),o.selectAll(".y-grid-text").transition().duration(e?this.transitionDuration:0).attr("y",(t=>n(t)));let l=i.select(".y-grid-db-text");l.empty()&&(l=i.append("text").attr("class","y-grid-db-text").attr("transform","rotate(-90)").text("dB")),l.attr("x",-31).attr("y",15).attr("dx",4).attr("dy",-4).attr("font-size","0.6rem").attr("font-weight","400").attr("text-anchor","start").attr("fill","var(--gt-graph-grid-text)"),this.orderOverlayLayers()}_createYAxisElements(t,e){t.append("line").attr("class",(t=>t%10==0?"y-grid-line":"y-grid-line-major")).attr("x1",this.graphGeometry.xStart).attr("x2",this.graphGeometry.xEnd).attr("y1",(t=>e(t))).attr("y2",(t=>e(t))).attr("stroke",(t=>t%10==0?"var(--gt-graph-grid-major)":"var(--gt-graph-grid-minor)")).attr("stroke-width",(t=>t%10==0?1:.7)),t.each(((t,n,r)=>{t%10==0&&h.select(r[n]).append("text").attr("class","y-grid-text").attr("x",this.graphGeometry.xStart).attr("y",e(t)).attr("dx",4).attr("dy",-4).attr("font-size","0.6rem").attr("font-weight","400").attr("text-anchor","start").attr("fill","var(--gt-graph-grid-text)").text(t)}))}_drawFadeGradient(){this.svg.append("defs").append("mask").attr("id","blur-fade-mask").append("rect").attr("x",20).attr("y",20).attr("width",760).attr("height",410).attr("fill","white").attr("filter","blur(5px)")}channelUpdateRunner(t,e){this.curveGroup.selectAll(`.fr-graph-${e}-curve[uuid="${t}"]`).remove(),"phone"===e?this._drawPhoneCurve(this.dataProvider.getFRData(t)):this._drawUnknownCurve(this.dataProvider.getFRData(t))}static getInstance(){return RenderEngine._instance||(RenderEngine._instance=new RenderEngine),RenderEngine._instance}}RenderEngine._instance=null;var u=RenderEngine.getInstance();const p={phoneMetadata:null,targetMetadata:null,coreEvent:null,async init(t){this.coreEvent=t,this.phoneMetadata||(this.phoneMetadata=await this._fetchBookObject()),this.targetMetadata||(this.targetMetadata=this._fetchTargetObject()),this.coreEvent.dispatchEvent("metadata-loaded")},isPhoneAvailable(t){return!!this.phoneMetadata&&(this.phoneMetadata.some((e=>e.phones.some((e=>e.identifier===t))))||this.phoneMetadata.some((e=>e.phones.some((n=>n.files.some((r=>{if(r.fullName)return r.fullName===t;const i=Array.isArray(n.name)?n.name[0]:n.name;return e.brand+" "+i+" "+r.suffix===t})))))))},isTargetAvailable(t){return!!this.targetMetadata&&this.targetMetadata.some((e=>e.files.some((e=>(e.includes(" Target")?e:`${e} Target`)===(t.includes(" Target")?t:`${t} Target`)))))},getFRMetadata(t,e){if("phone"===t){if(!this.phoneMetadata)throw new Error("Phone metadata not loaded");for(const t of this.phoneMetadata){const n=t.phones.find((t=>t.identifier===e));if(n)return n}return this.searchFRInfoWithFullName(e)}if("target"===t)return{identifier:e,files:[{files:`${e}.txt`}]};return{identifier:e,files:[{files:`${e}.txt`}]}},searchFRInfoWithFullName(t){if(!this.phoneMetadata)throw new Error("Phone metadata not loaded");for(const e of this.phoneMetadata)for(const n of e.phones){for(const e of n.files)if(e.fullName.toLowerCase()===t.toLowerCase()||e.fileName.toLowerCase()===t.toLowerCase()||e.fileName.replace(" ","_").toLowerCase()===t.toLowerCase())return{...n,dispSuffix:e.suffix||""};if(n.identifier.toLowerCase()===t.toLowerCase())return{...n,dispSuffix:n.files[0].suffix}}throw new Error(`No such data found: ${t}`)},async _fetchBookObject(){return(await fetch(e.get("PATH.PHONE_BOOK")||"../../../data/phone_book.json").then((t=>t.json()))).map((t=>{const e=[t.name,t.suffix].filter(Boolean).join(" ");return{brand:e,phones:t.phones.map((t=>{const n={brand:e,..."object"==typeof t&&t.reviewScore&&{reviewScore:t.reviewScore},..."object"==typeof t&&t.reviewLink&&{reviewLink:t.reviewLink},..."object"==typeof t&&t.shopLink&&{shopLink:t.shopLink},..."object"==typeof t&&t.price&&{price:t.price}};if("string"==typeof t)return{...n,name:t,identifier:e+" "+t,files:[{suffix:this._getSuffix(t,0),fullName:(e+" "+t+" "+this._getSuffix(t,0)).trim(),files:{L:t+" L.txt",R:t+" R.txt"},fileName:t}]};const r=Array.isArray(t.name)?t.name[0]:t.name;return{...n,name:r,identifier:e+" "+r,files:Array.isArray(t.file)?t.file.map(((n,i)=>({suffix:this._getSuffix(t,i),fullName:(e+" "+r+" "+this._getSuffix(t,i)).trim(),files:{L:`${n} L.txt`,R:`${n} R.txt`},fileName:n}))):[{suffix:this._getSuffix(t,0),fullName:(e+" "+r+" "+this._getSuffix(t,0)).trim(),files:{L:`${t.file} L.txt`,R:`${t.file} R.txt`},fileName:t.file||r}]}}))}}))},_fetchTargetObject:()=>(e.getDefault("TARGET_MANIFEST")||[]).map((t=>({type:t.type,files:t.files.map((t=>t.includes(" Target")?t:`${t} Target`))}))),_getSuffix:(t,e=null)=>"string"==typeof t?"":Array.isArray(t.file)?Array.isArray(t.suffix)&&null!==e?t.suffix[e]?.trim()||String(e):"string"==typeof t.suffix?t.suffix.trim()||String(e):Array.isArray(t.prefix)&&null!==e?t.file[e]?.replace(new RegExp(t.prefix[e],"i"),"").trim()||"":"string"==typeof t.prefix&&null!==e&&t.file[e]?.replace(new RegExp(t.prefix,"i"),"").trim()||"":"string"==typeof t.suffix?t.suffix.trim()||t.file?.trim()||"":"string"==typeof t.prefix&&t.file?t.file.replace(new RegExp(t.prefix,"i"),"").trim():""};class DataProvider{constructor(){this.frDataMap=new Map,this.baseHue=null,this.coreEvent=null}init(t){this.coreEvent=t,s.init(this),this.addEventListeners()}addEventListeners(){window.addEventListener("core:fr-phone-added",this.updateChannels.bind(this)),window.addEventListener("core:fr-target-added",this.updateChannels.bind(this)),window.addEventListener("core:fr-unknown-inserted",this.updateChannels.bind(this))}async addFRData(t,e,n={}){if(this.isFRDataLoaded(e,n?.dispSuffix||null))return;const r=await p.getFRMetadata(t,e),i=await a.getFRDataFromMetadata(t,r,n?.dispSuffix),o=l.smoothChannels(i),d=s.normalizeChannels(o),c=Object.keys(d),h={uuid:crypto.randomUUID(),type:t,identifier:r?.identifier||e,channels:"phone"===t?{...d.L&&{L:d.L},...d.R&&{R:d.R},...d.AVG&&{AVG:d.AVG}}:{...d.AVG&&{AVG:d.AVG}},dispChannel:this._getChannelValue(t,c),dispSuffix:"files"in r&&r.files.length>1?n?.dispSuffix?n?.dispSuffix:"suffix"in r.files[0]?r.files[0].suffix:"":"",colors:this._getColorWithType(t),dash:this._getDashWithType(t,r?.identifier||void 0),meta:r};this.frDataMap.set(h.uuid,h),this.coreEvent.dispatchEvent(`fr-${t}-added`,{uuid:h.uuid,identifier:r?.identifier||e})}removeFRData(t,e){const n=Array.from(this.frDataMap).find((([,t])=>t.identifier===e));if(n){const[e]=n;this.frDataMap.delete(e);const r=["phone","target"].includes(t)?`fr-${t}-removed`:"fr-unknown-removed";this.coreEvent.dispatchEvent(r,{uuid:e,identifier:n[1].identifier})}}async insertRawFRData(t,e,n,r={}){try{const i=l.smoothChannels(n),a=s.normalizeChannels(i),o=Object.keys(a),d={uuid:crypto.randomUUID(),type:`inserted-${t}`,identifier:e,channels:{...a.L&&{L:a.L},...a.R&&{R:a.R},...a.AVG&&{AVG:a.AVG}},dispChannel:r?.dispChannel?[...r?.dispChannel]:this._getChannelValue(t,o),dispSuffix:r?.dispSuffix?r?.dispSuffix:"(Inserted)",colors:this._getColorWithType(t),dash:this._getDashWithType(t,e)};this.frDataMap.set(d.uuid,d),this.coreEvent.dispatchEvent("fr-unknown-inserted",{uuid:d.uuid,identifier:e})}catch(t){throw new Error("An Error Occurred while adding FR Data")}}removeFRDataWithUUID(t,e){const n=Array.from(this.frDataMap).find((([t])=>t===e));if(n){this.frDataMap.delete(e);const r=["phone","target"].includes(t)?`fr-${t}-removed`:"fr-unknown-removed";this.coreEvent.dispatchEvent(r,{uuid:e,identifier:n[1].identifier})}}getFRData(t){if(this.frDataMap.has(t))return structuredClone(this.frDataMap.get(t))}getFRDataMap(){return structuredClone(this.frDataMap)}isFRDataLoaded(t,e=""){return""===e?Array.from(this.frDataMap).some((([,e])=>e.identifier===t)):Array.from(this.frDataMap).some((([,n])=>n.identifier===t&&n.dispSuffix===e))}getUUIDwithIdentifier(t){const e=Array.from(this.frDataMap).find((([,e])=>e.identifier===t));if(e){const[t]=e;return t}return""}getLoadedFRIdentifierBySource(t){return Array.from(this.frDataMap).filter((([,e])=>e.type===t)).map((([t,e])=>e.identifier))}async toggleFRData(t,e,n){try{n?await this.addFRData(t,e):this.removeFRData(t,e)}catch(t){throw new Error("An Error Occurred while toggling FR Data")}}async updateVariant(t,e){const n=this.getFRData(t);if(!n)throw new Error("No data found for UUID: "+t);try{const r=await a.getFRDataFromMetadata("phone",n.meta,e),i=l.smoothChannels(r),o=s.normalizeChannels(i),d=n.dispChannel.every((t=>Object.keys(o).includes(t)))?[...n.dispChannel]:[Object.keys(o)[0]];this.frDataMap.set(t,{...n,channels:{...o.L&&{L:o.L},...o.R&&{R:o.R},...o.AVG&&{AVG:o.AVG}},dispSuffix:e,dispChannel:d}),this.coreEvent.dispatchEvent("fr-variant-updated",{uuid:t})}catch(t){throw new Error("An Error Occurred while updating FR Data")}}updateFRDataWithRawData(t,e,{identifier:n=null,dispSuffix:r=null,meta:i}){if(!this.frDataMap.has(t))throw new Error("No data found for UUID: "+t);const a=this.getFRData(t);if(!a)throw new Error("No data found for UUID: "+t);try{const o=l.smoothChannels(e),d=s.normalizeChannels(o),c={...a,channels:"target"===a.type?{...d.AVG&&{AVG:d.AVG}}:{...d.L&&{L:d.L},...d.R&&{R:d.R},...d.AVG&&{AVG:d.AVG}}};null!==n&&(c.identifier=n),null!==r&&(c.dispSuffix=r),void 0!==i&&(c.meta=i),this.frDataMap.set(t,c),u.drawFRCurve(t)}catch(t){console.error("Error updating EQ curve:",t)}}updateDisplayChannel(t,e,n){if(!["uuid","identifier"].includes(t))throw new Error("Wrong keyType was given");"uuid"!==t&&(e=this.getUUIDwithIdentifier(e));const r=this.getFRData(e);if(!r)throw new Error("No data found for UUID: "+e);if(Array.isArray(n))r.dispChannel=[...n];else{if("L"!==n&&"R"!==n&&"AVG"!==n)throw Error("Wrong Channel Data was given");r.dispChannel=[n]}this.frDataMap.set(e,r),this.coreEvent.dispatchEvent("fr-channel-updated",{uuid:e,type:r.type})}updateColors(t,e,n){if(!["uuid","identifier"].includes(t))throw new Error("Wrong keyType was given");"uuid"!==t&&(e=this.getUUIDwithIdentifier(e));const r=this.getFRData(e);if(!r)throw new Error("No data found for UUID: "+e);r.colors.L=n.L||"",r.colors.R=n.R||"",r.colors.AVG=n.AVG||"",this.frDataMap.set(e,r),this.coreEvent.dispatchEvent("fr-color-updated",{uuid:e})}updateDashPattern(t,e,n){if(!["uuid","identifier"].includes(t))throw new Error("Wrong keyType was given");"uuid"!==t&&(e=this.getUUIDwithIdentifier(e));const r=this.getFRData(e);if(!r)throw new Error("No data found for UUID: "+e);r.dash=n,this.frDataMap.set(e,r),this.coreEvent.dispatchEvent("fr-dash-updated",{uuid:e})}updateChannels(){const t=Array.from(this.frDataMap).filter((([t,e])=>"phone"===e.type)).length;if(t>1)this.frDataMap.forEach((t=>{if("phone"===t.type){if(Object.keys(t.channels).includes("AVG"))t.dispChannel=["AVG"];else{const e=Object.keys(t.channels)[0];t.dispChannel=[e]}this.frDataMap.set(t.uuid,t),this.coreEvent.dispatchEvent("fr-channel-updated",{uuid:t.uuid,type:t.type})}}));else if(1===t){const t=Array.from(this.frDataMap.values())[0];if("phone"===t.type){if(Object.keys(t.channels).includes("L")&&Object.keys(t.channels).includes("R"))t.dispChannel=["L","R"];else if(Object.keys(t.channels).includes("AVG"))t.dispChannel=["AVG"];else{const e=Object.keys(t.channels)[0];t.dispChannel=[e]}this.frDataMap.set(t.uuid,t),this.coreEvent.dispatchEvent("fr-channel-updated",{uuid:t.uuid,type:t.type})}}}_getChannelValue(t,e){const n=Array.from(this.frDataMap.values()).filter((t=>"phone"===t.type));return"phone"===t?n.length<1?e.filter((t=>"AVG"!==t)):e.includes("AVG")?["AVG"]:[`${e[0]}`]:["AVG"]}_getColorWithType(t){null===this.baseHue?this.baseHue=parseInt((360*Math.random()).toFixed(0)):this.baseHue=(this.baseHue+100)%360;const e=parseInt((50*Math.random()).toFixed(0)),n=parseInt((20*Math.random()).toFixed(0));return"target"===t?{AVG:`hsl(${this.baseHue}, 0%, 45%)`}:{L:`hsl(${(this.baseHue-10)%360}, ${50+e}%, ${30+n}%)`,R:`hsl(${(this.baseHue+10)%360}, ${50+e}%, ${30+n}%)`,AVG:`hsl(${this.baseHue}, ${50+e}%, ${30+n}%)`}}_getDashWithType(t,n=null){return"target"===t?null===n?this._getRandomDashForTarget():e.get("TRACE_STYLING.TARGET_TRACE_DASH")?.find((t=>(t.name.endsWith(" Target")?t.name:t.name+" Target")===n))?.dash||this._getRandomDashForTarget():"1 0"}_getRandomDashForTarget(){const t=1+Math.floor(3*Math.random()),e=[],n=5+Math.floor(3*Math.random());for(let r=0;r<t;r++)if(r%2==0){const t=5+Math.floor(5*Math.random());e.push(`${t} ${n}`)}else e.push(`2 ${n}`);return e.join(" ")}static getInstance(){return DataProvider._instance||(DataProvider._instance=new DataProvider),DataProvider._instance}}DataProvider._instance=null;var g=DataProvider.getInstance();class MenuState{constructor(){this.currentMenu=e.get("INITIAL_PANEL")||"phone",this.coreMenuList=[{id:"phone",name:"DEVICES"},{id:"graph",name:"GRAPH"},{id:"misc",name:"MISC"}],this.extensionMenuList=[]}init(e){this.coreEvent=e,document.querySelector(`.menu-panel[data-target="${this.currentMenu}-panel"]`)?.classList.add("active"),document.querySelector(`.menu-bar-item[data-target="${this.currentMenu}-panel"]`)?.classList.add("active"),window.addEventListener("core:menu-change",(t=>{this.currentMenu=t.detail.target.replace("-panel","")})),t.addObserver(this._updateLanguage.bind(this))}getMenuList(){return[...this.coreMenuList,...this.extensionMenuList]}getCoreMenuList(){return[...this.coreMenuList]}getCurrentIndex(){return this.getMenuList().findIndex((t=>t.id===this.currentMenu))}addExtensionMenu(e,n,r){const a=e.trim();this.extensionMenuList.push({id:a,name:n});const s=document.createElement("div");s.id=`${a}-panel`,s.className="menu-panel extension-panel",s.setAttribute("data-target",`${a}-panel`);let o=null,l=0;(async()=>{for(;l<3;){if(o=i.getExtension(e),o)return void s.appendChild(o);l++,l<3&&await new Promise((t=>setTimeout(t,100)))}console.warn(`modernGraphTool: Extension instance for '${a}' not found. This shouldn't happen but creating new one anyway.`),s.innerHTML=`<${r}></${r}>`})(),document.querySelector(".menu-panels")?.insertBefore(s,document.querySelector("misc-panel"));const d=document.createElement("button");d.className="menu-bar-item",d.setAttribute("type","button"),d.setAttribute("data-target",`${a}-panel`),d.innerHTML=t.getString(`extension.${e}.menu-label`,e.toUpperCase())||n.trim()||"?",document.querySelector(".menu-carousel")?.insertBefore(d,document.querySelector('.menu-bar-item[data-target="misc-panel"]')),this.coreEvent.dispatchEvent("extension-menu-added")}_updateLanguage(){this._updateCoreLanguage(),this._updateExtensionLanguage()}_updateCoreLanguage(){this.coreMenuList&&this.coreMenuList.forEach(((e,n)=>{const r=document.querySelector(`.menu-bar-item[data-target="${e.id}-panel"]`);r&&(r.textContent=t.getString(`menu.item-${e.id}-label`,e.name.toUpperCase()))}))}_updateExtensionLanguage(){this.extensionMenuList&&this.extensionMenuList.forEach(((e,n)=>{const r=document.querySelector(`.menu-bar-item[data-target="${e.id}-panel"]`);r&&(r.textContent=t.getString(`extension.${e.id}.menu-label`,e.name.toUpperCase()))}))}static getInstance(){return MenuState._instance||(MenuState._instance=new MenuState),MenuState._instance}}MenuState._instance=null;var m=MenuState.getInstance();const f={charset:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",encode(t){const e=(new TextEncoder).encode(t);let n=BigInt(0);for(let t=0;t<e.length;t++)n=n*BigInt(256)+BigInt(e[t]);let r="";for(;n>0;)r=this.charset[Number(n%BigInt(62))]+r,n/=BigInt(62);return r||"0"},decode(t){let e=BigInt(0);for(let n=0;n<t.length;n++)e=e*BigInt(62)+BigInt(this.charset.indexOf(t[n]));const n=[];for(;e>0;)n.unshift(Number(e%BigInt(256))),e/=BigInt(256);return(new TextDecoder).decode(new Uint8Array(n))}};var v=new class{constructor(){this.baseTitle=document.querySelector("title")?.textContent||"modernGraphTool",this.baseDescription=document.querySelector('meta[name="description"]')?.getAttribute("content")||"View and compare frequency response graphs",this.baseURL=window.location.href.split("?")[0],this.autoUpdateURL=e.get("URL.AUTO_UPDATE_URL")||!0,this.useBase62=e.get("URL.COMPRESS_URL")||!1,this.currentURL="",this.phoneDataFromURL=[],this._handlePhoneChange=this._handlePhoneChange.bind(this)}init(t){this.coreEvent=t,this._setupEventListeners(),this._loadFromURL()}_setupEventListeners(){window.addEventListener("core:fr-phone-added",this._handlePhoneChange),window.addEventListener("core:fr-phone-removed",this._handlePhoneChange),window.addEventListener("core:fr-target-added",this._handlePhoneChange),window.addEventListener("core:fr-target-removed",this._handlePhoneChange),window.addEventListener("core:fr-variant-updated",this._handlePhoneChange),window.addEventListener("core:fr-visibility-updated",this._handlePhoneChange)}_handlePhoneChange(){this.updateURL(this.autoUpdateURL)}async _loadFromURL(){const t=new URLSearchParams(window.location.search).get("share");if(t)if(t.startsWith("b62_")){const e=t.replace("b62_","");this.phoneDataFromURL=this._smartSplit(f.decode(e))}else{const e=decodeURI(t).replace(/_/g," ");this.phoneDataFromURL=this._smartSplit(e)}this.coreEvent&&this.coreEvent.dispatchInitEvent("url-loaded")}_smartSplit(t){const e=[];let n="",r=0;for(let i=0;i<t.length;i++){const a=t[i];"("===a||"["===a||"{"===a?(r++,n+=a):")"===a||"]"===a||"}"===a?(r--,n+=a):","===a&&0===r?(n.trim()&&e.push(n.trim()),n=""):n+=a}return n.trim()&&e.push(n.trim()),e}updateURL(t=!0){const e=Array.from(g.frDataMap).map((([t,e])=>(e.identifier+" "+e.dispSuffix).trim())).filter((t=>t));let n=this.baseTitle,r=this.baseURL;const i=e.join(", ");if(e.length){if(this.useBase62){r+=`?share=b62_${f.encode(e.join(","))}`}else r+=`?share=${encodeURI(e.join(",").replace(/ /g," "))}`;n=n+" - "+i}t&&(window.history.replaceState("",n,r),this.currentURL=r),document.title=n,this._updateMetaTags(i)}_updateMetaTags(t){const e=document.querySelector("link[rel='canonical']");e&&e.setAttribute("href",t?window.location.href:this.baseURL);const n=document.querySelector("meta[name='description']");n&&t&&n.setAttribute("content",`View and compare frequency response graph of ${t}.`)}toggleBase62(t){this.useBase62=t,this.updateURL()}getPhoneDataFromURL(){return this.phoneDataFromURL}getCurrentURL(){return this.currentURL}};const b={VERSION:"1.0.0",API_LEVEL:1,CoreEvent:n,CoreExtension:i,DataProvider:g,MenuState:m,RenderEngine:u,MetadataParser:p,StringLoader:t,FRParser:a,FRNormalizer:s,FRSmoother:l,URLProvider:v,GtToast:GtToast};var y=Object.freeze({__proto__:null,CoreEvent:n,CoreExtension:i,DataProvider:g,FRNormalizer:s,FRParser:a,FRSmoother:l,GtToast:GtToast,MenuState:m,MetadataParser:p,RenderEngine:u,StringLoader:t,URLProvider:v,default:b});const w=new CSSStyleSheet;w.replaceSync('/* Core styles */\nhtml {\n  min-width: 340px;\n  width: 100lvw;\n  height: 100lvh;\n\n  -webkit-user-select: none;\n  user-select: none;\n}\n\nbody {\n  margin: 0;\n  width: 100%;\n  height: 100%;\n  padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);\n  box-sizing: border-box;\n  \n  position: fixed;\n  overflow: hidden;\n  touch-action: none;\n  overscroll-behavior-y: none;\n\n  font-family: \'Interop\', sans-serif;\n  font: var(--gt-typescale-body-medium);\n  color: var(--gt-color-on-surface);\n  background: var(--gt-color-surface-container);\n\n  h1 { font: var(--gt-typescale-title-large); }\n  h2 { font: var(--gt-typescale-title-medium); }\n  h3 { font: var(--gt-typescale-title-small); }\n  input { font: var(--gt-typescale-body-medium); }\n\n  -webkit-tap-highlight-color: transparent;\n}\n\n* {\n  transition: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1),\n              color 0s cubic-bezier(0.4, 0, 0.2, 1),\n              border-color 0.2s cubic-bezier(0.4, 0, 0.2, 1),\n              fill 0.2s cubic-bezier(0.4, 0, 0.2, 1),\n              stroke 0.2s cubic-bezier(0.4, 0, 0.2, 1),\n              box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\nselect {\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  appearance: none;\n  border-radius: 0.5rem;\n  border: 1px solid var(--gt-color-outline);\n  padding-left: 0.6rem;\n  font: var(--gt-typescale-body-medium);\n  color: var(--gt-color-on-surface);\n  background-repeat: no-repeat;\n  background-position: right center;\n  background-color: var(--gt-color-surface-container-lowest);\n  background-image: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23666"><path d="M12 15.0006L7.75732 10.758L9.17154 9.34375L12 12.1722L14.8284 9.34375L16.2426 10.758L12 15.0006Z"></path></svg>\');\n  outline: none;\n  cursor: pointer;\n}\n\ninput[type="checkbox"] {\n  border: 0.1rem solid var(--gt-color-outline);\n  width: 0.8rem;\n  height: 0.8rem;\n  accent-color: var(--gt-color-primary);\n}\n\nbutton {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: none;\n  background: none;\n  color: var(--gt-color-on-surface);\n  cursor: pointer;\n}\n@media (hover: hover) and (pointer: fine) {\n  button:hover {\n    background: var(--gt-shadow);\n  }\n}\nbutton:active {\n  background: var(--gt-shadow);\n  transition: background 0s;\n}\n\ndiv::-webkit-scrollbar {\n  width: 0.5rem;\n  height: 0.5rem;\n}\ndiv::-webkit-scrollbar-thumb {\n  border-radius: 0.5rem;\n  background-color: rgba(0,0,0,0.2);\n}\n\n@layer aria-busy {\n  *[aria-busy="true"] {\n    pointer-events: none;\n    position: relative;\n    filter: blur(1px);\n    opacity: 0.8 !important;\n    transition: filter 0.5s ease-out;\n  }\n    \n  *[aria-busy="true"]::after {\n    content: \'\';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    animation: shimmer 1.5s infinite;\n    background: linear-gradient(\n      to right,\n      transparent 0%,\n      rgba(0,0,0,0.5) 50%,\n      transparent 100%\n    );\n    opacity: 0.7;\n    transition: opacity 0.3s ease-out;\n  }\n\n  /* Explicitly remove ::after when aria-busy is false/removed */\n  *[aria-busy="false"]::after {\n    content: none;\n    opacity: 0;\n  }\n\n  @keyframes shimmer {\n    0% {\n      transform: translateX(-100%);\n      opacity: 0.4;\n    }\n    50% {\n      opacity: 0.7;\n    }\n    100% {\n      transform: translateX(100%);\n      opacity: 0.4;\n    }\n  }\n}');const L=new CSSStyleSheet;L.replaceSync("@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Light.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Light.woff')\n      format('woff');\n  font-weight: 300;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-ExtraBold.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-ExtraBold.woff')\n      format('woff');\n  font-weight: 800;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Bold.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Bold.woff')\n      format('woff');\n  font-weight: bold;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-ExtraLight.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-ExtraLight.woff')\n      format('woff');\n  font-weight: 200;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Medium.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Medium.woff')\n      format('woff');\n  font-weight: 500;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Regular.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Regular.woff')\n      format('woff');\n  font-weight: normal;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-SemiBold.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-SemiBold.woff')\n      format('woff');\n  font-weight: 600;\n  font-style: normal;\n  font-display: block;\n}\n\n@font-face {\n  font-family: 'Interop';\n  src: url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Thin.woff2')\n      format('woff2'),\n    url('https://raw.githubusercontent.com/jhaemin/Interop/main/web/fonts/Interop-Thin.woff')\n      format('woff');\n  font-weight: 100;\n  font-style: normal;\n  font-display: block;\n}"),globalThis.CoreAPI=b;class CoreUI extends HTMLElement{constructor(){super(),Promise.resolve().then((function(){return E})),this.innerHTML='\n      <top-nav-bar></top-nav-bar>\n      <section class="main-content">\n        <section class="main-graph">\n          <graph-container></graph-container>\n          <div class="main-graph-list">\n            \x3c!-- selection-list should be positioned here --\x3e\n          </div>\n        </section>\n        <drag-divider></drag-divider>\n        <section class="main-menu">\n          <menu-container></menu-container>\n          <menu-carousel></menu-carousel>\n        </section>\n      </section>\n      <tutorial-modal></tutorial-modal>\n      <gt-toast></gt-toast>\n\n      \x3c!-- Styles --\x3e\n      <style>\n        core-ui {\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n        }\n          \n        .main-content {\n          flex: 1;\n          display: grid;\n          grid-template-columns: 65% 5px;\n          position: relative;\n          height: 0;\n        }\n\n        .main-menu {\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          grid-column: 3;\n        }\n\n        .main-graph {\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          grid-column: 1;\n          background: var(--gt-color-surface-container-lowest);\n        }\n\n        :root[data-mobile] {\n          .main-content {\n            display: flex;\n            flex-direction: column;\n          }\n          .main-divider, .main-graph-list {\n            display: none;\n          }\n          .main-menu {\n            flex: 1;\n            background: var(--gt-color-surface);\n            border-radius: 0.5rem 0.5rem 0 0;\n            border-top: 1px solid var(--gt-color-outline);\n          }\n        }\n\n        :root:not([data-mobile]) {\n          .main-menu {\n            min-width: 340px;\n          }\n          .main-graph-list {\n            flex: 1;\n            overflow-y: scroll;\n            padding: 1rem 0.5rem 1rem 1rem;\n            background: var(--gt-color-surface);\n            border-radius: 0.5rem 0.5rem 0 0;\n            border-top: 1px solid var(--gt-color-outline);\n          }\n        }\n      </style>\n    ',document.adoptedStyleSheets=[w,L]}connectedCallback(){n.init(y),this._disableIOSTextFieldZoom(),this.addEventListener("drag-divider-moved",this._handleDividerMove)}disconnectedCallback(){this.removeEventListener("drag-divider-moved",this._handleDividerMove)}_handleDividerMove=t=>{const e=this.querySelector(".main-content"),{width:n,x:r}=e.getBoundingClientRect(),i=(t.detail.currentX-r)/n*100;e.style.gridTemplateColumns=`\n      clamp(400px, ${i}%, calc(100% - 346px))\n      5px \n      minmax(340px, 1fr)\n    `};_disableIOSTextFieldZoom=()=>{if(!this._isIOS())return;const t=document.querySelector("meta[name=viewport]");if(null!==t){let e=t.getAttribute("content"),n=/maximum\-scale=[0-9\.]+/g;e=n.test(e)?e.replace(n,"maximum-scale=1.0"):[e,"maximum-scale=1.0"].join(", "),t.setAttribute("content",e)}};_isIOS=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}customElements.define("core-ui",CoreUI),Promise.resolve().then((function(){return x})),Promise.resolve().then((function(){return _})),Promise.resolve().then((function(){return T})),Promise.resolve().then((function(){return C})),Promise.resolve().then((function(){return I})),Promise.resolve().then((function(){return r})),Promise.resolve().then((function(){return A})),Promise.resolve().then((function(){return M})),Promise.resolve().then((function(){return k})),Promise.resolve().then((function(){return R})),Promise.resolve().then((function(){return D})),Promise.resolve().then((function(){return H})),Promise.resolve().then((function(){return N})),Promise.resolve().then((function(){return O})),Promise.resolve().then((function(){return P})),Promise.resolve().then((function(){return G})),Promise.resolve().then((function(){return $})),Promise.resolve().then((function(){return V})),Promise.resolve().then((function(){return B})),Promise.resolve().then((function(){return F})),Promise.resolve().then((function(){return z})),Promise.resolve().then((function(){return U}));var E=Object.freeze({__proto__:null});class PhonePanel extends HTMLElement{constructor(){super(),this.innerHTML='\n    \x3c!-- Phone panel --\x3e\n    <div class="menu-panel" id="phone-panel" data-target="phone-panel">\n      <phone-selector></phone-selector>\n    </div>\n    <style>\n      #phone-panel {\n        padding: 1rem 0 0 0;\n        overflow-y: hidden;\n        scrollbar-gutter: auto;\n      }\n    </style>\n    '}}customElements.define("phone-panel",PhonePanel);var x=Object.freeze({__proto__:null});class GraphPanel extends HTMLElement{constructor(){super(),this.innerHTML='\n    \x3c!-- Graph panel --\x3e\n    <div class="menu-panel" id="graph-panel" data-target="graph-panel">\n      <target-selector style="margin-bottom: 1rem;"></target-selector>\n      <selection-list></selection-list>\n    </div>\n    ',this.graphButtonContainer=document.createElement("div"),this.graphButtonContainer.className="graph-button-container",this.graphButtonContainer.innerHTML="\n      <style>\n        .graph-button-container {\n          display: flex;\n          flex-wrap: wrap;\n          flex-direction: row;\n          align-items: center;\n          justify-content: center;\n          gap: 0.75rem;\n          margin-bottom: 1rem;\n\n          h3 {\n            margin: 0;\n            color: var(--gt-color-on-surface);\n          }\n        }\n      </style>\n      <normalizer-input></normalizer-input>\n      <smoothing-button></smoothing-button>\n      <graph-scale-button></graph-scale-button>\n      <inspection-toggle></inspection-toggle>\n      <graph-screenshot-button></graph-screenshot-button>\n      <share-button></share-button>\n    ",this._updateUI(),window.addEventListener("core:ui-mode-change",this._updateUI.bind(this))}_updateUI(t=null){if(this.isMobile=t?t.detail.isMobile:window.innerWidth<1e3,this.graphButtonContainer.parentNode&&this.graphButtonContainer.parentNode.removeChild(this.graphButtonContainer),this.isMobile){const t=document.querySelector("#graph-panel");t&&!t.querySelector(".graph-button-container")&&t.appendChild(this.graphButtonContainer)}else{const t=document.querySelector(".main-graph-list");t&&!t.querySelector(".graph-button-container")&&t.appendChild(this.graphButtonContainer)}}}customElements.define("graph-panel",GraphPanel);var _=Object.freeze({__proto__:null});const S={iconPath:{delete:'<path d="M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 11H11V17H9V11ZM13 11H15V17H13V11ZM9 4V6H15V4H9Z"></path>',eyeOn:'<path d="M12.0003 3C17.3924 3 21.8784 6.87976 22.8189 12C21.8784 17.1202 17.3924 21 12.0003 21C6.60812 21 2.12215 17.1202 1.18164 12C2.12215 6.87976 6.60812 3 12.0003 3ZM12.0003 19C16.2359 19 19.8603 16.052 20.7777 12C19.8603 7.94803 16.2359 5 12.0003 5C7.7646 5 4.14022 7.94803 3.22278 12C4.14022 16.052 7.7646 19 12.0003 19ZM12.0003 16.5C9.51498 16.5 7.50026 14.4853 7.50026 12C7.50026 9.51472 9.51498 7.5 12.0003 7.5C14.4855 7.5 16.5003 9.51472 16.5003 12C16.5003 14.4853 14.4855 16.5 12.0003 16.5ZM12.0003 14.5C13.381 14.5 14.5003 13.3807 14.5003 12C14.5003 10.6193 13.381 9.5 12.0003 9.5C10.6196 9.5 9.50026 10.6193 9.50026 12C9.50026 13.3807 10.6196 14.5 12.0003 14.5Z"></path>',eyeOff:'<path d="M17.8827 19.2968C16.1814 20.3755 14.1638 21.0002 12.0003 21.0002C6.60812 21.0002 2.12215 17.1204 1.18164 12.0002C1.61832 9.62282 2.81932 7.5129 4.52047 5.93457L1.39366 2.80777L2.80788 1.39355L22.6069 21.1925L21.1927 22.6068L17.8827 19.2968ZM5.9356 7.3497C4.60673 8.56015 3.6378 10.1672 3.22278 12.0002C4.14022 16.0521 7.7646 19.0002 12.0003 19.0002C13.5997 19.0002 15.112 18.5798 16.4243 17.8384L14.396 15.8101C13.7023 16.2472 12.8808 16.5002 12.0003 16.5002C9.51498 16.5002 7.50026 14.4854 7.50026 12.0002C7.50026 11.1196 7.75317 10.2981 8.19031 9.60442L5.9356 7.3497ZM12.9139 14.328L9.67246 11.0866C9.5613 11.3696 9.50026 11.6777 9.50026 12.0002C9.50026 13.3809 10.6196 14.5002 12.0003 14.5002C12.3227 14.5002 12.6309 14.4391 12.9139 14.328ZM20.8068 16.5925L19.376 15.1617C20.0319 14.2268 20.5154 13.1586 20.7777 12.0002C19.8603 7.94818 16.2359 5.00016 12.0003 5.00016C11.1544 5.00016 10.3329 5.11773 9.55249 5.33818L7.97446 3.76015C9.22127 3.26959 10.5793 3.00016 12.0003 3.00016C17.3924 3.00016 21.8784 6.87992 22.8189 12.0002C22.5067 13.6998 21.8038 15.2628 20.8068 16.5925ZM11.7229 7.50857C11.8146 7.50299 11.9071 7.50016 12.0003 7.50016C14.4855 7.50016 16.5003 9.51488 16.5003 12.0002C16.5003 12.0933 16.4974 12.1858 16.4919 12.2775L11.7229 7.50857Z"></path>',arrowDown:'<path d="M13.0001 16.1716L18.3641 10.8076L19.7783 12.2218L12.0001 20L4.22192 12.2218L5.63614 10.8076L11.0001 16.1716V4H13.0001V16.1716Z"></path>',arrowUp:'<path d="M13.0001 7.82843V20H11.0001V7.82843L5.63614 13.1924L4.22192 11.7782L12.0001 4L19.7783 11.7782L18.3641 13.1924L13.0001 7.82843Z"></path>',shortArrowDown:'<path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path>',shortArrowUp:'<path d="M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"></path>',starFill:'<path d="M12.0006 18.26L4.94715 22.2082L6.52248 14.2799L0.587891 8.7918L8.61493 7.84006L12.0006 0.5L15.3862 7.84006L23.4132 8.7918L17.4787 14.2799L19.054 22.2082L12.0006 18.26Z"></path>',starLine:'<path d="M12.0006 18.26L4.94715 22.2082L6.52248 14.2799L0.587891 8.7918L8.61493 7.84006L12.0006 0.5L15.3862 7.84006L23.4132 8.7918L17.4787 14.2799L19.054 22.2082L12.0006 18.26ZM12.0006 15.968L16.2473 18.3451L15.2988 13.5717L18.8719 10.2674L14.039 9.69434L12.0006 5.27502L9.96214 9.69434L5.12921 10.2674L8.70231 13.5717L7.75383 18.3451L12.0006 15.968Z"></path>',starHalf:'<path d="M12.0006 15.968L16.2473 18.3451L15.2988 13.5717L18.8719 10.2674L14.039 9.69434L12.0006 5.27502V15.968ZM12.0006 18.26L4.94715 22.2082L6.52248 14.2799L0.587891 8.7918L8.61493 7.84006L12.0006 0.5L15.3862 7.84006L23.4132 8.7918L17.4787 14.2799L19.054 22.2082L12.0006 18.26Z"></path>',externalLink:'<path d="M10 6V8H5V19H16V14H18V20C18 20.5523 17.5523 21 17 21H4C3.44772 21 3 20.5523 3 20V7C3 6.44772 3.44772 6 4 6H10ZM21 3V11H19L18.9999 6.413L11.2071 14.2071L9.79289 12.7929L17.5849 5H13V3H21Z"></path>',plus:'<path d="M11 11V5H13V11H19V13H13V19H11V13H5V11H11Z"></path>',subtract:'<path d="M5 11V13H19V11H5Z"></path>',sun:'<path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z"></path>',moon:'<path d="M11.3807 2.01886C9.91573 3.38768 9 5.3369 9 7.49999C9 11.6421 12.3579 15 16.5 15C18.6631 15 20.6123 14.0843 21.9811 12.6193C21.6613 17.8537 17.3149 22 12 22C6.47715 22 2 17.5228 2 12C2 6.68514 6.14629 2.33869 11.3807 2.01886Z"></path>',wave:'<path d="M22.768125 12.478124999999999c-2.15625 4.59375 -4.03125 6.6468750000000005 -6.076874999999999 6.6468750000000005 -2.59125 0 -4.106249999999999 -3.22875 -5.709375 -6.6468750000000005 -0.6693749999999999 -1.43625 -1.3696875 -2.9156250000000004 -2.083125 -3.9721874999999995C8.2865625 7.6021875 7.7371875 7.125 7.3125 7.125c-0.35812499999999997 0 -1.71 0.38625 -4.0396875 5.353125a1.125 1.125 0 0 1 -2.0371875 -0.9562499999999999c2.15625 -4.59375 4.03125 -6.6468750000000005 6.076874999999999 -6.6468750000000005 2.59125 0 4.106249999999999 3.22875 5.709375 6.6468750000000005 0.6740625 1.43625 1.3696875 2.9203124999999996 2.083125 3.9721874999999995 0.6121875 0.90375 1.1615625 1.3809375 1.59375 1.3809375 0.35812499999999997 0 1.71 -0.38625 4.0396875 -5.353125a1.125 1.125 0 0 1 2.0371875 0.9562499999999999Z"></path>',flatline:'<path d="M2 12C2 11.4477 2.44772 11 3 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H3C2.44772 13 2 12.5523 2 12Z"></path>',share:'<path d="M13.1202 17.0228L8.92129 14.7324C8.19135 15.5125 7.15261 16 6 16C3.79086 16 2 14.2091 2 12C2 9.79086 3.79086 8 6 8C7.15255 8 8.19125 8.48746 8.92118 9.26746L13.1202 6.97713C13.0417 6.66441 13 6.33707 13 6C13 3.79086 14.7909 2 17 2C19.2091 2 21 3.79086 21 6C21 8.20914 19.2091 10 17 10C15.8474 10 14.8087 9.51251 14.0787 8.73246L9.87977 11.0228C9.9583 11.3355 10 11.6629 10 12C10 12.3371 9.95831 12.6644 9.87981 12.9771L14.0788 15.2675C14.8087 14.4875 15.8474 14 17 14C19.2091 14 21 15.7909 21 18C21 20.2091 19.2091 22 17 22C14.7909 22 13 20.2091 13 18C13 17.6629 13.0417 17.3355 13.1202 17.0228ZM6 14C7.10457 14 8 13.1046 8 12C8 10.8954 7.10457 10 6 10C4.89543 10 4 10.8954 4 12C4 13.1046 4.89543 14 6 14ZM17 8C18.1046 8 19 7.10457 19 6C19 4.89543 18.1046 4 17 4C15.8954 4 15 4.89543 15 6C15 7.10457 15.8954 8 17 8ZM17 20C18.1046 20 19 19.1046 19 18C19 16.8954 18.1046 16 17 16C15.8954 16 15 16.8954 15 18C15 19.1046 15.8954 20 17 20Z"></path>',sortDesc:'<path d="M20 4V16H23L19 21L15 16H18V4H20ZM12 18V20H3V18H12ZM14 11V13H3V11H14ZM14 4V6H3V4H14Z"></path>',import:'<path d="M13 10H18L12 16L6 10H11V3H13V10ZM4 19H20V12H22V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V12H4V19Z"></path>',export:'<path d="M4 19H20V12H22V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V12H4V19ZM13 9V16H11V9H6L12 3L18 9H13Z"></path>',menu:'<path d="M3 4H21V6H3V4ZM9 11H21V13H9V11ZM3 18H21V20H3V18Z"></path>',screenshot:'<path d="M3 3H5V5H3V3ZM7 3H9V5H7V3ZM11 3H13V5H11V3ZM15 3H17V5H15V3ZM19 3H21V5H19V3ZM19 7H21V9H19V7ZM3 19H5V21H3V19ZM3 15H5V17H3V15ZM3 11H5V13H3V11ZM3 7H5V9H3V7ZM10.6667 11L11.7031 9.4453C11.8886 9.1671 12.2008 9 12.5352 9H15.4648C15.7992 9 16.1114 9.1671 16.2969 9.4453L17.3333 11H20C20.5523 11 21 11.4477 21 12V20C21 20.5523 20.5523 21 20 21H8C7.44772 21 7 20.5523 7 20V12C7 11.4477 7.44772 11 8 11H10.6667ZM14 18C15.1046 18 16 17.1046 16 16C16 14.8954 15.1046 14 14 14C12.8954 14 12 14.8954 12 16C12 17.1046 12.8954 18 14 18Z"></path>',globe:'<path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM9.71002 19.6674C8.74743 17.6259 8.15732 15.3742 8.02731 13H4.06189C4.458 16.1765 6.71639 18.7747 9.71002 19.6674ZM10.0307 13C10.1811 15.4388 10.8778 17.7297 12 19.752C13.1222 17.7297 13.8189 15.4388 13.9693 13H10.0307ZM19.9381 13H15.9727C15.8427 15.3742 15.2526 17.6259 14.29 19.6674C17.2836 18.7747 19.542 16.1765 19.9381 13ZM4.06189 11H8.02731C8.15732 8.62577 8.74743 6.37407 9.71002 4.33256C6.71639 5.22533 4.458 7.8235 4.06189 11ZM10.0307 11H13.9693C13.8189 8.56122 13.1222 6.27025 12 4.24799C10.8778 6.27025 10.1811 8.56122 10.0307 11ZM14.29 4.33256C15.2526 6.37407 15.8427 8.62577 15.9727 11H19.9381C19.542 7.8235 17.2836 5.22533 14.29 4.33256Z"></path>',close:'<path d="M11.9997 10.5865L16.9495 5.63672L18.3637 7.05093L13.4139 12.0007L18.3637 16.9504L16.9495 18.3646L11.9997 13.4149L7.04996 18.3646L5.63574 16.9504L10.5855 12.0007L5.63574 7.05093L7.04996 5.63672L11.9997 10.5865Z"></path>',github:'<path d="M12.001 2C6.47598 2 2.00098 6.475 2.00098 12C2.00098 16.425 4.86348 20.1625 8.83848 21.4875C9.33848 21.575 9.52598 21.275 9.52598 21.0125C9.52598 20.775 9.51348 19.9875 9.51348 19.15C7.00098 19.6125 6.35098 18.5375 6.15098 17.975C6.03848 17.6875 5.55098 16.8 5.12598 16.5625C4.77598 16.375 4.27598 15.9125 5.11348 15.9C5.90098 15.8875 6.46348 16.625 6.65098 16.925C7.55098 18.4375 8.98848 18.0125 9.56348 17.75C9.65098 17.1 9.91348 16.6625 10.201 16.4125C7.97598 16.1625 5.65098 15.3 5.65098 11.475C5.65098 10.3875 6.03848 9.4875 6.67598 8.7875C6.57598 8.5375 6.22598 7.5125 6.77598 6.1375C6.77598 6.1375 7.61348 5.875 9.52598 7.1625C10.326 6.9375 11.176 6.825 12.026 6.825C12.876 6.825 13.726 6.9375 14.526 7.1625C16.4385 5.8625 17.276 6.1375 17.276 6.1375C17.826 7.5125 17.476 8.5375 17.376 8.7875C18.0135 9.4875 18.401 10.375 18.401 11.475C18.401 15.3125 16.0635 16.1625 13.8385 16.4125C14.201 16.725 14.5135 17.325 14.5135 18.2625C14.5135 19.6 14.501 20.675 14.501 21.0125C14.501 21.275 14.6885 21.5875 15.1885 21.4875C19.259 20.1133 21.9999 16.2963 22.001 12C22.001 6.475 17.526 2 12.001 2Z"></path>',book:'<path d="M4 3C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21H14C14.5523 21 15 20.5523 15 20V10.6973L17.0215 20.2076C17.1363 20.7479 17.6673 21.0927 18.2075 20.9779L21.142 20.3541C21.6822 20.2393 22.027 19.7083 21.9122 19.1681L19.0015 5.47402C18.8866 4.9338 18.3556 4.58896 17.8154 4.70378L15 5.30221V5C15 4.44772 14.5523 4 14 4H9C9 3.44772 8.55228 3 8 3H4ZM9 6H13V14H9V6ZM13 16V19H9V16H13ZM7 17V19H5V17H7ZM18.7699 18.8137L18.3541 16.8577L19.3323 16.6498L19.748 18.6058L18.7699 18.8137Z"></path>',donation:'<path d="M9.3349 11.5022L11.5049 11.5027C13.9902 11.5027 16.0049 13.5174 16.0049 16.0027L9.00388 16.0018L9.00488 17.0027L17.0049 17.0019V16.0027C17.0049 14.9202 16.6867 13.8996 16.1188 13.0019L19.0049 13.0027C20.9972 13.0027 22.7173 14.1679 23.521 15.8541C21.1562 18.9747 17.3268 21.0027 13.0049 21.0027C10.2436 21.0027 7.90437 20.4121 6.00447 19.3779L6.00592 10.0737C7.25147 10.2521 8.39122 10.7583 9.3349 11.5022ZM4.00488 9.00268C4.51772 9.00268 4.94039 9.38872 4.99816 9.88606L5.00488 10.0018V19.0027C5.00488 19.555 4.55717 20.0027 4.00488 20.0027H2.00488C1.4526 20.0027 1.00488 19.555 1.00488 19.0027V10.0027C1.00488 9.45039 1.4526 9.00268 2.00488 9.00268H4.00488ZM13.6513 3.57806L14.0046 3.93183L14.3584 3.57806C15.3347 2.60175 16.9177 2.60175 17.894 3.57806C18.8703 4.55437 18.8703 6.13728 17.894 7.11359L14.0049 11.0027L10.1158 7.11359C9.13948 6.13728 9.13948 4.55437 10.1158 3.57806C11.0921 2.60175 12.675 2.60175 13.6513 3.57806Z"></path>'},Icon(t,e=""){return`\n    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"\n      style="${""!==e?e:"width: 1rem; height: 1rem;"}"\n    >\n      ${this.iconPath[t]}\n    </svg>\n    `}};class MiscPanel extends HTMLElement{constructor(){super();const n=e.get("LANGUAGE.ENABLE_I18N"),r=e.get("INTERFACE.HIDE_DEV_DONATE_BUTTON")||!1;this.innerHTML=`\n    <div class="menu-panel" id="misc-panel" data-target="misc-panel">\n      <div class="misc-row">\n        <gt-button class="dark-mode-toggle" title="Toggle dark mode">\n          ${"dark"===document.documentElement.getAttribute("data-theme")?S.Icon("moon","width: 1.25rem; height: 1.25rem"):S.Icon("sun","width: 1.25rem; height: 1.25rem")}\n        </gt-button>\n        ${n?`<gt-divider></gt-divider>\n            ${S.Icon("globe","width: 1.5rem; height: 1.5rem")}\n            <language-selector></language-selector>`:""}\n      </div>\n      <div class="misc-description" id="db-description">\n      </div>\n      <gt-divider horizontal style="margin: 1rem 0 0.8rem 0;"></gt-divider>\n      <div class="misc-info">\n        <div class="misc-info-title">\n          <h2>modernGraphTool</h2>\n          <h4>beta</h4>\n        </div>\n        <p style="margin-bottom: 0.2rem;">\n          Open-source project under the MIT license\n        </p>\n        <div class="misc-info-button-row">\n          <button name="github-button" title="Go to Github Repository"\n            onclick="window.open('https://github.com/potatosalad775/modernGraphTool', '_blank')"\n          >\n            ${S.Icon("github","width: 1.5rem; height: 1.5rem")}\n          </button>\n          <button name="github-button" title="Go to Documentation page"\n            onclick="window.open('https://potatosalad775.github.io/modernGraphTool/docs', '_blank')"\n          >\n            ${S.Icon("book","width: 1.5rem; height: 1.5rem")}\n          </button>\n          ${r?"":`\n            <button name="github-button" title="Go to Donation page"\n              onclick="window.open('https://ko-fi.com/potatosalad775', '_blank')"\n            >\n              ${S.Icon("donation","width: 1.5rem; height: 1.5rem")}\n            </button>`}\n        </div>\n      </div>\n    </div>\n\n    <style>\n      .misc-row {\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        gap: 0.5rem;\n      }\n      .misc-info {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        gap: 0.3rem;\n        margin: 0;\n        h4, p {\n            margin: 0;\n        }\n      }\n      .misc-info-title {\n        display: flex;\n        align-items: baseline;\n        gap: 0.5rem;\n        h2, h4 {\n          margin: 0;\n        }\n      }\n      .misc-info-button-row {\n        display: flex;\n        gap: 0.25rem;\n        button {\n          padding: 0.25rem;\n          border-radius: 0.5rem;\n        }\n      }\n      .misc-description {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        gap: 0.5rem;\n        margin: 0.5rem 0 0 0;\n        h1, h2, h3, h4, h5, h6, p {\n          margin: 0;\n        }\n        div {\n          text-align: center;\n        }\n      }\n    </style>\n    `,this.appendDescription(),this.attachDarkModeToggleListener(),t.addObserver(this.updateLanguage.bind(this))}attachDarkModeToggleListener(){const t=this.querySelector(".dark-mode-toggle");t&&t.addEventListener("click",(t=>{const e="dark"===document.documentElement.getAttribute("data-theme");t.target.innerHTML=e?S.Icon("sun","width: 1.25rem; height: 1.25rem"):S.Icon("moon","width: 1.25rem; height: 1.25rem"),document.documentElement.setAttribute("data-theme",e?"light":"dark")}))}appendDescription(){const t=e.get("DESCRIPTION");if(t&&0!==t.length){if(t.length>0){const t=document.createElement("span");t.style.width="100%",t.innerHTML='<gt-divider horizontal style="margin: 0.5rem 0;"></gt-divider>',this.querySelector(".misc-description").appendChild(t)}t.forEach(((t,e)=>{if("text"===t.TYPE.toLowerCase()){const n=document.createElement("p");n.textContent=t.CONTENT,n.setAttribute("desc-index",e),this.querySelector(".misc-description").appendChild(n)}else if("image"===t.TYPE.toLowerCase()){const n=document.createElement("img");n.src=t.CONTENT,n.setAttribute("desc-index",e),this.querySelector(".misc-description").appendChild(n)}else if("html"===t.TYPE.toLowerCase()){const n=document.createElement("div");n.innerHTML=t.CONTENT,n.setAttribute("desc-index",e),this.querySelector(".misc-description").appendChild(n)}else console.error(`Unknown misc panel description type: ${t.TYPE}`)}))}}updateLanguage(){const t=e.get("DESCRIPTION"),n=this.querySelector(".misc-description");t.forEach(((t,e)=>{const r=n.querySelector(`[desc-index="${e}"]`);r&&("text"===t.TYPE.toLowerCase()?r.textContent=t.CONTENT:"image"===t.TYPE.toLowerCase()?r.src=t.CONTENT:"html"===t.TYPE.toLowerCase()&&(r.innerHTML=t.CONTENT))}))}}customElements.define("misc-panel",MiscPanel);var T=Object.freeze({__proto__:null});class GTButton extends HTMLElement{static get observedAttributes(){return["variant","disabled","toggleable"]}constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this._render()}_render(){this.shadow.innerHTML="",this.toggleable=null!==this.getAttribute("toggleable");const t=document.createElement(this.toggleable?"label":"button");if(t.classList.add("button"),this.toggleable){const e=document.createElement("input");e.type="checkbox",t.appendChild(e),t.classList.add("toggleable"),this.checkbox=e}const e=this.getAttribute("variant")||"filled";t.classList.add(e),this.hasAttribute("disabled")&&t.classList.add("disabled");const n=document.createElement("slot");t.appendChild(n);const r=document.createElement("style");r.textContent="\n  :host {\n    display: inline-flex;\n    border-radius: 2.5rem;\n  }\n\n  .button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0.5rem 1rem;\n    border-radius: 2.5rem;\n    cursor: pointer;\n    font-family: inherit;\n    font-size: 0.8rem;\n    font-weight: 500;\n    transition: all 0.2s ease;\n    width: 100%;\n    height: 100%;\n    gap: 0.5rem;\n\n    svg {\n      width: 1rem;\n      height: 1rem;\n    }\n  }\n\n  .button.disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    pointer-events: none;\n  }\n\n  .checkbox {\n    display: none;\n  }\n\n  .filled {\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    border: none;\n  }\n\n  .filled-tonal {\n    background: var(--gt-color-secondary-container);\n    color: var(--gt-color-on-secondary-container);\n    border: none;\n  }\n\n  .filled-tertiary {\n    background: var(--gt-color-tertiary-container);\n    color: var(--gt-color-on-tertiary-container);\n    border: none;\n  }\n\n  .outlined {\n    background: transparent;\n    border: 1px solid var(--gt-color-outline);\n    color: var(--gt-color-primary);\n  }\n\n  /* Style for Toggle Button */\n  .toggleable input {\n    display: none;\n  }\n\n  .toggleable.filled:has(input:checked) {\n    background: var(--gt-color-primary-container);\n    color: var(--gt-color-on-primary-container);\n  }\n\n  .toggleable.filled-tonal:has(input:checked) {\n    background: var(--gt-color-secondary);\n    color: var(--gt-color-on-secondary);\n  }\n\n  .toggleable.filled-tertiary:has(input:checked) {\n    background: var(--gt-color-tertiary);\n    color: var(--gt-color-on-tertiary);\n  }\n\n  .toggleable.outlined:has(input:checked) {\n    border: 1px solid var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    background: var(--gt-color-primary);\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .filled:hover {\n      filter: var(--gt-hover-filter);\n    }\n    .filled-tonal:hover {\n      filter: var(--gt-hover-filter);\n    }\n    .filled-tertiary:hover {\n      filter: var(--gt-hover-filter);\n    }\n    .outlined:hover {\n      background: var(--gt-shadow);\n    }\n  }\n\n  /* Touch feedback styles */\n  .filled:active {\n    filter: var(--gt-hover-filter);\n    transition: filter 0s;\n  }\n  .filled-tonal:active {\n    filter: var(--gt-hover-filter);\n    transition: filter 0s;\n  }\n  .filled-tertiary:active {\n    filter: var(--gt-hover-filter);\n    transition: filter 0s;\n  }\n  .outlined:active {\n    background: var(--gt-shadow);\n    transition: background 0s;\n  }\n",this.shadow.appendChild(t),this.shadow.appendChild(r)}attributeChangedCallback(t,e,n){e!==n&&this._render()}toggle(t,e=!1){this.toggleable&&(this.checkbox.checked=t,e||this.checkbox.dispatchEvent(new Event("change",{bubbles:!0})))}connectedCallback(){this.toggleable&&this.checkbox.addEventListener("change",(t=>{this.dispatchEvent(new CustomEvent("gt-button-toggle",{detail:{checked:t.target.checked},bubbles:!0}))}))}}customElements.define("gt-button",GTButton);var C=Object.freeze({__proto__:null});class GTDivider extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"open"});this.color=this.getAttribute("color")||"var(--gt-color-outline)",this.width=this.getAttribute("width")||"1px",this.style=this.getAttribute("style")||"",this.isHorizontal=this.hasAttribute("horizontal"),t.className="gt-divider",t.innerHTML=`\n      <style>\n        :host {\n          display: block;\n          width: ${this.isHorizontal?"100%":this.width};\n          height: ${this.isHorizontal?"1px":"auto"};\n          background: ${this.color};\n          align-self: stretch;\n          ${this.style};\n        }\n      </style>\n    `}}customElements.define("gt-divider",GTDivider);var I=Object.freeze({__proto__:null});class GraphContainer extends HTMLElement{constructor(){super(),this.id="graph-container",this.innerHTML='\n      <svg id="fr-graph"></svg>\n    ';const t=document.createElement("style");t.textContent='\n#graph-container {\n  position: relative;\n  height: fit-content;\n}\n\n#fr-graph {\n  min-height: fit-content;\n  max-width: 100%;\n  aspect-ratio: 16/9;\n}\n\n.fr-graph-label {\n  display: flex;\n  flex-direction: column;\n}\n\n:root {\n  --watermark-text-filter: none;\n}\n:root[data-theme="dark"] {\n  --watermark-text-filter: invert(1.0);\n}\n',this.appendChild(t),n.dispatchInitEvent("graph-ui-ready")}}customElements.define("graph-container",GraphContainer);var A=Object.freeze({__proto__:null});class TopNavBar extends HTMLElement{constructor(){super(),this.isMobile=document.documentElement.hasAttribute("data-mobile")||window.innerWidth<1e3,this.linkList=e.get("TOPBAR.LINK_LIST")||[],this.render(),this.setupEventListeners()}connectedCallback(){window.addEventListener("core:ui-mode-change",this._handleScreenResize.bind(this)),t.addObserver(this._handleLanguageChange.bind(this))}disconnectedCallback(){window.removeEventListener("core:ui-mode-change",this._handleScreenResize.bind(this)),t.removeObserver(this._handleLanguageChange.bind(this))}render(){const n=e.get("TOPBAR.TITLE.TYPE")||"TEXT",r=e.get("TOPBAR.TITLE.CONTENT")||"modernGraphTool";this.innerHTML=`\n      <header class="header">\n        <nav class="top-nav-bar">\n          <div class="top-nav-bar-leading">\n            <a class="top-nav-bar-leading-title" href=".">\n              ${"HTML"===n?r:""}\n              ${"TEXT"===n?"<h2>"+r+"</h2>":""}\n              ${"IMAGE"===n?"<img src='"+r+"' alt='topbar title'/>":""}\n            </a>\n          </div>\n          \x3c!-- Trailing Button --\x3e\n          <button class="mobile-menu-button" style="display: ${this.isMobile?"block":"none"}">\n            ${S.Icon("menu","width: 1.5rem; height: 1.5rem;")}\n          </button>\n          <div class="mobile-sidebar" style="display: ${this.isMobile?"block":"none"}">\n            <div class="mobile-sidebar-overlay"></div>\n            <div class="mobile-sidebar-content">\n              <div class="mobile-sidebar-header">\n                <h2>${t.getString("top-nav-bar.sidebar-link-title","LINKS")}</h2>\n                <button class="mobile-sidebar-close">\n                  ${S.Icon("close","width: 1.5rem; height: 1.5rem;")}\n                </button>\n              </div>\n              ${this.linkList.map((t=>`\n                <a href="${t.URL}" target="_blank" rel="noopener">${t.TITLE}</a>\n              `)).join("")}\n            </div>\n          </div>\n          <div class="top-nav-bar-trailing" style="display: ${this.isMobile?"none":"flex"}">\n            ${this.linkList.map((t=>`\n              <a href="${t.URL}" target="_blank" rel="noopener">${t.TITLE}</a>\n            `)).join("")}\n          </div>\n        </nav>\n      </header>\n    `;const i=document.createElement("style");i.textContent="\n  .top-nav-bar {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    height: 2rem;\n    padding: 0.5rem 1rem;\n    background: var(--gt-color-surface-container);\n    border-bottom: 1px solid var(--gt-color-outline-variant);\n  }\n\n  .top-nav-bar-leading {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .top-nav-bar-leading-title {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n    text-decoration: none;\n    color: var(--gt-color-on-surface);\n  }\n\n  .top-nav-bar-leading h2 {\n    margin: 0;\n    font: var(--gt-typescale-title-medium);\n  }\n\n  .top-nav-bar-leading img {\n    height: 2rem;\n  }\n\n  .top-nav-bar-trailing {\n    display: flex;\n    gap: 0.25rem;\n    align-items: center;\n  }\n\n  .top-nav-bar-trailing a {\n    text-decoration: none;\n    color: var(--gt-color-on-surface-variant);\n    font-size: 0.9rem;\n    padding: 0.25rem 0.75rem;\n    border-radius: 0.5rem;\n  }\n\n  /* Mobile styles */\n  .mobile-menu-button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 2rem;\n    width: 2rem;\n    padding: 0;\n    border: none;\n    background: none;\n    cursor: pointer;\n    border-radius: 0.5rem;\n  }\n\n  .mobile-menu-button svg {\n    color: var(--gt-color-on-surface-variant);\n  }\n\n  .mobile-sidebar {\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 1000;\n    display: flex;\n    pointer-events: none;\n  }\n\n  .mobile-sidebar.visible {\n    pointer-events: auto;\n  }\n\n  .mobile-sidebar-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0, 0, 0, 0.4);\n    opacity: 0;\n    transition: opacity 0.3s ease;\n  }\n\n  .mobile-sidebar.visible .mobile-sidebar-overlay {\n    opacity: 1;\n  }\n\n  .mobile-sidebar-content {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    width: 70vw;\n    max-width: 20rem;\n    height: 100%;\n    background: var(--gt-color-surface);\n    transform: translateX(100%);\n    transition: transform 0.3s ease;\n    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);\n    box-sizing: border-box;\n    border-radius: 1rem 0 0 1rem;\n  }\n\n  .mobile-sidebar.visible .mobile-sidebar-content {\n    transform: translateX(0);\n  }\n\n  .mobile-sidebar-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin: 1.5rem;\n    margin-bottom: 0.75rem;\n\n    h2 {\n      margin: 0;\n    }\n  }\n\n  .mobile-sidebar-content a {\n    text-decoration: none;\n    color: var(--gt-color-on-surface-variant);\n    font: var(--gt-typescale-body-large);\n    padding: 0.5rem;\n    margin: 0.25rem 1rem;\n    border-radius: 0.5rem;\n  }\n\n  .mobile-sidebar-close {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 2rem;\n    height: 2rem;\n    border-radius: 0.5rem;\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .top-nav-bar-trailing a:hover {\n      color: var(--gt-color-primary);\n      background: var(--gt-color-surface-container);\n      filter: var(--gt-hover-filter);\n    }\n\n    .mobile-menu-button svg:hover {\n      color: var(--gt-color-on-surface);\n    }\n      \n    .mobile-sidebar-content a:hover {\n      background: var(--gt-color-surface-variant);\n      color: var(--gt-color-on-surface);\n    }\n  }\n",this.appendChild(i)}setupEventListeners(){const t=this.querySelector(".mobile-menu-button"),e=this.querySelector(".mobile-sidebar"),n=this.querySelector(".mobile-sidebar-overlay"),r=this.querySelector(".mobile-sidebar-close");t?.addEventListener("click",(()=>{e.classList.add("visible"),document.body.style.overflow="hidden"})),n?.addEventListener("click",(()=>{e.classList.remove("visible"),document.body.style.overflow=""})),r?.addEventListener("click",(()=>{e.classList.remove("visible"),document.body.style.overflow=""}))}_handleScreenResize(t=null){t&&this.isMobile!==t?.detail.isMobile&&(this.isMobile=t.detail.isMobile),this.isMobile?(this.querySelector(".top-nav-bar-trailing").style.display="none",this.querySelector(".mobile-menu-button").style.display="block",this.querySelector(".mobile-sidebar").style.display="block"):(this.querySelector(".top-nav-bar-trailing").style.display="flex",this.querySelector(".mobile-menu-button").style.display="none",this.querySelector(".mobile-sidebar").style.display="none")}_handleLanguageChange(){this.linkList=e.get("TOPBAR.LINK_LIST")||[];const n=this.querySelector(".top-nav-bar-trailing");n&&(n.innerHTML=this.linkList.map((t=>`\n        <a href="${t.URL}" target="_blank" rel="noopener">${t.TITLE}</a>\n      `)).join(""));const r=this.querySelector(".mobile-sidebar-content");if(r){const e=r.querySelector(".mobile-sidebar-header h2");e&&(e.textContent=t.getString("top-nav-bar.sidebar-link-title","LINKS")),r.querySelectorAll("a").forEach((t=>t.remove())),this.linkList.forEach((t=>{const e=document.createElement("a");e.href=t.URL,e.target="_blank",e.rel="noopener",e.textContent=t.TITLE,r.appendChild(e)}))}}}customElements.define("top-nav-bar",TopNavBar);var M=Object.freeze({__proto__:null});class MenuContainer extends HTMLElement{constructor(){super(),this.className="menu-container",this.innerHTML=`\n      <div class="menu-slider">\n        <div class="menu-panels">\n          ${m.getCoreMenuList().map((t=>`\n            <${t.id}-panel></${t.id}-panel>\n          `)).join("")}  \n        </div>\n      </div>\n      <style>\n        \n.menu-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  overflow: hidden;\n  background: var(--gt-color-surface);\n}\n\n.menu-slider {\n  flex: 1;\n  position: relative;\n  overflow-x: hidden;\n}\n\n.menu-panels {\n    position: relative;\n    height: 100%;\n    width: 100%;\n    box-sizing: border-box;\n}\n\n.menu-panel {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    overflow-x: hidden;\n    overflow-y: auto;\n    padding: 0.9rem 0.5rem 0 0.5rem;\n    opacity: 0;\n    transform: translateX(30%);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    pointer-events: none;\n    box-sizing: border-box;\n    scrollbar-gutter: stable both-edges;\n}\n\n.menu-panel.active {\n    opacity: 1;\n    transform: translateX(0);\n    pointer-events: all;\n    transition-delay: 0.1s;\n}\n\n.menu-panel:not(.active) {\n    transform: translateX(-30%);\n    transition-delay: 0s;\n}\n\n      </style>\n    `,this._addEventListener()}_addEventListener(){window.addEventListener("core:menu-switched",(t=>{this.querySelectorAll(".menu-panel").forEach((e=>{e.id===t.detail.target?e.classList.add("active"):e.classList.remove("active")}))}))}}customElements.define("menu-container",MenuContainer);var k=Object.freeze({__proto__:null});class MenuCarousel extends HTMLElement{constructor(){super(),this.currentIndex=m.getCurrentIndex(),this.isDragging=!1,this.startX=0,this.currentX=0,this.lastDragX=0,this.animationFrame=null,this.isSnapping=!1,this.snapDebounceTime=100,this.innerHTML=`\n      <nav class="menu-carousel-group">\n        <div class="menu-carousel">\n          ${m.getCoreMenuList().map((e=>`\n            <button type="button" class="menu-bar-item" data-target="${e.id}-panel">\n              ${t.getString(`menu.item-${e.id}-label`,e.name||"?")}\n            </button>\n          `)).join("")} \n        </div>\n      </nav>\n    `;const e=document.createElement("style");e.textContent="\n  .menu-carousel-group {\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: var(--gt-color-surface-container);\n    height: 4.5rem;\n    overflow: hidden;\n    touch-action: pan-x;\n  }\n\n  .menu-carousel {\n    position: absolute;\n    display: flex;\n    gap: 0.75rem;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    will-change: transform;\n    padding: 0 calc(50% - 3rem); /* Half of container minus half of item width */\n  }\n\n  .menu-bar-item {\n    min-width: 6rem;\n    height: 2.5rem;\n    margin: 1rem 0;\n    background: none;\n    border: none;\n    border-radius: 1.5rem;\n    cursor: pointer;\n    color: var(--gt-color-on-surface);\n    font: var(--gt-typescale-title-small);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    transform-origin: center;\n    opacity: 0.5;\n    scale: 0.8;\n    flex-shrink: 0;\n    -webkit-tap-highlight-color: transparent;\n  }\n\n  .menu-bar-item.active {\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    opacity: 1;\n    scale: 1;\n  }\n\n  .menu-bar-item.nearby {\n    opacity: 0.8;\n    scale: 0.9;\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .menu-bar-item:hover {\n      filter: var(--gt-hover-filter);\n    }\n  }\n",this.appendChild(e),this._updateCarousel()}connectedCallback(){this._handleExtensionAdded=()=>{this._updateCarousel(),this._removeButtonListeners(),this._setupButtonListeners()},this._handleWheel=t=>{t.preventDefault();const e=0!==t.deltaX?t.deltaX:t.deltaY;if(this.wheelAccumulator+=e*this.wheelSensitivity,Math.abs(this.wheelAccumulator)>=this.wheelThreshold){const t=Math.sign(this.wheelAccumulator);this._snap(this.currentIndex+t),this.wheelAccumulator=0}},this._handleDragStart=this._startDragging.bind(this),this._handleDrag=this._drag.bind(this),this._handleDragEnd=this._stopDragging.bind(this),window.addEventListener("core:ui-mode-change",this._handleUIModeChange.bind(this)),window.addEventListener("core:extension-menu-added",this._handleExtensionAdded),this.wheelAccumulator=0,this.wheelSensitivity=.3,this.wheelThreshold=1,this.addEventListener("wheel",this._handleWheel,{passive:!1}),this.addEventListener("mousedown",this._handleDragStart),window.addEventListener("mousemove",this._handleDrag),window.addEventListener("mouseup",this._handleDragEnd),window.addEventListener("mouseleave",this._handleDragEnd),this.addEventListener("touchstart",this._handleDragStart,{passive:!1}),window.addEventListener("touchmove",this._handleDrag,{passive:!1}),window.addEventListener("touchend",this._handleDragEnd),window.addEventListener("touchcancel",this._handleDragEnd),this._setupButtonListeners()}disconnectedCallback(){window.removeEventListener("core:ui-mode-change",this._handleUIModeChange.bind(this)),window.removeEventListener("core:extension-menu-added",this._handleExtensionAdded),this.removeEventListener("wheel",this._handleWheel),this.removeEventListener("mousedown",this._handleDragStart),window.removeEventListener("mousemove",this._handleDrag),window.removeEventListener("mouseup",this._handleDragEnd),window.removeEventListener("mouseleave",this._handleDragEnd),this.removeEventListener("touchstart",this._handleDragStart),window.removeEventListener("touchmove",this._handleDrag),window.removeEventListener("touchend",this._handleDragEnd),window.removeEventListener("touchcancel",this._handleDragEnd),this._removeButtonListeners()}_setupButtonListeners(){this._buttonHandlers=new Map,this._touchStartX=0,this._touchStartTime=0,this._buttons.forEach(((t,e)=>{const handleTouchStart=t=>{t.preventDefault(),this._touchStartX=t.touches[0].clientX,this._touchStartTime=Date.now()},handleTouchEnd=t=>{const n=t.changedTouches?t.changedTouches[0].clientX:t.clientX,r=Math.abs(n-this._touchStartX)>10||Date.now()-this._touchStartTime>200;if(r)return;t.preventDefault();const i=t.currentTarget.dataset.target;if(!r&&i){const t=e-this.currentIndex;this._animateToIndex(e,t)}},handleClick=t=>{t.preventDefault();if(t.currentTarget.dataset.target){const t=e-this.currentIndex;this._animateToIndex(e,t)}};this._buttonHandlers.set(t,{handleClick:handleClick,handleTouchStart:handleTouchStart,handleTouchEnd:handleTouchEnd}),t.addEventListener("touchstart",handleTouchStart,{passive:!1}),t.addEventListener("touchend",handleTouchEnd,{passive:!1}),t.addEventListener("click",handleClick)}))}_animateToIndex(t,e){if(this.isSnapping||t===this.currentIndex)return;this.isSnapping=!0;const r=Math.abs(e);let i=0;const animate=()=>{i++;const a=this.currentIndex+Math.sign(e);if(this.currentIndex=a,this._updateCarousel(!0),i<r)requestAnimationFrame(animate);else{setTimeout((()=>{this.isSnapping=!1}),this.snapDebounceTime);const e=this._buttons[t].dataset.target;n.dispatchEvent("menu-switched",{target:e})}};requestAnimationFrame(animate)}_removeButtonListeners(){this._buttonHandlers&&(this._buttonHandlers.forEach(((t,e)=>{e.removeEventListener("click",t.handleClick),e.removeEventListener("touchstart",t.handleTouchStart),e.removeEventListener("touchend",t.handleTouchEnd)})),this._buttonHandlers.clear())}_updateCarousel(t=!0){this._carousel=this.querySelector(".menu-carousel"),this._buttons=Array.from(this.querySelectorAll(".menu-bar-item")).filter((t=>"none"!==window.getComputedStyle(t).display));const e=108*(this._buttons.length/2-.5-this.currentIndex);this._carousel.style.transition=t?"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)":"none",this._carousel.style.transform=`translateX(${e}px)`,this._buttons.forEach(((t,e)=>{t.classList.toggle("nearby",1===Math.abs(e-this.currentIndex)),t.classList.toggle("active",e===this.currentIndex)}))}_startDragging(t){t.type.startsWith("touch")&&t.preventDefault(),this.isDragging=!0,this.startX=t.type.startsWith("touch")?t.touches[0].pageX:t.pageX,this.currentX=this.startX,this.lastDragX=this.startX,this._carousel.style.transition="none",this.dragStartIndex=this.currentIndex,this.animationFrame&&cancelAnimationFrame(this.animationFrame)}_drag(t){this.isDragging&&(t.type.startsWith("touch")&&t.preventDefault(),this.currentX=t.type.startsWith("touch")?t.touches[0].pageX:t.pageX,this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame((()=>{const t=this._buttons.length,e=this.currentX-this.startX,n=108*(t/2-.5-this.dragStartIndex);this._carousel.style.transform=`translateX(${n+e}px)`;const r=Math.round(-e/108)+this.dragStartIndex;r!==this.currentIndex&&r>=0&&r<this._buttons.length&&(this.currentIndex=r,this._updateActiveStates()),this.lastDragX=this.currentX})))}_stopDragging(){if(!this.isDragging)return;this.isDragging=!1,this.animationFrame&&cancelAnimationFrame(this.animationFrame);const t=this.currentX-this.lastDragX,e=Math.sign(t);Math.abs(t)>5?this._snap(this.currentIndex-e):this._snap(this.currentIndex)}_snap(t){if(this.isSnapping)return;const e=Math.max(0,Math.min(t,this._buttons.length-1));e!==this.currentIndex?(this.isSnapping=!0,this.currentIndex=e,this._updateCarousel(!0),setTimeout((()=>{this.isSnapping=!1}),this.snapDebounceTime)):this._updateCarousel(!0);const r=this._buttons[e].dataset.target;n.dispatchEvent("menu-switched",{target:r})}_updateActiveStates(){this._buttons.forEach(((t,e)=>{const n=Math.abs(e-this.currentIndex);t.classList.toggle("nearby",1===n),t.classList.toggle("active",e===this.currentIndex)}))}_handleUIModeChange(t){t.detail.isMobile||"list"!==m.coreMenuList[this.currentIndex]||this._animateToIndex(m.coreMenuList.indexOf("graph"),-1),this._updateCarousel(),this._removeButtonListeners(),this._setupButtonListeners()}}customElements.define("menu-carousel",MenuCarousel);var R=Object.freeze({__proto__:null});class PhoneSelector extends HTMLElement{constructor(){super(),this.className="phone-selector-container",this.innerHTML=`\n      <header class="ps-header">\n        <gt-button class="ps-header-nav-brand" variant="filled">\n          ${"< "+t.getString("phone-selector.header-brand-btn","Brands")}\n        </gt-button>\n        <input type="search" class="ps-header-search" placeholder='${t.getString("phone-selector.header-search-bar-placeholder","Search")}'>\n        <gt-button class="ps-header-nav-phone" variant="filled" style="display:none">\n          ${t.getString("phone-selector.header-device-btn","Devices")+" >"}\n        </gt-button>\n      </header>\n      <div class="ps-lists">\n        <div class="ps-brand-list"></div>\n        <div class="ps-phone-list mobile-visible"></div>\n      </div>\n    `;const e=document.createElement("style");e.textContent='\n.phone-selector-container {\n  display: flex;\n  flex-direction: column;\n  min-width: 20rem;\n  height: inherit;\n  background: var(--gt-color-surface);\n  box-sizing: border-box;\n  container: ps-container / inline-size;\n}\n\n.ps-header {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 2.75rem;\n  gap: 1rem;\n  padding: 0 1rem 1rem 1rem;\n}\n\n.ps-header-search {\n  flex: 1;\n  width: 100%;\n  height: 2.7rem;\n  padding: 0 1.25rem;\n  border: none;\n  border-radius: 4rem;\n  background: var(--gt-color-surface-container-highest);\n  color: var(--gt-color-on-surface);\n}\n.ps-header-search::placeholder {\n  color: var(--gt-color-on-surface-variant);\n}\n.ps-header-search:focus, .ps-header-search:focus-visible {\n  outline: 2px solid var(--gt-color-secondary);\n}\n\n.ps-lists {\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n  overflow: hidden;\n  position: relative;\n}\n\n.ps-brand-list {\n  flex: 1;\n  display: block;\n  overflow-y: auto;\n  margin-right: 0.5rem;\n  padding: 0 0.5rem;\n  box-sizing: border-box;\n  min-width: 7rem;\n  scrollbar-gutter: stable both-edges;\n}\n\n.ps-brand-item {\n  display: flex;\n  align-items: center;\n  padding: 0 1rem;\n  margin: 0.75rem 0;\n  height: 2.5rem;\n  border-radius: 2.5rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  gap: 0.75rem;\n  background: var(--gt-color-surface);\n  border: 1px solid var(--gt-color-outline);\n  color: var(--gt-color-primary);\n\n  input {\n    display: none;\n  }\n\n  span {\n    width: 100%;\n    height: 2.25rem;\n    align-content: center;\n    font: var(--gt-typescale-title-small);\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n  }\n}\n.ps-brand-item:first-child {\n  margin-top: 0;\n}\n.ps-brand-item:has(input:checked) {\n  background: var(--gt-color-secondary);\n  color: var(--gt-color-on-secondary);\n}\n\n.ps-phone-list {\n  flex: 2;\n  display: block;\n  transition: all 0.2s ease;\n  padding: 0 0.5rem 0 0;\n  overflow-y: scroll;\n  scrollbar-gutter: stable both-edges;\n}\n\n.ps-phone-item {\n  border-radius: 0.75rem;\n  min-height: fit-content;\n  margin: 0.75rem 0;\n  transition: all 0.2s ease-out;\n  background: var(--gt-color-surface-container);\n  color: var(--gt-color-on-surface);\n  border: 1px solid var(--gt-color-surface-container-highest);\n  overflow: hidden;\n\n  label {\n    flex: 1;\n    display: flex;\n    justify-content: center;\n    flex-direction: column;\n    position: relative;\n    padding: 0.7rem 1rem;\n    gap: 0.3rem;\n    cursor: pointer;\n  }\n\n  input {\n    display: none;\n  }\n}\n.ps-phone-item:has(input:checked) {\n  background: var(--gt-color-primary);\n  color: var(--gt-color-on-primary);\n\n  .ps-phone-review-score {\n    background: var(--gt-color-primary-container);\n    color: var(--gt-color-on-primary-container);\n  }\n  .ps-link-group a {\n    color: var(--gt-color-primary-container);\n  }\n}\n.ps-phone-item:first-child {\n  margin-top: 0;\n}\n.ps-phone-item:has(input:disabled) {\n  cursor: not-allowed;\n}\n.ps-phone-item[aria-busy="true"]::after {\n  border-radius: inherit;\n}\n\n.ps-phone-name {\n  width: 100%;\n  font: var(--gt-typescale-title-small);\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n}\n\n.ps-phone-review-score {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.2rem;\n  position: absolute;\n  top: 0.6rem;\n  right: 0.6rem;\n  height: 1rem;\n  background: var(--gt-color-primary);\n  color: var(--gt-color-on-primary);\n  padding: 0.5rem;\n  border-radius: 0.7rem;\n  font-weight: 500;\n\n  svg {\n    width: 1rem;\n    height: 1rem;\n  }\n}\n\n.ps-link-group {\n  display: flex;\n  flex-direction: row;\n  gap: 0.5rem;\n  margin-top: 0.1rem;\n\n  a {\n    display: flex;\n    flex-direction: row;\n    gap: 0.2rem;\n    align-items: stretch;\n    color: var(--gt-color-primary);\n  }\n\n  svg {\n    width: 1rem;\n    height: 1rem;\n  }\n}\n\n.ps-brand-item:active {\n  filter: var(--gt-hover-filter);\n  transition: filter 0s;\n}\n\n.ps-phone-item:active {\n  -webkit-box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n  -moz-box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n  box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n  transition: box-shadow 0s;\n}\n\n.ps-link-group a:active {\n  color: var(--gt-color-teritary-container);\n  transition: color 0s;\n}\n\n.ps-link-group a:active {\n  color: var(--gt-color-teritary);\n  transition: color 0s;\n}\n\n.ps-clear-brands-btn {\n  position: absolute;\n  bottom: 1rem;\n  left: 50%;\n  height: 2.1rem;\n  transform: translateX(-50%);\n  padding: 0.5rem 1rem 0.5rem 0.75rem;\n  border-radius: 2rem;\n  background: var(--gt-color-tertiary);\n  color: var(--gt-color-on-tertiary);\n  box-shadow: 0 0 0.5rem rgba(0, 0, 0, 0.3);\n  border: none;\n  cursor: pointer;\n  font-weight: 500;\n  z-index: 10;\n  transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out;\n  opacity: 0;\n  pointer-events: none; /* Hidden by default */\n}\n\n.ps-clear-brands-btn.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n\n@media (hover: hover) and (pointer: fine) {\n  .ps-brand-item:hover {\n    filter: var(--gt-hover-filter);\n  }\n\n  .ps-phone-item:hover {\n    -webkit-box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n    -moz-box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n    box-shadow: inset 0 0 0.4rem var(--gt-color-primary);\n  }\n\n  .ps-link-group a:hover {\n    color: var(--gt-color-teritary-container);\n  }\n\n  .ps-link-group a:hover {\n    color: var(--gt-color-teritary);\n  }\n\n  .ps-clear-brands-btn:hover {\n    background: var(--gt-color-tertiary);\n    filter: var(--gt-hover-filter);\n  }\n}\n\n/* responsive layout */\n.ps-header-nav-brand, .ps-header-nav-phone {\n  display: none;\n  min-width: fit-content;\n}\n\n@container ps-container (max-width: 500px) {\n  .ps-brand-list {\n    position: absolute;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    transition: transform 0.3s ease-in-out;\n    transform: translateX(0);\n    box-sizing: border-box;\n    overflow-y: scroll;\n  }\n  .ps-brand-list.mobile-visible {\n    transform: translateX(100%);\n  }\n  \n  .ps-phone-list {\n    position: absolute;\n    right: -100%;\n    width: 100%;\n    height: 100%;\n    padding: 0 0.5rem;\n    transition: transform 0.3s ease-in-out;\n    transform: translateX(0);\n    box-sizing: border-box;\n  }\n  .ps-phone-list.mobile-visible {\n    transform: translateX(-100%);\n  }\n\n  .ps-header-nav-brand, .ps-header-nav-phone {\n    display: block;\n    height: 2.5rem;\n  }\n}\n',this.appendChild(e),this.brandListElement=this.querySelector(".ps-brand-list"),this.phoneListElement=this.querySelector(".ps-phone-list"),this.clearBrandsButton=document.createElement("button"),this.clearBrandsButton.className="ps-clear-brands-btn",this.clearBrandsButton.innerHTML=`\n      ${S.Icon("close","width: 1.25rem; height: 1.25rem; margin-right: 0.25rem")}\n      ${t.getString("phone-selector.clear-brands-btn","Unselect Brands")}\n    `,this.querySelector(".ps-lists").appendChild(this.clearBrandsButton),this.clearBrandsButton.addEventListener("click",this._clearBrandSelection.bind(this)),this.querySelector(".ps-header-search").addEventListener("input",(t=>{this._filterPhoneList(t.target.value)})),this.querySelector(".ps-header-nav-brand").addEventListener("click",(t=>this._switchListPanel(t,"brand"))),this.querySelector(".ps-header-nav-phone").addEventListener("click",(t=>this._switchListPanel(t,"phone")))}connectedCallback(){window.addEventListener("core:fr-phone-added",(t=>this._changePhoneItemBtnStatus(t,!0))),window.addEventListener("core:fr-phone-removed",(t=>this._changePhoneItemBtnStatus(t,!1))),window.addEventListener("core:metadata-loaded",(()=>this._init())),t.addObserver(this._updateLanguage.bind(this)),/Android/.test(navigator.userAgent)&&window.addEventListener("core:init-ready",(()=>{this.style.display="none",setTimeout((()=>{this.style.display="flex"}),"1000")}))}disconnectedCallback(){window.removeEventListener("core:fr-phone-added",(t=>this._changePhoneItemBtnStatus(t,!0))),window.removeEventListener("core:fr-phone-removed",(t=>this._changePhoneItemBtnStatus(t,!1))),window.removeEventListener("core:metadata-loaded",(()=>this._init())),t.removeObserver(this._updateLanguage.bind(this))}_init(){null!==p.phoneMetadata&&(this.brandListData=Array.from(p.phoneMetadata).map((t=>t.brand)),this.fullPhoneListData=Array.from(p.phoneMetadata).flatMap((t=>t.phones.map((e=>({...e,brand:t.brand}))))),this.phoneListData=Array.from(p.phoneMetadata).flatMap((t=>t.phones.map((e=>({...e,brand:t.brand}))))),this._renderBrandList(),this._renderPhoneList(),this._addBrandEventListeners(),this._addPhoneEventListeners(),this._updateClearBrandsButtonVisibility(),n.dispatchInitEvent("phone-ui-ready"))}_renderBrandList(){this.brandListElement.innerHTML="",this.brandListData.forEach((t=>{const e=document.createElement("label");e.className="ps-brand-item",e.innerHTML=`\n        <input type="checkbox" data-identifier="${t}">\n        <span>${t}</span>\n      `,this.brandListElement.appendChild(e)}))}_renderPhoneList(){this.phoneListElement.innerHTML="",this.phoneListData.forEach((e=>{const n=document.createElement("div");n.className="ps-phone-item",n.innerHTML=`\n        <label>\n          <input type="checkbox" \n            data-identifier="${e.identifier}" \n            ${g.isFRDataLoaded(e.identifier)?"checked":""}\n          >\n          <span class="ps-phone-name">${e.identifier}</span>\n          ${e.reviewScore?`<span class="ps-phone-review-score">${this._getScoreElement(e.reviewScore)}</span>`:""}\n          ${e.price?`<span class="ps-phone-price">${e.price}</span>`:""}\n          ${e.reviewLink||e.shopLink?`<div class="ps-link-group">\n                ${e.reviewLink?`<a target="_blank" rel="noopener" href="${e.reviewLink}" class="ps-link-review">\n                      ${S.Icon("externalLink")} ${t.getString("phone-selector.item-review","Review")}\n                    </a>`:""}\n                ${e.shopLink?`<a target="_blank" rel="noopener" href="${e.shopLink}" class="ps-link-shop">\n                      ${S.Icon("externalLink")} ${t.getString("phone-selector.item-shop","Shop")}\n                    </a>`:""}\n              </div>`:""}\n        </label>\n      `,this.phoneListElement.appendChild(n)}))}_addBrandEventListeners(){this.shouldSwitchPanelOnClick=e.get("INTERFACE.SWITCH_PHONE_PANEL_ON_BRAND_CLICK")||!0,this.querySelectorAll(".ps-brand-item input").forEach((t=>{t.addEventListener("change",(t=>{t.preventDefault();const e=t.target.dataset.identifier,n=Array.from(this.querySelectorAll(".ps-brand-item input:checked"));if(0===n.length)this.phoneListData=[...this.fullPhoneListData];else if(1===n.length){const t=n[0].dataset.identifier;this.phoneListData=this.fullPhoneListData.filter((e=>e.brand===t))}else if(t.target.checked){const t=n.map((t=>t.dataset.identifier));this.phoneListData=this.fullPhoneListData.filter((e=>t.includes(e.brand)))}else this.phoneListData=this.phoneListData.filter((t=>t.brand!==e));this.shouldSwitchPanelOnClick&&this._switchListPanel(null,"phone"),this._renderPhoneList(),this._addPhoneEventListeners(),this._updateClearBrandsButtonVisibility()}))}))}_addPhoneEventListeners(){this.querySelectorAll(".ps-phone-item input").forEach((t=>{t.addEventListener("change",(async n=>{n.preventDefault();const r=n.target.closest(".ps-phone-item");r.setAttribute("aria-busy","true"),t.disabled=!0;const i=n.target.dataset.identifier,a=g.isFRDataLoaded(i);try{await g.toggleFRData("phone",i,!a)}catch(n){t.checked=a,console.error("Failed to toggle phone data:",n)}finally{t.disabled=!1,r.setAttribute("aria-busy","false")}!e.get("INTERFACE.ALLOW_REMOVING_PHONE_FROM_SELECTOR")&&t.checked&&(t.disabled=!0)}))}))}_filterPhoneList(t){const e=t.toLowerCase().trim();this.querySelectorAll(".ps-phone-item").forEach((t=>{const n=t.querySelector(".ps-phone-name").textContent.toLowerCase().includes(e)?"flex":"none";t.style.display=n}))}_changePhoneItemBtnStatus(t,n){this._updateBtnStatTimeout&&this._previousBtnTarget===t.detail.identifier&&clearTimeout(this._updateBtnStatTimeout),!n&&g.isFRDataLoaded(t.detail.identifier)||(this._previousBtnTarget=t.detail.identifier,this._updateBtnStatTimeout=setTimeout((()=>{if(n){const n=this.querySelector(`.ps-phone-item input[data-identifier="${t.detail.identifier}"]`);n&&(n.checked=!0,e.get("INTERFACE.ALLOW_REMOVING_PHONE_FROM_SELECTOR")||(n.disabled=!0))}else{const e=this.querySelector(`.ps-phone-item input[data-identifier="${t.detail.identifier}"]`);e&&(e.checked=!1,e.disabled=!1)}this._updateBtnStatTimeout=null}),100))}_clearBrandSelection(){this.querySelectorAll(".ps-brand-item input:checked").forEach((t=>{t.checked=!1})),this.phoneListData=[...this.fullPhoneListData],this._renderPhoneList(),this._addPhoneEventListeners(),this._updateClearBrandsButtonVisibility()}_updateClearBrandsButtonVisibility(){this.querySelectorAll(".ps-brand-item input:checked").length>0?(this.clearBrandsButton.classList.add("visible"),this.querySelector(".ps-brand-item:last-child").style.marginBottom="4rem",this.querySelector(".ps-phone-item:last-child").style.marginBottom="4rem"):(this.clearBrandsButton.classList.remove("visible"),this.querySelector(".ps-brand-item:last-child").style.marginBottom="0.75rem",this.querySelector(".ps-phone-item:last-child").style.marginBottom="0.75rem")}_switchListPanel(t,e){null!==t&&t.preventDefault(),this.querySelector(".ps-brand-list").classList.toggle("mobile-visible"),this.querySelector(".ps-phone-list").classList.toggle("mobile-visible"),this.querySelector(".ps-header-nav-"+("phone"===e?"brand":"phone")).style.display="",this.querySelector(`.ps-header-nav-${e}`).style.display="none"}_getScoreElement(t){if(!Number.isInteger(parseInt(t))||t<0&&5<t)return t;let e="";const n=Math.floor(t),r=t%1>=.5,i=5-Math.ceil(t);for(let t=0;t<n;t++)e+=S.Icon("starFill");r&&(e+=S.Icon("starHalf"));for(let t=0;t<i;t++)e+=S.Icon("starLine");return e}_updateLanguage(){const e=this.querySelector(".ps-header-nav-brand");e&&(e.innerHTML="< "+t.getString("phone-selector.header-brand-btn","Brands"));const n=this.querySelector(".ps-header-nav-phone");n&&(n.innerHTML=t.getString("phone-selector.header-device-btn","Devices")+" >");const r=this.querySelector(".ps-header-search");r&&(r.placeholder=t.getString("phone-selector.header-search-bar-placeholder","Search"));const i=this.querySelectorAll(".ps-link-review");i&&i.forEach((e=>e.innerHTML=`${S.Icon("externalLink")} ${t.getString("phone-selector.item-review","Review")}`));const a=this.querySelectorAll(".ps-link-shop");a&&a.forEach((e=>e.innerHTML=`${S.Icon("externalLink")} ${t.getString("phone-selector.item-shop","Shop")}`)),this.clearBrandsButton&&(this.clearBrandsButton.innerHTML=`\n        ${S.Icon("close","width: 1.25rem; height: 1.25rem; margin-right: 0.25rem")}\n        ${t.getString("phone-selector.clear-brands-btn","Unselect Brands")}\n      `)}}customElements.define("phone-selector",PhoneSelector);var D=Object.freeze({__proto__:null});class TargetSelector extends HTMLElement{constructor(){super(),this.targets=e.get("TARGET_MANIFEST")||[],this.className="target-selector-container",this.isCollapsed=!1;const n=document.createElement("style");n.textContent="\n  .target-selector-container {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: fit-content;\n  }\n\n  .target-selector-group {\n    display: inline-flex;\n    flex-direction: column;\n    width: 100%;\n    min-height: 0.5rem;\n    overflow: hidden;\n    border-radius: 0.3rem 0.3rem 0.3rem 0;\n    background: var(--gt-color-surface-container-high);\n    max-height: 1000px;\n    opacity: 1;\n    visibility: visible;\n    transform-origin: top;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n  \n  .target-selector-group.collapsed {\n    max-height: 0.5rem;\n    filter: var(--gt-hover-filter);\n  }\n  \n  .target-selector-group.collapsed .target-group-item {\n    opacity: 0;\n  }\n\n  .target-group-item {\n    display: flex;\n    flex-direction: row;\n    padding: 0.2rem 0;\n    overflow-x: scroll;\n    overflow-y: hidden;\n    width: 100%;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n  .target-group-item:first-child{\n    margin-top: 0.1rem;\n  }\n  .tsc-single-row {\n    display: block;\n    width: 100%;\n    overflow-x: scroll;\n\n    .target-selector-group {\n      width: auto;\n      flex-direction: row;\n      padding-right: 1rem;\n    }\n    .target-group-item {\n      width: auto;\n      overflow: hidden;\n    }\n    .target-list-container {\n      padding-right: 0;\n    }\n  }\n\n  .target-group-name span {\n    color: var(--gt-color-primary);\n    font-weight: 600;\n    min-width: min-content;\n    margin: 0;\n  }\n\n  .target-list-container {\n    display: flex;\n    align-items: center;\n    gap: 0.9rem;\n    padding: 0 1rem;\n    position: relative;\n    white-space: nowrap;\n  }\n\n  .target-list {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n    min-height: 2.5rem;\n  }\n\n  .target-list-item {\n    overflow: hidden;\n  }\n\n  .tsc-collapse-button-group {\n    display: flex;\n    flex-direction: row;\n    gap: 1rem;\n    width: 100%;\n    overflow: hidden;\n  }\n  \n  .tsc-collapse-button {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    gap: 0.5rem;\n    padding: 0.2rem 1rem 0.2rem 0.6rem;\n    height: 2.5rem;\n    width: fit-content;\n    font-weight: 500;\n    border-radius: 0 0 0.3rem 0.3rem;\n    color: var(--gt-color-on-surface);\n    background: var(--gt-color-surface-container-high);\n    border: 1px solid var(--gt-color-surface-container-highest);\n    cursor: pointer;\n    transition: transform 0.3s ease;\n  }\n  \n  .tsc-collapse-button span {\n    width: max-content;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n  \n  .tsc-collapse-button svg {\n    fill: var(--gt-color-on-surface);\n    transition: transform 0.3s ease;\n  }\n  \n  .tsc-collapse-button.collapsed svg {\n    transform: rotate(180deg);\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .tsc-collapse-button:hover {\n      background: var(--gt-color-surface-container-highest);\n      filter: var(--gt-hover-filter)\n    }\n  }\n\n  .tsc-single-row::-webkit-scrollbar, .target-group-item::-webkit-scrollbar, .target-selector-container::-webkit-scrollbar {\n    height: 0.4rem;\n  }\n  .tsc-single-row::-webkit-scrollbar-track, .target-group-item::-webkit-scrollbar-track, .target-selector-container::-webkit-scrollbar-track {\n    background: rgba(0,0,0,0.1);\n  }\n  .tsc-single-row::-webkit-scrollbar-thumb, .target-group-item::-webkit-scrollbar-thumb {\n    background: rgba(0,0,0,0.3);\n    border-radius: 1rem;\n  }\n",this.appendChild(n),this.targetSelectorGroup=document.createElement("div"),this.targetSelectorGroup.className="target-selector-group",this.appendChild(this.targetSelectorGroup),t.addObserver(this._updateLanguage.bind(this))}connectedCallback(){window.addEventListener("core:fr-target-added",(t=>this._tickTargetButton(t))),window.addEventListener("core:fr-target-removed",(t=>this._untickTargetButton(t))),window.addEventListener("core:metadata-loaded",(()=>this._init()))}disconnectedCallback(){window.removeEventListener("core:fr-target-added",(t=>this._tickTargetButton(t))),window.removeEventListener("core:fr-target-removed",(t=>this._untickTargetButton(t))),window.removeEventListener("core:metadata-loaded",(()=>this._init())),t.removeObserver(this._updateLanguage.bind(this))}_init(){this._render(),e.get("INTERFACE.TARGET.ALLOW_MULTIPLE_LINE_PER_TYPE")?this.querySelectorAll(".target-group-item").forEach((t=>{this._addDragScroll(t)})):(this.classList.add("tsc-single-row"),this._addDragScroll(this)),n.dispatchInitEvent("target-ui-ready")}_render(){this.targets.forEach((t=>{const n=document.createElement("div");n.className="target-group-item",n.innerHTML=`\n        <div class="target-list-container">\n          <div class="target-group-name"><span>${t.type}</span></div>\n          <div class="target-list"></div>\n        </div>\n      `,t.files.forEach((t=>{const r=t.includes(" Target")?t:`${t} Target`,i=`\n          <gt-button toggleable variant='outlined' identifier='${r}' class='target-list-item'>\n            ${e.get("INTERFACE.TARGET.OMIT_TARGET_SUFFIX")?`<span class="targetname">${r.replace(" Target","")}</span>`:`<span class="targetname">${r}</span>`}\n          </gt-button>\n        `;n.querySelector(".target-list").insertAdjacentHTML("beforeend",i);const a=n.querySelector(".target-list > gt-button:last-child");a.addEventListener("gt-button-toggle",(async t=>{t.preventDefault(),a.disabled=!0,a.setAttribute("aria-busy","true");const e=g.isFRDataLoaded(r);try{await g.toggleFRData("target",r,!e)}catch(t){a.toggle(e,!0),console.error("Operation failed:",t)}finally{a.disabled=!1,a.setAttribute("aria-busy","false")}}))})),this.targetSelectorGroup.appendChild(n)})),e.get("INTERFACE.TARGET.ALLOW_MULTIPLE_LINE_PER_TYPE")&&(this.buttonGroup=document.createElement("div"),this.buttonGroup.className="tsc-collapse-button-group",this.collapseButton=document.createElement("button"),this.collapseButton.className="tsc-collapse-button",this.collapseButton.innerHTML=`\n        ${S.Icon("shortArrowUp","width: 1.25rem; height: 1.25rem;")}\n        <span>${t.getString("target-selector.label","Target")}</span>\n      `,this.collapseButton.addEventListener("click",this._toggleCollapse.bind(this)),this.buttonGroup.appendChild(this.collapseButton),this.appendChild(this.buttonGroup)),e.get("INTERFACE.TARGET.COLLAPSE_TARGET_LIST_ON_INITIAL")&&this._toggleCollapse()}_tickTargetButton(t){const e=this.querySelector(`.target-list-item[identifier="${t.detail.identifier}"]`);e&&e.toggle(!0,!0)}_untickTargetButton(t){const e=this.querySelector(`.target-list-item[identifier="${t.detail.identifier}"]`);e&&e.toggle(!1,!0)}_addDragScroll(t){let e,n,r=!1;t.addEventListener("mousedown",(i=>{i.preventDefault(),r=!0,t.style.cursor="grabbing",t.style.userSelect="none",e=i.pageX-t.offsetLeft,n=t.scrollLeft})),t.addEventListener("mouseleave",(()=>{r&&(r=!1,t.style.cursor="default",t.style.userSelect="")})),t.addEventListener("mouseup",(()=>{r&&(r=!1,t.style.cursor="default",t.style.userSelect="")})),t.addEventListener("mousemove",(i=>{if(!r)return;i.preventDefault();const a=1.5*(i.pageX-t.offsetLeft-e);t.scrollLeft=n-a})),t.style.cursor="default"}_toggleCollapse(){this.isCollapsed=!this.isCollapsed,this.isCollapsed?(this.targetSelectorGroup.classList.add("collapsed"),this.collapseButton.classList.add("collapsed")):(this.targetSelectorGroup.classList.remove("collapsed"),this.collapseButton.classList.remove("collapsed"))}_updateLanguage(){const n=this.querySelectorAll(".target-group-name > span");n&&(this.targets=e.get("TARGET_MANIFEST")||[],n.forEach(((t,e)=>{t.textContent=this.targets[e]?.type}))),this.collapseButton&&(this.collapseButton.innerHTML=`\n        ${S.Icon("shortArrowUp","width: 1.25rem; height: 1.25rem;")}\n        <span>${t.getString("target-selector.label","Target")}</span>\n      `)}}customElements.define("target-selector",TargetSelector);var H=Object.freeze({__proto__:null});class NormalizerInput extends HTMLElement{constructor(){super(),this.normType=s.type,this.normValueHZ=s.Hzvalue,this.className="normalizer-input",this.innerHTML=`\n      <label class="normalizer-number">\n        <span>${t.getString("normalizer-input.label","Normalization")}</span>\n        <gt-divider style="margin: 0.25rem 0.5rem;"></gt-divider>\n        <input type="number" value="${this.normValueHZ}" min="20" max="20000" step="1"\n          placeholder="Hz for Normalization" ${"Avg"===this.normType?"disabled":""}\n        >\n      </label>\n      <label class="normalizer-radio Hz">\n        <input type="radio" name="normType" value="Hz" ${"Hz"===this.normType?"checked":""}>\n        <span>${t.getString("normalizer-input.hz-btn","Hz")}</span>\n      </label>\n      <label class="normalizer-radio Avg">\n        <input type="radio" name="normType" value="Avg" ${"Avg"===this.normType?"checked":""}>\n        <span>${t.getString("normalizer-input.avg-btn","Avg.")}</span>\n      </label>\n    `;const e=document.createElement("style");e.textContent='\n  .normalizer-input {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    padding: 0.25rem 0.25rem 0.25rem 1rem;\n    border: 1px solid var(--gt-color-outline);\n    border-radius: 3.5rem;\n  }\n\n  .normalizer-input input[type="radio"] {\n    display: none;\n  }\n\n  .normalizer-radio {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 3rem;\n    height: 1.75rem;\n    color: var(--gt-color-primary);\n    border: 1px solid var(--gt-color-outline);\n    cursor: pointer;\n    span {\n      font-weight: 600;\n    }\n  }\n  .normalizer-radio:has(input:checked) {\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n  }\n  .normalizer-radio.Hz {\n    padding-left: 0.25rem;\n    border-radius: 2.5rem 0 0 2.5rem;\n    border-right: 0;\n  }\n  .normalizer-radio.Avg {\n    padding-right: 0.25rem;\n    border-radius: 0 2.5rem 2.5rem 0;\n  }\n  .normalizer-radio:hover {\n    background: var(--gt-shadow);\n    filter: var(--gt-hover-filter);\n  }\n\n  .normalizer-number {\n    flex: 1;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    color: var(--gt-color-primary);\n    align-self: stretch;\n    font-weight: 500;\n    \n    input {\n      outline: 0;\n      border: 0;\n      padding: 0;\n      color: var(--gt-color-primary);\n      background: transparent;\n      font-weight: bold;\n      max-width: 4rem;\n    }\n    input:disabled {\n      filter: opacity(0.3);\n    }\n  }\n',this.appendChild(e),this._setupEventListeners()}connectedCallback(){t.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){t.removeObserver(this._updateLabel.bind(this))}_setupEventListeners(){this.querySelectorAll("input[type=radio]").forEach((t=>{t.addEventListener("change",(t=>{if(t.target.checked){s.updateNormalizationType(t.target.value),s.updateNormalization();this.querySelector("input[type=number]").toggleAttribute("disabled","Avg"===t.target.value)}}))})),this.querySelector('input[type="number"]').addEventListener("input",(t=>{const e=t.target.closest(".dB")?"dB":"Hz",n=parseFloat(t.target.value);s.updateNormalizationValue(e,n),s.updateNormalization()}))}_updateLabel(){this.querySelector(".normalizer-number > span").textContent=t.getString("normalizer-input.label","Normalization"),this.querySelector(".normalizer-radio.Hz > span").textContent=t.getString("normalizer-input.hz-btn","Hz"),this.querySelector(".normalizer-radio.Avg > span").textContent=t.getString("normalizer-input.avg-btn","Avg.")}}customElements.define("normalizer-input",NormalizerInput);var N=Object.freeze({__proto__:null});class SelectionList extends HTMLElement{constructor(){super(),this._boundHandleItemAdded=this._handleItemAdded.bind(this),this._boundHandleItemRemoved=this._handleItemRemoved.bind(this),this._boundHandleItemUpdated=this._handleItemUpdated.bind(this),this._boundHandleChannelUpdated=this._handleChannelUpdated.bind(this),this._boundUpdateLanguage=this._updateLanguage.bind(this),this.listSection=null,this.styleElement=null,this.init()}init(){this.styleElement=document.createElement("style"),this.styleElement.textContent='\n  .selection-list {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n    padding: 0.5rem;\n    margin-bottom: 1rem;\n    border-radius: 0.5rem;\n    background: var(--gt-color-surface-container-highest);\n    container-type: inline-size;\n    container-name: selection-list;\n  }\n\n  .selection-list-item {\n    display: flex;\n    flex-direction: column;\n    border-radius: 0.4rem;\n    color: var(--gt-color-on-surface);\n    background: var(--gt-color-surface);\n  }\n  .selection-list-item:has(.sl-variant-btn.active) {\n    background: none;\n  }\n\n  .sl-item-content {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    padding: 0.8rem 0.7rem 0.8rem 0.9rem;\n  }\n  .sl-item-content:has(.sl-variant-btn.active) {\n    background: var(--gt-color-surface);\n    border: 1px solid var(--gt-color-outline);\n    border-radius: 0.4rem;\n  }\n\n  .sl-item-heading {\n    flex: 1;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.25rem;\n    overflow-x: hidden;\n    position: relative;\n\n    &::after {\n      content: \'\';\n      position: absolute;\n      right: 0;\n      top: 0;\n      height: 100%;\n      width: 2rem;\n      background: linear-gradient(to right, transparent, var(--gt-color-surface));\n      pointer-events: none;\n    }\n\n    span {\n      font-size: 0.85rem;\n      font-weight: 600;\n      white-space: nowrap;\n    }\n  }\n\n  .sl-item-leading {\n    display: flex;\n    flex-wrap: wrap;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.7rem;\n  }\n\n  .sl-color-btn {\n    width: 1rem;\n    height: 1rem;\n    border: 1px solid var(--gt-color-on-surface);\n    border-radius: 1rem;\n    margin-right: 0.5rem;\n    cursor: pointer;\n  }\n\n  .sl-name {\n    flex: 1;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.3rem;\n    overflow-x: hidden;\n  }\n\n  .sl-variant-btn {\n    display: flex;\n    align-items: center;\n    cursor: pointer;\n    border-radius: 2rem;\n    margin: 0 0.2rem;\n    background: none;\n    border: 2px solid var(--gt-color-on-surface-variant);\n    color: var(--gt-color-on-surface-variant);\n\n    svg {\n      width: 1rem;\n      height: 1rem;\n    }\n  }\n\n  .sl-y-offset {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.2rem;\n    padding-left: 0.2rem;\n\n    svg {\n      width: 1rem;\n      height: 1rem;\n    }\n\n    input {\n      width: 1.6rem;\n      height: 1.6rem;\n      padding: 0 0.5rem;\n      border-radius: 0.5rem;\n      border: 1px solid var(--gt-color-outline);\n      outline: none;\n      color: var(--gt-color-on-surface);\n      background-color: var(--gt-color-surface-container-lowest);\n    }\n  }\n\n  .sl-y-offset-dec, .sl-y-offset-inc {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0;\n    width: 1.5rem;\n    height: 1.5rem;\n    border-radius: 1.5rem;\n    border: none;\n    cursor: pointer;\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n\n    svg {\n      width: 1rem;\n      height: 1rem;\n    }\n  }\n\n  .sl-channels-select {\n    width: 5rem;\n    height: 1.7rem;\n    margin-right: 0.1rem;\n    border-radius: 0.5rem;\n    color: var(--gt-color-on-surface);\n    background-color: var(--gt-color-surface-container-lowest);\n  }\n\n  .sl-button-row {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .sl-button {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    width: 2rem;\n    height: 2rem;\n    background: none;\n    border: none;\n    border-radius: 2rem;\n    color: var(--gt-color-on-surface-variant);\n    svg {\n      width: 1.25rem;\n      height: 1.25rem;\n    }\n  }\n\n  .sl-variant-menu {\n    display: flex;\n    flex-direction: column;\n    border-radius: 0 0 0.5rem 0.5rem;\n    padding: 0 0.5rem;\n    background: var(--gt-color-surface-container-highest);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    overflow: hidden;\n    max-height: 0;\n    visibility: hidden;\n    opacity: 0;\n  }\n\n  .sl-variant-menu.active {\n    padding-bottom: 0.5rem;\n    max-height: 1000px;\n    visibility: visible;\n    opacity: 1;\n    transform-origin: top;\n  }\n\n  .sl-variant-item {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    cursor: pointer;\n    justify-content: space-between;\n    padding: 0.5rem 0.8rem;\n    background: var(--gt-color-surface-container);\n    border: 1px solid var(--gt-color-outline); \n    border-top: none;\n  }\n  .sl-variant-item:last-child {\n    border-radius: 0 0 0.5rem 0.5rem;\n  }\n  .sl-variant-item-name {\n    font-weight: 500;\n  }\n\n  @media (hover: hover) and (pointer: fine) {\n    .sl-y-offset-dec:hover, .sl-y-offset-inc:hover {\n      background: var(--gt-color-primary);\n      filter: var(--gt-hover-filter);\n    }\n    .sl-button:hover {\n      background: var(--gt-shadow);\n    }\n    .sl-variant-item:hover {\n      background: var(--gt-shadow);\n    }\n    .sl-variant-item:has(.sl-button:hover) {\n      background: none;\n    }\n    .sl-button.add-variant:hover {\n      background: var(--gt-color-primary);\n      color: var(--gt-color-on-primary);\n    }\n  }\n\n  .sl-y-offset-dec:active, .sl-y-offset-inc:active {\n    filter: var(--gt-hover-filter);\n    transition: filter 0s;\n  }\n  .sl-button:active {\n    background: var(--gt-shadow);\n    transition: background 0s;\n  }\n  .sl-variant-item:active {\n    background: var(--gt-shadow);\n    transition: background 0s;\n  }\n  .sl-variant-item:has(.sl-button:active) {\n    background: none;\n    transition: background 0s;\n  }\n  .sl-button.add-variant:active {\n    background: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    transition: background 0s, color 0s;\n  }\n\n  @container selection-list (max-width: 700px) {\n    .sl-item-content {\n      flex-direction: column;\n      gap: 0.7rem;\n    }\n    .sl-item-heading, .sl-item-leading {\n      width: 100%;\n    }\n    .sl-item-leading {\n      justify-content: flex-end;\n    }\n  }\n\n  @container selection-list (min-width: 700px) {\n    .sl-item-content {\n      flex-direction: row;\n    }\n  }\n\n  select {\n    -webkit-appearance: none;\n    -moz-appearance: none;\n    appearance: none;\n    border: 1px solid var(--gt-color-outline);\n    padding-left: 0.6rem;\n    background-repeat: no-repeat;\n    background-position: right center;\n    background-image: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23666"><path d="M12 15.0006L7.75732 10.758L9.17154 9.34375L12 12.1722L14.8284 9.34375L16.2426 10.758L12 15.0006Z"></path></svg>\');\n    outline: none;\n    cursor: pointer;\n  }\n  \n  /* Chrome, Safari, Edge, Opera */\n  input::-webkit-outer-spin-button,\n  input::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  /* Firefox */\n  input[type=number] {\n    -moz-appearance: textfield;\n  }\n',this.appendChild(this.styleElement),this.listSection=document.createElement("section"),this.listSection.className="selection-list",this.appendChild(this.listSection),this._updateList(),window.addEventListener("core:fr-phone-added",this._boundHandleItemAdded),window.addEventListener("core:fr-target-added",this._boundHandleItemAdded),window.addEventListener("core:fr-unknown-inserted",this._boundHandleItemAdded),window.addEventListener("core:fr-phone-removed",this._boundHandleItemRemoved),window.addEventListener("core:fr-target-removed",this._boundHandleItemRemoved),window.addEventListener("core:fr-unknown-removed",this._boundHandleItemRemoved),window.addEventListener("core:fr-channel-updated",this._boundHandleChannelUpdated),window.addEventListener("core:fr-variant-updated",this._boundHandleItemUpdated),t.addObserver(this._boundUpdateLanguage)}destroy(){window.removeEventListener("core:fr-phone-added",this._boundHandleItemAdded),window.removeEventListener("core:fr-target-added",this._boundHandleItemAdded),window.removeEventListener("core:fr-unknown-inserted",this._boundHandleItemAdded),window.removeEventListener("core:fr-phone-removed",this._boundHandleItemRemoved),window.removeEventListener("core:fr-target-removed",this._boundHandleItemRemoved),window.removeEventListener("core:fr-unknown-removed",this._boundHandleItemRemoved),window.removeEventListener("core:fr-channel-updated",this._boundHandleChannelUpdated),window.removeEventListener("core:fr-variant-updated",this._boundHandleItemUpdated),t.removeObserver(this._boundUpdateLanguage)}_updateList(){if(!this.listSection)return;this.listSection.innerHTML="";Array.from(g.frDataMap).sort((([,t],[,e])=>"target"===t.type?-1:"target"===e.type?1:0)).forEach((([t,e])=>{const n=this._createListItemElement(t,e);this.listSection.appendChild(n),this._attachEventListenersToItem(n)}))}_createListItemElement(t,e){const n=document.createElement("div");return n.className="selection-list-item",n.dataset.uuid=t,n.dataset.type=e.type,n.innerHTML=`\n      <div class="sl-item-content">\n        <div class="sl-item-heading">\n          <button class="sl-color-btn" style="background: ${e.colors.AVG||e.colors}"></button>\n          <div class="sl-name">\n            <span class="sl-identifier">${e.identifier}</span>\n            ${"phone"===e.type&&e.meta.files.length>1?`\n              <button class="sl-variant-btn" title="Show Variants">${S.Icon("plus")}</button>\n              `:""}\n            <span class="sl-variant-name">${e.dispSuffix}</span>\n          </div>\n        </div>\n        <div class="sl-item-leading">\n          ${"target"!==e.type?`<div class="sl-channels">\n              <select class="sl-channels-select" title="Graph Channel">\n                ${this._getChannelOptions(Object.keys(e.channels),e.dispChannel)}\n              </select>\n            </div>`:""}\n          <div class="sl-y-offset">\n            <button class="sl-y-offset-dec">${S.Icon("arrowDown")}</button>\n            <input type="number" class="sl-y-offset-input" title="Move Graph Vertically" value="0" step="1">\n            <button class="sl-y-offset-inc">${S.Icon("arrowUp")}</button>\n          </div>\n          <div class="sl-button-row">\n            <div class="sl-baseline">\n              <button class="sl-button baseline" title="Set Baseline">${S.Icon("wave","width: 1.5rem; height: 1.5rem;")}</button>\n            </div>\n            <div class="sl-visibility">\n              <button class="sl-button visibility ${e.hidden?"hidden":""}" title="${e.hidden?"Show":"Hide"} Graph">\n                ${S.Icon(e.hidden?"eyeOff":"eyeOn","width: 1.5rem; height: 1.5rem;")}\n              </button>\n            </div>\n            <div class="sl-actions">\n              <button class="sl-button delete" title="Delete Graph">${S.Icon("delete","width: 1.5rem; height: 1.5rem;")}</button>\n            </div>\n          </div>\n        </div>\n      </div>\n      ${["phone","target"].includes(e.type)&&e.meta.files.length>1?`\n      <div class="sl-variant-menu">\n        ${e.meta.files.map(((n,r)=>n.suffix!==e.dispSuffix?`<div class="sl-variant-item" data-uuid="${t}" data-index="${r}">\n              <span class="sl-variant-item-name">${e.identifier} ${n.suffix}</span>\n              <button class="sl-button add-variant">${S.Icon("plus")}</button>\n            </div>`:"")).join("")}\n      </div>\n      `:""}\n    `,n}_handleItemAdded(t){const{uuid:e}=t.detail,n=g.getFRData(e);if(!n)return;const r=this._createListItemElement(e,n),i=Array.from(this.listSection.children);let a=!1;if("target"===n.type){const t=i.find((t=>"target"!==t.dataset.type));t&&(this.listSection.insertBefore(r,t),a=!0)}a||this.listSection.appendChild(r),this._attachEventListenersToItem(r)}_handleItemRemoved(t){const{uuid:e}=t.detail,n=this.listSection.querySelector(`.selection-list-item[data-uuid="${e}"]`);n&&n.remove()}_handleItemUpdated(t){const{uuid:e}=t.detail,n=g.getFRData(e);if(!n)return;const r=this.listSection.querySelector(`.selection-list-item[data-uuid="${e}"]`);if(r){const t=this._createListItemElement(e,n);this.listSection.replaceChild(t,r),this._attachEventListenersToItem(t)}}_handleChannelUpdated(t){const{uuid:e}=t.detail,n=this.listSection.querySelector(`.selection-list-item[data-uuid="${e}"]`);if(n){const t=g.getFRData(e);if(t){const e=n.querySelector(".sl-channels-select");e&&(e.innerHTML=this._getChannelOptions(Object.keys(t.channels),t.dispChannel))}}}_getChannelOptions(e,n=[]){let r="";return e.includes("L")&&(r+=`<option value="L" ${n.includes("L")&&!n.includes("R")?"selected":""}>\n        ${t.getString("selection-list.channel-left","L")}\n      </option>`),e.includes("R")&&(r+=`<option value="R" ${!n.includes("L")&&n.includes("R")?"selected":""}>\n        ${t.getString("selection-list.channel-right","R")}\n      </option>`),e.includes("L")&&e.includes("R")&&(r+=`<option value="L+R" ${n.includes("L")&&n.includes("R")?"selected":""}>\n        ${t.getString("selection-list.channel-left-and-right","L + R")}\n      </option>`),e.includes("AVG")&&(r+=`<option value="AVG" ${n.includes("AVG")?"selected":""}>\n        ${t.getString("selection-list.channel-average","Average")}\n      </option>`),r}_attachEventListenersToItem(t){const e=t.querySelector(".sl-color-btn");e&&e.addEventListener("click",(e=>{e.preventDefault();const n=t.dataset.uuid,r=t.dataset.type,i=g._getColorWithType(r);g.updateColors("uuid",n,i),e.target.style.background=i.AVG||i}));const r=t.querySelector(".sl-variant-btn");r&&r.addEventListener("click",(e=>{e.preventDefault();const n=e.currentTarget,r=t.querySelector(".sl-variant-menu"),i=n.classList.contains("active");i?(n.setAttribute("title","Show Variants"),n.innerHTML=S.Icon("plus")):(n.setAttribute("title","Hide Variants"),n.innerHTML=S.Icon("subtract")),r.classList.toggle("active",!i),n.classList.toggle("active",!i)})),t.querySelectorAll(".sl-variant-item").forEach((e=>{e.addEventListener("click",(async n=>{if(n.target.closest(".add-variant"))return;n.preventDefault();e.closest(".sl-variant-menu").setAttribute("aria-busy","true");const r=t.dataset.uuid,i=e.dataset.index,a=g.getFRData(r);await g.updateVariant(r,a.meta.files[parseInt(i)].suffix)}));const n=e.querySelector(".sl-button.add-variant");n&&n.addEventListener("click",(n=>{n.preventDefault(),n.stopPropagation();const r=t.dataset.uuid,i=e.dataset.index,a=g.getFRData(r);g.addFRData("phone",a.identifier,{dispSuffix:a.meta.files[parseInt(i)].suffix})}))}));const i=t.querySelector(".sl-channels-select");i&&i.addEventListener("change",(e=>{const n=t.dataset.uuid;g.updateDisplayChannel("uuid",n,{L:["L"],R:["R"],"L+R":["L","R"],AVG:["AVG"]}[e.target.value])}));const a=t.querySelector(".sl-y-offset");if(a){const e=a.querySelector(".sl-y-offset-input"),n=a.querySelector(".sl-y-offset-dec"),r=a.querySelector(".sl-y-offset-inc");e.addEventListener("input",(e=>{const n=t.dataset.uuid,r=parseFloat(e.target.value)||0;document.querySelectorAll(`.fr-graph-curve-container path[uuid='${n}']`).forEach((t=>{t.setAttribute("transform",`translate(0,${0-r})`)}))}));const setupLongPress=(t,e)=>{let n,r=!1;const performAction=()=>{const t=a.querySelector(".sl-y-offset-input"),n=parseInt(t.value)||0;t.value="inc"===e?n+1:n-1,t.dispatchEvent(new Event("input",{bubbles:!0}))};t.addEventListener("mousedown",(()=>{r=!0,performAction(),n=setInterval((()=>{r&&performAction()}),150)}));const stopAction=()=>{r=!1,clearInterval(n)};t.addEventListener("mouseup",stopAction),t.addEventListener("mouseleave",stopAction)};setupLongPress(n,"dec"),setupLongPress(r,"inc")}const s=t.querySelector(".sl-button.baseline");if(s){s.addEventListener("click",(e=>{e.preventDefault();const n=e.currentTarget,r=t.dataset.uuid,i=n.classList.contains("active");u.updateBaselineData(!i,{uuid:r}),this.listSection.querySelectorAll(".sl-button.baseline").forEach((t=>{t===n?i?(t.setAttribute("title","Set Baseline"),t.innerHTML=S.Icon("wave","width: 1.5rem; height: 1.5rem;"),t.classList.remove("active")):(t.setAttribute("title","Reset Baseline"),t.innerHTML=S.Icon("flatline","width: 1.5rem; height: 1.5rem;"),t.classList.add("active")):i||(t.classList.remove("active"),t.setAttribute("title","Set Baseline"),t.innerHTML=S.Icon("wave","width: 1.5rem; height: 1.5rem;"))}))}));const e=u.getBaselineData();e&&e.uuid===t.dataset.uuid&&(s.classList.add("active"),s.setAttribute("title","Reset Baseline"),s.innerHTML=S.Icon("flatline","width: 1.5rem; height: 1.5rem;"))}const o=t.querySelector(".sl-button.visibility");o&&o.addEventListener("click",(e=>{e.preventDefault();const r=e.currentTarget,i=t.dataset.uuid,a=g.getFRData(i);if(!a)return;const s=!r.classList.contains("hidden");a.hidden=s,g.frDataMap.set(i,a),s?(r.setAttribute("title","Show Graph"),r.innerHTML=S.Icon("eyeOff","width: 1.5rem; height: 1.5rem;")):(r.setAttribute("title","Hide Graph"),r.innerHTML=S.Icon("eyeOn","width: 1.5rem; height: 1.5rem;")),r.classList.toggle("hidden",s),n.dispatchEvent("fr-visibility-updated",{uuid:i,visible:!s})}));const l=t.querySelector(".sl-button.delete");l&&l.addEventListener("click",(e=>{e.preventDefault();const n=t.dataset.uuid,r=t.dataset.type;g.removeFRDataWithUUID(r,n)}))}_updateLanguage(){const t=this.listSection.querySelectorAll(".selection-list-item");t&&t.forEach((t=>{const e=t.dataset.uuid,n=g.getFRData(e);if(!n)return;const r=t.querySelector(".sl-channels-select");r&&(r.innerHTML=this._getChannelOptions(Object.keys(n.channels),n.dispChannel))}))}static getElement(){return SelectionList.element||(SelectionList.element=new SelectionList),SelectionList.element}}customElements.define("selection-list",SelectionList);var O=Object.freeze({__proto__:null});class DragDivider extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.class="main-divider",this.shadowRoot.innerHTML="\n      <style>\n        :host {\n          display: block;\n          width: 5px;\n          background: var(--gt-color-outline-variant);\n          cursor: col-resize;\n          transition: background 0.2s;\n        }\n        :host(.dragging) {\n          background: var(--gt-color-primary);\n        }\n      </style>\n    ",this._isDragging=!1,this._startX=0,this._initialWidth=0}connectedCallback(){this.addEventListener("mousedown",this._startDrag),document.addEventListener("mouseup",this._stopDrag),document.addEventListener("mousemove",this._handleDrag)}disconnectedCallback(){this.removeEventListener("mousedown",this._startDrag),document.removeEventListener("mouseup",this._stopDrag),document.removeEventListener("mousemove",this._handleDrag)}_startDrag=t=>{this._isDragging=!0,this._startX=t.clientX,this._initialWidth=this.parentElement.getBoundingClientRect().width,this.classList.add("dragging")};_handleDrag=t=>{if(!this._isDragging)return;const e=t.clientX-this._startX;this.dispatchEvent(new CustomEvent("drag-divider-moved",{detail:{deltaX:e,currentX:t.clientX},bubbles:!0,composed:!0}))};_stopDrag=()=>{this._isDragging&&(this._isDragging=!1,this.classList.remove("dragging"))}}customElements.define("drag-divider",DragDivider);var P=Object.freeze({__proto__:null});class SmoothingButton extends HTMLElement{constructor(){super(),this._options=["1/48","1/24","1/12","1/6","1/3"],this._currentIndex=0,this.innerHTML=`\n      <gt-button variant="outlined" style="height: 2.5rem">\n        <span>${t.getString("smoothing-button.label","Smoothing")}</span>\n        <gt-divider style="width: 1px"></gt-divider>\n        <b>${this._options[this._currentIndex]}oct</b>\n      </gt-button>\n    `,this._button=this.querySelector("gt-button"),this._button.addEventListener("click",this._cycleOption.bind(this))}connectedCallback(){t.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){t.removeObserver(this._updateLabel.bind(this))}_cycleOption(e){e.preventDefault(),this._currentIndex=(this._currentIndex+1)%this._options.length,this._button.innerHTML=`\n      ${t.getString("smoothing-button.label","Smoothing")}\n      <gt-divider style="width: 1px"></gt-divider>\n      <b>${this._options[this._currentIndex]}oct</b>\n    `,l.updateSmoothing(this._options[this._currentIndex])}_updateLabel(){this.querySelector("span").textContent=t.getString("smoothing-button.label","Smoothing")}}customElements.define("smoothing-button",SmoothingButton);var G=Object.freeze({__proto__:null});class GraphScaleButton extends HTMLElement{constructor(){super();const n=parseInt(e.get("VISUALIZATION.DEFAULT_Y_SCALE"))||60;this._options=[40,60,80,100],this._currentIndex=this._options.indexOf(n)||1,this.innerHTML=`\n      <gt-button variant="outlined" style="height: 2.5rem">\n        <span>${t.getString("y-axis-scale-button.label","Y-Axis Scale")}</span>\n        <gt-divider style="width: 1px"></gt-divider>\n        <b>${this._options[this._currentIndex]}dB</b>\n      </gt-button>\n    `,this._button=this.querySelector("gt-button"),this._button.addEventListener("click",this._cycleOption)}connectedCallback(){t.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){t.removeObserver(this._updateLabel.bind(this))}_cycleOption=e=>{e.preventDefault(),this._currentIndex=(this._currentIndex+1)%this._options.length,this._button.innerHTML=`\n      ${t.getString("y-axis-scale-button.label","Y-Axis Scale")}\n      <gt-divider style="width: 1px"></gt-divider>\n      <b>${this._options[this._currentIndex]}dB</b>\n    `,u.updateYScale(this._options[this._currentIndex])};_updateLabel(){this.querySelector("span").textContent=t.getString("y-axis-scale-button.label","Y-Axis Scale")}}customElements.define("graph-scale-button",GraphScaleButton);var $=Object.freeze({__proto__:null});class InspectionToggle extends HTMLElement{constructor(){super(),this._isEnabled=!1,this.innerHTML=`\n      <gt-button variant="outlined" style="height: 2.5rem">\n        <span>${t.getString("inspection-toggle.label","Inspect")}</span>\n        <gt-divider style="width: 1px"></gt-divider>\n        <b>${this._isEnabled?"ON":"OFF"}</b>\n      </gt-button>\n    `,this._button=this.querySelector("gt-button"),this._button.addEventListener("click",this._toggleInspection.bind(this))}connectedCallback(){t.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){t.removeObserver(this._updateLabel.bind(this))}_toggleInspection(t){t.preventDefault(),this._isEnabled=!this._isEnabled,this._updateButton(),n.dispatchEvent("inspection-mode-change",{enabled:this._isEnabled})}_updateButton(){this._button.innerHTML=`\n      ${t.getString("inspection-toggle.label","Inspect")}\n      <gt-divider style="width: 1px"></gt-divider>\n      <b>${this._isEnabled?"ON":"OFF"}</b>\n    `,this._isEnabled?this._button.setAttribute("variant","filled"):this._button.setAttribute("variant","outlined")}_updateLabel(){this.querySelector("span").textContent=t.getString("inspection-toggle.label","Inspect")}get isEnabled(){return this._isEnabled}}customElements.define("inspection-toggle",InspectionToggle);var V=Object.freeze({__proto__:null});class GraphScreenshotButton extends HTMLElement{constructor(){super(),this.innerHTML=`\n      <gt-button variant="filled-tonal" style="height: 2.5rem">\n        ${S.Icon("screenshot","margin-top: -2px; width: 1.2rem; height: 1.2rem;")}\n        <span>${t.getString("screenshot-button.label","Screenshot")}</span>\n      </gt-button>\n    `,this._boundCapture=this.capture.bind(this),this._boundApplyComputedStyles=this._applyComputedStyles.bind(this),this._button=this.querySelector("gt-button"),this._button.addEventListener("click",(t=>this._boundCapture(t,"graph")))}connectedCallback(){t.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){t.removeObserver(this._updateLabel.bind(this))}capture(t,e="fr-graph"){t.preventDefault();const n=document.getElementById("fr-graph");if(!n)return void console.error("FR Graph not found");const r=n.querySelector(".y-scaler-handle");r&&(r.style.display="none");const i=n.cloneNode(!0);i.setAttribute("width",n.viewBox.baseVal.width),i.setAttribute("height",n.viewBox.baseVal.height),this._boundApplyComputedStyles(i),this._embedImages(i).then((()=>{const t=(new XMLSerializer).serializeToString(i),r=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),a=URL.createObjectURL(r),s=new Image;s.crossOrigin="anonymous",s.onload=()=>{const t=document.createElement("canvas");t.width=2*n.viewBox.baseVal.width,t.height=2*n.viewBox.baseVal.height;const r=t.getContext("2d");r.fillStyle=getComputedStyle(document.querySelector(".main-graph")).backgroundColor,r.fillRect(0,0,t.width,t.height),r.scale(2,2),r.drawImage(s,0,0);const i=document.createElement("a");i.download=`${e}.png`,i.href=t.toDataURL("image/png",1),i.click(),URL.revokeObjectURL(a)};const o=new FileReader;o.onloadend=()=>{s.src=o.result},o.readAsDataURL(r)})),r&&(r.style.display="block")}_applyComputedStyles(t){const e=window.getComputedStyle(document.getElementById("fr-graph"));t.style.backgroundColor=e.backgroundColor;const n=t.querySelectorAll("*"),r=document.getElementById("fr-graph").querySelectorAll("*");n.forEach(((t,e)=>{const n=r[e];if(!n)return;const i=window.getComputedStyle(n);["fill","stroke","stroke-width","opacity","font-size","font-family","font-weight","text-anchor","transform","mask","clip-path","display","visibility"].forEach((e=>{const n=i.getPropertyValue(e);n&&"none"!==n&&(t.style[e]=n)}));(i.cssText.match(/--[\w-]+/g)||[]).forEach((e=>{const n=i.getPropertyValue(e);n&&t.style.setProperty(e,n)})),"text"===t.tagName&&(t.style.fill=i.fill,t.style.fontFamily=i.fontFamily,t.style.fontSize=i.fontSize)}))}async _embedImages(t){const e=t.querySelectorAll("image"),n=Array.from(e).map((async t=>{const e=t.getAttribute("href")||t.getAttribute("xlink:href");if(e)try{const n=await fetch(e),r=await n.blob();return new Promise((e=>{const n=new FileReader;n.onloadend=()=>{t.setAttribute("href",n.result),e()},n.readAsDataURL(r)}))}catch(t){console.warn("Failed to embed image:",e,t)}}));await Promise.all(n)}_updateLabel(){this.querySelector("span").textContent=t.getString("screenshot-button.label","Screenshot")}}customElements.define("graph-screenshot-button",GraphScreenshotButton);var B=Object.freeze({__proto__:null});class ShareButton extends HTMLElement{constructor(){super(),this._buttonStyle="margin-top: -1px; width: 1.2rem; height: 1.2rem;",this.innerHTML=`\n      <gt-button variant="filled-tonal" style="height: 2.5rem">\n        ${S.Icon("share",this._buttonStyle)}\n        <span>${t.getString("share-button.label","Share")}</span>\n      </gt-button>\n    `,this._button=this.querySelector("gt-button"),this._button.addEventListener("click",this._copyURL)}connectedCallback(){t.addObserver(this._updateLabel.bind(this))}disconnectedCallback(){t.removeObserver(this._updateLabel.bind(this))}_copyURL=async e=>{e.preventDefault(),await navigator.clipboard.writeText(v.getCurrentURL()),this._button.innerHTML=`\n      ${S.Icon("share",this._buttonStyle)}\n      ${t.getString("share-button.on-click","Copied!")}\n    `,setTimeout((()=>{this._button.innerHTML=`\n        ${S.Icon("share",this._buttonStyle)}\n        ${t.getString("share-button.label","Share")}\n      `}),1e3)};_updateLabel(){this.querySelector("span").textContent=t.getString("share-button.label","Share")}}customElements.define("share-button",ShareButton);var F=Object.freeze({__proto__:null});class LanguageSelector extends HTMLElement{constructor(){super(),this._langList=e.get("LANGUAGE.LANGUAGE_LIST")||["en","English"];const n=this._langList.map((([t,e])=>`<option value="${t}">${e||t}</option>`)).join("");this.innerHTML=`\n      <select class="lang-select">\n        ${n}\n      </select>\n      <style>\n        language-selector {\n          flex: 1;\n        }\n        .lang-select {\n          width: 100%;\n          height: 100%;\n          padding: 0.5rem;\n        }\n      </style>\n    `,this.select=this.querySelector(".lang-select"),this.select.value=t.getCurrentLanguage(),this.select.addEventListener("change",(async()=>{await t.loadLanguage(this.select.value)}))}}customElements.define("language-selector",LanguageSelector);var z=Object.freeze({__proto__:null});class TutorialModal extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.isMobile=window.innerWidth<1e3,this.os=this.detectOS(),this.currentStep=0,this.tutorialSteps=[],this.tutorialShownKey="modernGraphToolTutorialShown"}connectedCallback(){"true"===localStorage.getItem(this.tutorialShownKey)||(this.updateTutorialSteps(),this.render(),t.addObserver(this.updateLanguage.bind(this)),requestAnimationFrame((()=>{document.querySelector(this.tutorialSteps[1].selector)?this.showStep(this.currentStep):(console.warn("TutorialModal: Could not find element for the first step:",this.tutorialSteps[1].selector),this.finishTutorial(!1))})))}render(){const t=document.createElement("style");t.textContent="\n  :host {\n    position: fixed;\n    inset: 0;\n    z-index: 400; \n    pointer-events: none; \n  }\n\n  .overlay-part {\n    position: fixed;\n    background-color: rgba(0, 0, 0, 0.6); \n    z-index: 401; \n    pointer-events: auto; \n    display: none; \n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n\n  .overlay-top { height: 0; }\n  .overlay-bottom { top: auto; bottom: 0; height: 0; }\n  .overlay-left { width: 0; height: 0; }\n  .overlay-right { left: auto; right: 0; width: 0; height: 0; }\n\n  .tooltip-modal {\n    position: fixed; /* Position relative to viewport */\n    display: none; /* Hidden by default */\n    flex-direction: column;\n    background-color: var(--gt-color-surface-container-highest);\n    color: var(--gt-color-on-surface);\n    padding: 1rem;\n    border-radius: 0.75rem;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 402;\n    pointer-events: auto; /* Capture clicks on modal */\n    max-width: 300px;\n    border: 1px solid var(--gt-color-outline-variant);\n  }\n\n  .tooltip {\n    margin-bottom: 0.5rem;\n    line-height: 1.4;\n  }\n\n  .navigation {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: 0.5rem;\n    border-top: 1px solid var(--gt-color-outline-variant);\n    padding-top: 0.75rem;\n    margin-top: 0.5rem;\n  }\n\n  .navigation button {\n    padding: 0.4rem 0.8rem;\n    border: none;\n    border-radius: 1rem;\n    cursor: pointer;\n    background-color: var(--gt-color-secondary);\n    color: var(--gt-color-on-secondary);\n    font: var(--gt-typescale-body-small);\n    transition: background-color 0.2s ease;\n  }\n\n  .navigation button:hover:not(:disabled) {\n    filter: brightness(0.95);\n  }\n\n  .navigation button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .navigation .skip-btn {\n    background-color: transparent;\n    color: var(--gt-color-on-surface-variant);\n    margin-left: auto; /* Push skip button to the right */\n  }\n   .navigation .skip-btn:hover {\n     background-color: var(--gt-color-surface-variant, #eee);\n   }\n\n  .step-indicator {\n    font: var(--gt-typescale-body-small);\n    color: var(--gt-color-on-surface-variant);\n  }\n\n  /* PWA Modal Styles */\n  .page-modal {\n    position: fixed;\n    inset: 0;\n    display: none; \n    justify-content: center;\n    align-items: center;\n    background-color: rgba(0, 0, 0, 0.6); \n    z-index: 404; \n    pointer-events: auto;\n  }\n\n  .page-modal-container {\n    background-color: var(--gt-color-surface-container-highest);\n    color: var(--gt-color-on-surface);\n    padding: 1.5rem;\n    border-radius: 1rem;\n    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);\n    max-width: 90vw;\n    width: 400px;\n    text-align: center;\n    border: 1px solid var(--gt-color-outline);\n  }\n\n  .page-modal-container h3 {\n    margin-top: 0;\n    margin-bottom: 1rem;\n    color: var(--gt-color-primary);\n    font: var(--gt-typescale-title-medium);\n  }\n\n  .page-modal-container p {\n    margin-bottom: 1.5rem;\n    line-height: 1.5;\n    white-space: pre-wrap; /* Respect line breaks in instructions */\n  }\n\n  .page-modal-close-btn {\n    padding: 0.6rem 1.5rem;\n    border: none;\n    border-radius: 1.5rem;\n    cursor: pointer;\n    background-color: var(--gt-color-primary);\n    color: var(--gt-color-on-primary);\n    transition: background-color 0.2s ease;\n  }\n\n  .page-modal-close-btn:hover {\n     filter: brightness(0.9);\n  }\n",this.shadowRoot.innerHTML='\n      <div class="overlay-part overlay-top"></div>\n      <div class="overlay-part overlay-bottom"></div>\n      <div class="overlay-part overlay-left"></div>\n      <div class="overlay-part overlay-right"></div>\n      <div class="tooltip-modal">\n        <div class="tooltip"></div>\n        <div class="navigation">\n          <button class="prev-btn" disabled>Previous</button>\n          <span class="step-indicator"></span>\n          <button class="next-btn">Next</button>\n          <button class="skip-btn">Skip</button>\n        </div>\n      </div>\n      <div class="page-modal" style="display: none;">\n        <div class="page-modal-container">\n          <h3 class="page-modal-title"></h3>\n          <p class="page-modal-content"></p>\n          <button class="page-modal-close-btn"></button>\n        </div>\n      </div>\n    ',this.shadowRoot.appendChild(t),this.overlayParts=this.shadowRoot.querySelectorAll(".overlay-part"),this.overlayTop=this.shadowRoot.querySelector(".overlay-top"),this.overlayBottom=this.shadowRoot.querySelector(".overlay-bottom"),this.overlayLeft=this.shadowRoot.querySelector(".overlay-left"),this.overlayRight=this.shadowRoot.querySelector(".overlay-right"),this.tooltipModal=this.shadowRoot.querySelector(".tooltip-modal"),this.tooltipElement=this.shadowRoot.querySelector(".tooltip"),this.prevBtn=this.shadowRoot.querySelector(".prev-btn"),this.nextBtn=this.shadowRoot.querySelector(".next-btn"),this.skipBtn=this.shadowRoot.querySelector(".skip-btn"),this.stepIndicator=this.shadowRoot.querySelector(".step-indicator"),this.pageModal=this.shadowRoot.querySelector(".page-modal"),this.pageTitle=this.shadowRoot.querySelector(".page-modal-title"),this.pageContent=this.shadowRoot.querySelector(".page-modal-content"),this.pageCloseBtn=this.shadowRoot.querySelector(".page-modal-close-btn"),this.prevBtn.addEventListener("click",(()=>this.prevStep())),this.nextBtn.addEventListener("click",(()=>this.nextStep())),this.skipBtn.addEventListener("click",(()=>this.finishTutorial(!0))),this.pageCloseBtn.addEventListener("click",(()=>this.closePageModal())),this.overlayParts.forEach((t=>{t.addEventListener("click",(()=>this.nextStep()))}))}updateTutorialSteps(){this.tutorialSteps=[{type:"page",title:t.getString("tutorial-modal.intro-title","Welcome to modernGraphTool"),text:t.getString("tutorial-modal.intro-content","A completely re-engineered, graph-sniffing experience."),btnText:t.getString("tutorial-modal.intro-close-btn","Next")},{selector:"menu-carousel",text:t.getString("tutorial-modal.menu-content","You can slide the menu to the left or right to access the variety of tools."),position:"top"},{selector:".y-scaler-handle circle",text:t.getString("tutorial-modal.graph-handle-content","You can drag this handle to shift graph vertically. Double click to reset position."),position:"left"}],this.isMobile?"iOS"!==this.os&&"Android"!==this.os||this.tutorialSteps.push({type:"page",title:t.getString("tutorial-modal.pwa-title","Use as App (PWA)"),text:this.getPWAInstruction(),btnText:t.getString("tutorial-modal.pwa-close-btn","Got It!")}):this.tutorialSteps.push({selector:"drag-divider",text:t.getString("tutorial-modal.divider-content","You can drag this divider to change the size of the graph."),position:"left"})}showStep(e){this.pageModal.style.display="none",this.tooltipModal.style.display="flex",this.overlayParts.forEach((t=>t.style.display="block"));const n=this.tutorialSteps[e];if("page"===n.type)return this.overlayParts.forEach((t=>t.style.display="none")),void this.showPageModal(n);const r=document.querySelector(n.selector);if(!r)return console.warn(`TutorialModal: Element not found for step ${e}: ${n.selector}`),void(e<this.tutorialSteps.length-1?(this.currentStep++,this.showStep(this.currentStep)):this.finishTutorial(!0));r.scrollIntoView({behavior:"smooth",block:"center",inline:"center"});const i=r.getBoundingClientRect();this.overlayTop.style.height=`${i.top}px`,this.overlayBottom.style.top=`${i.bottom}px`,this.overlayBottom.style.height=`calc(100vh - ${i.bottom}px)`,this.overlayLeft.style.top=`${i.top}px`,this.overlayLeft.style.height=`${i.height}px`,this.overlayLeft.style.width=`${i.left}px`,this.overlayRight.style.top=`${i.top}px`,this.overlayRight.style.height=`${i.height}px`,this.overlayRight.style.left=`${i.right}px`,this.overlayRight.style.width=`calc(100vw - ${i.right}px)`,this.tooltipElement.textContent=n.text;const a=this.tooltipModal.getBoundingClientRect();let s,o;const l=20;switch(n.position){case"top":s=i.top-a.height-l,o=i.left+i.width/2-a.width/2;break;case"bottom":s=i.bottom+l,o=i.left+i.width/2-a.width/2;break;case"left":s=i.top+i.height/2-a.height/2,o=i.left-a.width-l;break;default:s=i.top+i.height/2-a.height/2,o=i.right+l}s=Math.max(l,Math.min(s,window.innerHeight-a.height-l)),o=Math.max(l,Math.min(o,window.innerWidth-a.width-l)),this.tooltipModal.style.top=`${s}px`,this.tooltipModal.style.left=`${o}px`,this.prevBtn.disabled=0===e,this.nextBtn.textContent=e===this.tutorialSteps.length-1?t.getString("tutorial-modal.btn-done","Done"):t.getString("tutorial-modal.btn-next","Next"),this.stepIndicator.textContent=`${e+1} / ${this.tutorialSteps.length}`}nextStep(){this.currentStep<this.tutorialSteps.length-1?(this.currentStep++,this.showStep(this.currentStep)):this.finishTutorial(!0)}prevStep(){this.currentStep>0&&(this.currentStep--,this.showStep(this.currentStep))}finishTutorial(t){this.overlayParts&&this.overlayParts.forEach((t=>t.style.display="none")),this.shadowRoot.innerHTML="",t&&localStorage.setItem(this.tutorialShownKey,"true")}showPageModal(t){this.tooltipModal.style.display="none",this.overlayParts.forEach((t=>t.style.display="none")),this.pageTitle.innerText=t.title,this.pageContent.innerText=t.text,this.pageCloseBtn.innerText=t.btnText,this.pageModal.style.display="flex"}closePageModal(){this.pageModal.style.display="none",this.currentStep<this.tutorialSteps.length-1?this.nextStep():this.finishTutorial(!0)}getPWAInstruction(){const e=this.detectOS();let n=t.getString("tutorial-modal.pwa-content","modernGraphTool is built as a progressive web app (PWA). You can install it to your device for better experience.");return"iOS"===e?n+="\n\n"+t.getString("tutorial-modal.pwa-inst-ios","On Safari: Tap the Share button, then select 'Add to Home Screen'."):"Android"===e&&(n+="\n\n"+t.getString("tutorial-modal.pwa-inst-android","On Chrome: Tap the menu button (three dots), then select 'Install app' or 'Add to Home screen'.")),n}updateLanguage(){this.updateTutorialSteps(),this.prevBtn&&(this.prevBtn.innerText=t.getString("tutorial-modal.btn-prev","Previous")),this.nextBtn&&(this.nextBtn.innerText=t.getString("tutorial-modal.btn-next","Next")),this.skipBtn&&(this.skipBtn.innerText=t.getString("tutorial-modal.btn-skip","Skip")),this.pageCloseBtn&&(this.pageCloseBtn.innerText=t.getString("tutorial-modal.intro-close-btn","Next"))}detectOS(){const t=window.navigator.userAgent,e=window.navigator.platform;return-1!==["iPhone","iPad","iPod"].indexOf(e)||t.includes("Mac")&&"ontouchend"in document?"iOS":-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(e)?"MacOS":-1!==["Win32","Win64","Windows","WinCE"].indexOf(e)?"Windows":/Android/.test(t)?"Android":"Other"}}customElements.define("tutorial-modal",TutorialModal);var U=Object.freeze({__proto__:null});export{n as CoreEvent,i as CoreExtension,g as DataProvider,s as FRNormalizer,a as FRParser,l as FRSmoother,GtToast,m as MenuState,p as MetadataParser,u as RenderEngine,t as StringLoader,v as URLProvider};
//# sourceMappingURL=core.min.js.map
